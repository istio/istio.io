<!doctype html><html lang=zh itemscope itemtype=https://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=theme-color content="#466BB0"><meta name=title content="Istio 1.25.0 更新说明"><meta name=description content="Istio 1.25.0 更新说明。"><meta name=keywords content="microservices,services,mesh"><meta property="og:title" content="Istio 1.25.0 更新说明"><meta property="og:type" content="website"><meta property="og:description" content="Istio 1.25.0 更新说明。"><meta property="og:url" content="/v1.25/zh/news/releases/1.25.x/announcing-1.25/change-notes/"><meta property="og:image" content="https://raw.githubusercontent.com/istio/istio.io/master/static/img/istio-social.png"><meta property="og:image:alt" content="The Istio sailboat logo"><meta property="og:image:width" content="4096"><meta property="og:image:height" content="2048"><meta property="og:site_name" content="Istio"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@IstioMesh"><title>Istio / Istio 1.25.0 更新说明</title>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RNS1643NL0"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-RNS1643NL0")</script><link rel=alternate type=application/rss+xml title="Istio Blog" href=/v1.25/blog/feed.xml><link rel=alternate type=application/rss+xml title="Istio News" href=/v1.25/news/feed.xml><link rel=alternate type=application/rss+xml title="Istio Blog and News" href=/v1.25/feed.xml><link rel="shortcut icon" href=/v1.25/favicons/favicon.ico><link rel=apple-touch-icon href=/v1.25/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/v1.25/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/v1.25/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/v1.25/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/v1.25/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/v1.25/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/v1.25/favicons/android-96x96.png sizes=96xW96><link rel=icon type=image/png href=/v1.25/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/v1.25/favicons/android-192x192.png sizes=192x192><link rel=icon type=image/svg+xml href=/v1.25/favicons/favicon.svg><link rel=icon type=image/png href=/v1.25/favicons/favicon.png><link rel=mask-icon href=/v1.25/favicons/safari-pinned-tab.svg color=#466BB0><link rel=manifest href=/v1.25/manifest.json><meta name=apple-mobile-web-app-title content="Istio"><meta name=application-name content="Istio"><meta name=msapplication-config content="/browserconfig.xml"><meta name=msapplication-TileColor content="#466BB0"><meta name=theme-color content="#466BB0"><link rel=stylesheet href=/v1.25/css/style.min.38f1afbdf6f8efdb4fe991ff2a53ca1c801b5c4602dea2963da44df7ceaacfb8.css integrity="sha256-OPGvvfb479tP6ZH/KlPKHIAbXEYC3qKWPaRN986qz7g=" crossorigin=anonymous><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,400;0,500;0,600;0,700;1,400;1,600&display=swap"><script src=/v1.25/js/themes_init.min.js></script></head><body class=language-unknown><script>const branchName="release-1.25",docTitle="Istio 1.25.0 更新说明",iconFile="/v1.25//img/icons.svg",buttonCopy="复制到剪切板",buttonPrint="打印",buttonDownload="下载"</script><script src="https://www.google.com/cse/brand?form=search-form" defer></script><script src=/v1.25/js/all.min.js data-manual defer></script><header class=main-navigation><nav class="main-navigation-wrapper container-l"><div class=main-navigation-header><a id=brand href=/v1.25/zh/ aria-label=logotype><span class=logo><svg width="128" height="60" viewBox="0 0 128 60"><path d="M58.434 48.823A.441.441.0 0158.3 48.497V22.583a.444.444.0 01.134-.326.446.446.0 01.327-.134h3.527a.447.447.0 01.325.134.447.447.0 01.134.326v25.914a.443.443.0 01-.134.326.444.444.0 01-.325.134h-3.527a.444.444.0 01-.327-.134z"/><path d="m70.969 48.477a6.556 6.556.0 01-2.818-1.955 4.338 4.338.0 01-1-2.78v-.345a.443.443.0 01.134-.326.444.444.0 01.326-.135h3.374a.444.444.0 01.326.135.445.445.0 01.134.326v.077a2.014 2.014.0 001.054 1.667 4.672 4.672.0 002.664.709 4.446 4.446.0 002.492-.633 1.862 1.862.0 00.958-1.591 1.426 1.426.0 00-.786-1.322 12.7 12.7.0 00-2.549-.939l-1.457-.46a21.526 21.526.0 01-3.3-1.227 6.57 6.57.0 01-2.262-1.783 4.435 4.435.0 01-.92-2.894 5.081 5.081.0 012.109-4.275 8.993 8.993.0 015.558-1.591 10.445 10.445.0 014.1.748 6.3 6.3.0 012.722 2.07 5 5 0 01.958 3.009.441.441.0 01-.134.326.441.441.0 01-.325.134h-3.258a.441.441.0 01-.326-.134.443.443.0 01-.134-.326 1.974 1.974.0 00-.978-1.667 4.647 4.647.0 00-2.665-.671 4.741 4.741.0 00-2.435.556 1.724 1.724.0 00-.938 1.553 1.512 1.512.0 00.9 1.4 15.875 15.875.0 003.01 1.055l.843.229a27.368 27.368.0 013.412 1.246 6.67 6.67.0 012.338 1.763 4.387 4.387.0 01.958 2.933 4.988 4.988.0 01-2.146 4.275 9.543 9.543.0 01-5.712 1.552 11.626 11.626.0 01-4.227-.709z"/><path d="m97.039 32.837a.443.443.0 01-.326.135h-3.911a.169.169.0 00-.191.192v9.239a2.951 2.951.0 00.632 2.108 2.7 2.7.0 002.013.652h1.15a.444.444.0 01.325.134.441.441.0 01.134.326v2.875a.471.471.0 01-.459.5l-1.994.039a8 8 0 01-4.524-1.035q-1.495-1.035-1.533-3.91V33.166A.17.17.0 0088.164 32.974H85.978A.441.441.0 0185.652 32.839.441.441.0 0185.518 32.513V29.83a.441.441.0 01.134-.326.444.444.0 01.326-.135h2.186a.169.169.0 00.191-.192v-4.485a.438.438.0 01.134-.326.44.44.0 01.325-.134h3.336a.443.443.0 01.325.134.442.442.0 01.135.326v4.485a.169.169.0 00.191.192h3.911a.446.446.0 01.326.135.446.446.0 01.134.326v2.683a.446.446.0 01-.133.324z"/><path d="m101.694 25.917a2.645 2.645.0 01-.767-1.955 2.65 2.65.0 01.767-1.955 2.65 2.65.0 011.955-.767 2.65 2.65.0 011.955.767 2.652 2.652.0 01.767 1.955 2.647 2.647.0 01-.767 1.955 2.646 2.646.0 01-1.955.767 2.645 2.645.0 01-1.955-.767zm-.211 22.906a.441.441.0 01-.134-.326V29.79a.444.444.0 01.134-.326.446.446.0 01.326-.134h3.527a.446.446.0 01.326.134.445.445.0 01.134.326v18.707a.443.443.0 01-.134.326.443.443.0 01-.326.134h-3.527a.443.443.0 01-.326-.134z"/><path d="m114.019 47.734a8.1 8.1.0 01-3.047-4.255 14.439 14.439.0 01-.652-4.37 14.3 14.3.0 01.614-4.371A7.869 7.869.0 01114 30.56a9.072 9.072.0 015.252-1.5 8.543 8.543.0 015.041 1.5 7.985 7.985.0 013.009 4.14 12.439 12.439.0 01.69 4.37 13.793 13.793.0 01-.651 4.37 8.255 8.255.0 01-3.028 4.275 8.475 8.475.0 01-5.1 1.553 8.754 8.754.0 01-5.194-1.534zm7.629-3.1a4.536 4.536.0 001.476-2.262 11.335 11.335.0 00.383-3.221 10.618 10.618.0 00-.383-3.22 4.169 4.169.0 00-1.457-2.243 4.066 4.066.0 00-2.531-.785 3.942 3.942.0 00-2.453.785 4.376 4.376.0 00-1.5 2.243 11.839 11.839.0 00-.383 3.22 11.84 11.84.0 00.383 3.221 4.222 4.222.0 001.476 2.262 4.075 4.075.0 002.549.8 3.8 3.8.0 002.44-.809z"/><path d="m15.105 32.057v15.565a.059.059.0 01-.049.059L.069 50.25A.06.06.0 01.005 50.167l14.987-33.47a.06.06.0 01.114.025z"/><path d="m17.631 23.087v24.6a.06.06.0 00.053.059l22.449 2.507a.06.06.0 00.061-.084L17.745.032a.06.06.0 00-.114.024z"/><path d="m39.961 52.548-24.833 7.45a.062.062.0 01-.043.0L.079 52.548a.059.059.0 01.026-.113h39.839a.06.06.0 01.017.113z"/></svg></span>
</a><button id=hamburger class=main-navigation-toggle aria-label="Open navigation">
<svg class="icon menu-hamburger"><use xlink:href="/v1.25/img/icons.svg#menu-hamburger"/></svg>
</button>
<button id=menu-close class=main-navigation-toggle aria-label="Close navigation"><svg class="icon menu-close"><use xlink:href="/v1.25/img/icons.svg#menu-close"/></svg></button></div><div id=header-links class=main-navigation-links-wrapper><ul class=main-navigation-links><li class=main-navigation-links-item><a class="main-navigation-links-link has-dropdown"><span>关于</span><svg class="icon dropdown-arrow"><use xlink:href="/v1.25/img/icons.svg#dropdown-arrow"/></svg></a><ul class=main-navigation-links-dropdown><li class=main-navigation-links-dropdown-item><a href=/v1.25/zh/about/service-mesh class=main-navigation-links-link>服务网格</a></li><li class=main-navigation-links-dropdown-item><a href=/v1.25/zh/about/solutions class=main-navigation-links-link>解决方案</a></li><li class=main-navigation-links-dropdown-item><a href=/v1.25/zh/about/case-studies class=main-navigation-links-link>案例学习</a></li><li class=main-navigation-links-dropdown-item><a href=/v1.25/zh/about/ecosystem class=main-navigation-links-link>生态系统</a></li><li class=main-navigation-links-dropdown-item><a href=/v1.25/zh/about/deployment class=main-navigation-links-link>部署</a></li><li class=main-navigation-links-dropdown-item><a href=/v1.25/zh/about/faq class=main-navigation-links-link>FAQ</a></li></ul></li><li class=main-navigation-links-item><a href=/v1.25/zh/blog/ class=main-navigation-links-link><span>博客</span></a></li><li class=main-navigation-links-item><a href=/v1.25/zh/news/ class=main-navigation-links-link><span>新闻</span></a></li><li class=main-navigation-links-item><a href=/v1.25/zh/get-involved/ class=main-navigation-links-link><span>加入我们</span></a></li><li class=main-navigation-links-item><a href=/v1.25/zh/docs/ class=main-navigation-links-link><span>文档</span></a></li></ul><div class=main-navigation-footer><button id=search-show class=search-show title='搜索 istio.io' aria-label=搜索><svg class="icon magnifier"><use xlink:href="/v1.25/img/icons.svg#magnifier"/></svg></button>
<a href=/v1.25/zh/docs/setup/getting-started class="btn btn--primary" id=try-istio>试用 Istio</a></div></div><form id=search-form class=search name=cse role=search><input type=hidden name=cx value=002184991200833970123:veyyqmfmpj4>
<input type=hidden name=ie value=utf-8>
<input type=hidden name=hl value=zh>
<input type=hidden id=search-page-url value=/zh/search>
<input id=search-textbox class="search-textbox form-control" name=q type=search aria-label='搜索 istio.io' placeholder=搜索>
<button id=search-close title=取消搜索 type=reset aria-label=取消搜索><svg class="icon menu-close"><use xlink:href="/v1.25/img/icons.svg#menu-close"/></svg></button></form></nav></header><div class=banner-container></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><div class=header-content><h1>Istio 1.25.0 更新说明</h1><p>Istio 1.25.0 更新说明。</p></div><p class=post-author>Mar 3, 2025</p><div><h2 id=deprecation-notices>弃用通知</h2><p>这些通知描述了根据 <a href=/v1.25/zh/docs/releases/feature-stages/#feature-phase-definition>Istio 的弃用政策</a>将在未来版本中删除的功能。
请考虑升级您的环境以删除已弃用的功能。</p><ul><li><p><strong>弃用</strong> 弃用了 <code>proxyMetadata</code> 中 <code>ISTIO_META_DNS_AUTO_ALLOCATE</code> 的使用，
转而使用较新版本的 <a href=/v1.25/zh/docs/ops/configuration/traffic-management/dns-proxy#dns-auto-allocation-v2>DNS 自动分配</a>。
Istio IP <code>auto-allocation</code> 的新用户应采用新的基于状态的控制器。
现有用户可以继续使用较旧的实现。
(<a href=https://github.com/istio/istio/issues/53596>Issue #53596</a>)</p></li><li><p><strong>弃用</strong> 弃用了 <code>traffic.sidecar.istio.io/kubevirtInterfaces</code>，改用 <code>istio.io/reroute-virtual-interfaces</code>。
(<a href=https://github.com/istio/istio/issues/49829>Issue #49829</a>)</p></li></ul><h2 id=traffic-management>流量治理</h2><ul><li><p><strong>提升</strong> 将 <code>cni.ambient.dnsCapture</code> 值默认提升为 <code>true</code>。
这将默认启用 Ambient 网格中工作负载的 DNS 代理，从而提高安全性和性能并启用多项功能。
可以明确禁用此功能，也可以使用 <code>compatibilityVersion=1.24</code> 禁用。
注意：只有新 Pod 才会启用 DNS。要为现有 Pod 启用此功能，必须手动重新启动 Pod，
或者必须使用 <code>--set cni.ambient.reconcileIptablesOnStartup=false</code> 启用 iptables 协调功能。</p></li><li><p><strong>提升</strong> 将 <code>PILOT_ENABLE_IP_AUTOALLOCATE</code> 值默认提升为 <code>true</code>。
这将启用 <a href=/v1.25/zh/docs/ops/configuration/traffic-management/dns-proxy/#address-auto-allocation>IP 自动分配</a>的新迭代，
解决分配不稳定、Ambient 支持和提高可见性等长期存在的问题。
未设置 <code>spec.address</code> 的 <code>ServiceEntry</code> 对象现在将看到一个新字段 <code>status.addresses</code>，
该字段会被自动设置。注意：除非代理配置为执行 DNS 代理（默认情况下保持关闭状态），否则不会使用这些。</p></li><li><p><strong>更新</strong> 更新了 <code>PILOT_SEND_UNHEALTHY_ENDPOINTS</code> 功能（默认情况下处于关闭状态），
以不包括终止端点。这可确保在缩减或推出事件期间服务不会被视为不健康。</p></li><li><p><strong>更新</strong> 更新了 DNS 代理算法，随机选择将 DNS 请求转发到哪个上游。
(<a href=https://github.com/istio/istio/issues/53414>Issue #53414</a>)</p></li><li><p><strong>新增</strong> 添加了新的 istiod 环境变量 <code>PILOT_DNS_JITTER_DURATION</code>，
用于设置定期 DNS 解析的抖动。请参阅 <code>https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/cluster/v3/cluster.proto</code> 中的 <code>dns_jitter</code>。
(<a href=https://github.com/istio/istio/issues/52877>Issue #52877</a>)</p></li><li><p><strong>新增</strong> 添加了 <code>ObservedGeneration</code> 到 Ambient 状态条件。此字段将显示生成条件时控制器观察到的对象的生成。
(<a href=https://github.com/istio/istio/issues/53331>Issue #53331</a>)</p></li><li><p><strong>新增</strong> 添加了 istiod 环境变量 <code>PILOT_DNS_CARES_UDP_MAX_QUERIES</code>，
用于控制 Envoy 默认 Cares DNS 解析器的 <code>udp_max_queries</code> 字段。
未设置时，此值默认为 100。有关更多信息，
请参阅 <a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/network/dns_resolver/cares/v3/cares_dns_resolver.proto#envoy-v3-api-field-extensions-network-dns-resolver-cares-v3-caresdnsresolverconfig-udp-max-queries>Envoy 文档</a>。
(<a href=https://github.com/istio/istio/issues/53577>Issue #53577</a>)</p></li><li><p><strong>新增</strong> 添加了在 <code>istio-cni</code> 升级时协调上一版本中现有 Ambient Pod 的 Pod 内 iptables 规则的支持。
可以使用 <code>--set cni.ambient.reconcileIptablesOnStartup=true</code> 切换该功能，并将在未来版本中默认启用。
(<a href=https://github.com/istio/istio/issues/1360>Issue #1360</a>)</p></li><li><p><strong>新增</strong> 添加了 <code>istio.io/reroute-virtual-interfaces</code> 注解，
这是一个逗号分隔的虚拟接口列表，其入站流量将无条件视为出站。
这允许使用虚拟网络（KubeVirt、VM、docker-in-docker 等）的工作负载在
Sidecar 和 Ambient 网格流量捕获中正常运行。</p></li><li><p><strong>新增</strong> 添加了通过定位 <code>GatewayClass</code> 为 istio-waypoint 附加策略默认值的支持。
(<a href=https://github.com/istio/istio/issues/54696>Issue #54696</a>)</p></li><li><p><strong>新增</strong> 添加了 <code>ambient.istio.io/dns-capture</code> 注解，
可以取消设置，也可以设置为 <code>true</code> 或 <code>false</code>。
在 Ambient 网格中注册的 <code>Pod</code> 上指定时，控制是否在 Ambient 中捕获和代理 DNS 流量（端口 53 上的 TCP 和 UDP）。
如果此 Pod 级注解存在于 Pod 上，它将覆盖全局 <code>istio-cni</code> <code>AMBIENT_DNS_CAPTURE</code> 设置，
该设置从 1.25 开始默认为 <code>true</code>。注意：将其设置为 <code>false</code> 将破坏某些 Istio 功能，
例如 <code>ServiceEntry</code> 和出口 waypoint，但对于与 DNS 代理交互较差的工作负载来说可能是可取的。
(<a href=https://github.com/istio/istio/issues/49829>Issue #49829</a>)</p></li><li><p><strong>新增</strong> 添加了在命名空间级别配置 <code>istio.io/ingress-use-waypoint</code> 标签的支持。</p></li><li><p><strong>新增</strong> 添加了对保留 HTTP/1.x 标头的原始大小写的支持。
(<a href=https://github.com/istio/istio/issues/53680>Issue #53680</a>)</p></li><li><p><strong>新增</strong> 添加了对 <code>Service.spec.trafficDistribution</code> 字段和 <code>networking.istio.io/traffic-distribution</code> 注解的支持，
允许使用更简单的机制使流量优先选择地理位置较近的端点。
注意：此功能以前仅适用于 ztunnel，但现在所有数据平面均支持此功能。</p></li><li><p><strong>修复</strong> 修复了网关和 TLS 重定向中混合大小写主机的错误，该错误导致 RDS 过时。
(<a href=https://github.com/istio/istio/issues/49638>Issue #49638</a>)</p></li><li><p><strong>修复</strong> 修复了在 <code>VirtualService</code> 中，匹配器指定 <code>sourceLabels</code> 的 <code>HTTPRoute</code> 会应用于 waypoint 的问题。
(<a href=https://github.com/istio/istio/issues/51565>Issue #51565</a>)</p></li><li><p><strong>修复</strong> 修复了如果 WASM 镜像提取失败，则使用允许所有 RBAC 过滤器的问题。
现在，如果将 <code>failStrategy</code> 设置为 <code>FAIL_CLOSE</code>，则将使用 DENY-ALL RBAC 过滤器。
(<a href=https://github.com/istio/istio/issues/53279>Issue #53279</a>),
(<a href=https://github.com/istio/istio/issues/23624>Issue #23624</a>)</p></li><li><p><strong>修复</strong> 修复了 waypoint 代理以遵循信任域。</p></li><li><p><strong>修复</strong> 修复了在 <code>EnvoyFilter</code> 中合并 <code>Duration</code> 可能导致所有侦听器相关属性被意外修改的问题，
因为所有侦听器共享相同的指针类型（<code>listener_filters_timeout</code>）。</p></li><li><p><strong>修复</strong> 修复了在清理有条件的 iptables 规则时出现错误的问题。</p></li><li><p><strong>修复</strong> 修复了配置问题，DNS 流量（UDP 和 TCP）现在受流量注解（如 <code>traffic.sidecar.istio.io/excludeOutboundIPRanges</code> 和 <code>traffic.sidecar.istio.io/excludeOutboundPorts</code>）的影响。
之前，由于规则结构的原因，即使指定了 DNS 端口，UDP/DNS 流量也会唯一地忽略这些流量注解。
行为变化实际上发生在 1.23 版本系列中，但未包含在 1.23 的发行说明中。
(<a href=https://github.com/istio/istio/issues/53949>Issue #53949</a>)</p></li><li><p><strong>修复</strong> 修复了 istiod 无法正确处理跨命名空间 waypoint 代理的 <code>RequestAuthentication</code> 的问题。
(<a href=https://github.com/istio/istio/issues/54051>Issue #54051</a>)</p></li><li><p><strong>修复</strong> 修复了升级到 1.24 版期间导致托管网关/waypoint 部署补丁失败的问题。
(<a href=https://github.com/istio/istio/issues/54145>Issue #54145</a>)</p></li><li><p><strong>修复</strong> 修复了控制网关的非默认修订版缺少 <code>istio.io/rev</code> 标签的问题。
(<a href=https://github.com/istio/istio/issues/54280>Issue #54280</a>)</p></li><li><p><strong>修复</strong> 修复了当 L7 规则存在于与 ztunnel 绑定的 <code>AuthorizationPolicy</code> 中时状态消息的措辞，使其更加清晰。
(<a href=https://github.com/istio/istio/issues/54334>Issue #54334</a>)</p></li><li><p><strong>修复</strong> 修复了请求镜像过滤器错误计算百分比的错误。
(<a href=https://github.com/istio/istio/issues/54357>Issue #54357</a>)</p></li><li><p><strong>修复</strong> 修复了在网关上使用 <code>istio.io/rev</code> 标签中的标记导致网关编程不当和缺少状态的问题。
(<a href=https://github.com/istio/istio/issues/54458>Issue #54458</a>)</p></li><li><p><strong>修复</strong> 修复了无序 ztunnel 断开连接可能导致 <code>istio-cni</code> 处于认为没有连接的状态的问题。
(<a href=https://github.com/istio/istio/issues/54544>Issue #54544</a>),
(<a href=https://github.com/istio/istio/issues/53843>Issue #53843</a>)</p></li><li><p><strong>修复</strong> 修复了规则检查和删除的过多 iptables 信息级别日志条目问题。
如有必要，可以通过切换到调试级别日志来重新启用详细日志记录。
(<a href=https://github.com/istio/istio/issues/54644>Issue #54644</a>)</p></li><li><p><strong>修复</strong> 修复了使用 Ambient 模式和 DNS 代理时导致 <code>ExternalName</code> 服务无法解析的问题。</p></li><li><p><strong>修复</strong> 修复了当多个服务的 IP 地址部分重叠时导致配置被拒绝的问题。
例如，一个服务有 <code>[IP-A]</code>，另一个服务有 <code>[IP-B, IP-A]</code>。
(<a href=https://github.com/istio/istio/issues/52847>Issue #52847</a>)</p></li><li><p><strong>修复</strong> 修复了导致 <code>VirtualService</code> 标头名称验证拒绝有效标头名称的问题。</p></li><li><p><strong>修复</strong> 修复了将 waypoint 代理从 Istio 1.23.x 升级到 Istio 1.24.x 时出现的问题。
(<a href=https://github.com/istio/istio/issues/53883>Issue #53883</a>)</p></li></ul><h2 id=security>安全性</h2><ul><li><p><strong>新增</strong> 向 <code>istio-cni-node</code> <code>DaemonSet</code> 添加 <code>DAC_OVERRIDE</code> 功能。
这解决了在某些文件由非 root 用户拥有的环境中运行时出现的问题。
注意：在 Istio 1.24 之前，<code>istio-cni-node</code> 以 <code>privileged</code> 身份运行。
Istio 1.24 删除了此功能，但删除了一些必需的权限，现在已重新添加。
相对于 Istio 1.23，<code>istio-cni-node</code> 的权限仍然比此更改后的权限少。</p></li><li><p><strong>新增</strong> 向 <code>istio-cni-node</code> <code>DaemonSet</code> 添加不受限制的 AppArmor 注解，
以避免与阻止某些特权 Pod 功能的 AppArmor 配置文件发生冲突。
以前，由于在 <code>SecurityContext</code> 中将特权设置为 true，
因此 <code>istio-cni-node</code> <code>DaemonSet</code> 会绕过 AppArmor（启用时）。
此更改可确保将 <code>istio-cni-node</code> <code>DaemonSet</code> 的 AppArmor 配置文件设置为不受限制。</p></li><li><p><strong>修复</strong> 修复了 Ambient <code>PeerAuthentication</code> 策略过于严格的问题。
(<a href=https://github.com/istio/istio/issues/53884>Issue #53884</a>)</p></li><li><p><strong>修复</strong> 修复了 JWT 策略的 JWK 解析缓存中可能出现的竞争条件，
当触发该条件时，会导致缓存未命中和轮换时更新签名密钥失败。
(<a href=https://github.com/istio/istio/issues/52121>Issue #52121</a>)</p></li></ul><p>-<strong>修复</strong> 修复了仅存在于 Ambient 中的一个错误，
其中 <code>PeerAuthentication</code> 策略中的多个 <code>STRICT</code> 端口级 mTLS
规则会由于不正确的评估逻辑（<code>AND</code> 与 <code>OR</code>）而有效地导致宽松的策略。
(<a href=https://github.com/istio/istio/issues/54146>Issue #54146</a>)</p><ul><li><strong>修复</strong> 修复了入口网关未使用 WDS 发现来检索 Ambient 目标元数据的问题。</li></ul><h2 id=telemetry>遥测</h2><ul><li><p><strong>新增</strong> 添加了对 Sidecar 模式下遥测的附加标签交换的支持。
(<a href=https://github.com/istio/istio/issues/54000>Issue #54000</a>)</p></li><li><p><strong>新增</strong> 添加了新的 <code>service.istio.io/workload-name</code> 标签，
可以将其添加到 <code>Pod</code> 或 <code>WorkloadEntry</code> 以覆盖遥测中报告的“工作负载名称”。</p></li><li><p><strong>新增</strong> 添加了一个后备方案，使用 <code>WorkloadGroup</code> 名称作为由
<code>WorkloadGroup</code> 创建的 <code>WorkloadEntry</code> 的“工作负载名称”（如遥测中所报告的）。</p></li><li><p><strong>修复</strong> 修复了当在 IPv6 集群上启用 Datadog 跟踪时，<code>$(HOST_IP)</code> 插值会导致 istio-proxy 失败。
(<a href=https://github.com/istio/istio/issues/54267>Issue #54267</a>)</p></li><li><p><strong>修复</strong> 修复了访问日志顺序不稳定导致连接耗尽的问题。
(<a href=https://github.com/istio/istio/issues/54672>Issue #54672</a>)</p></li><li><p><strong>修复</strong> 修复了如果 Prometheus 的抓取间隔配置大于 <code>15s</code>，
Grafana 仪表板中的许多面板会显示<strong>无数据</strong>的问题。
（<a href=https://grafana.com/blog/2020/09/28/new-in-grafana-7.2-__rate_interval-for-prometheus-rate-queries-that-just-work/>背景信息</a>）（<a href=/v1.25/zh/docs/tasks/observability/metrics/using-istio-dashboard/>使用</a>）</p></li><li><p><strong>移除</strong> 删除了对 OpenCensus 的支持。</p></li></ul><h2 id=installation>安装</h2><ul><li><p><strong>改进</strong> 改进了 <code>platform</code> 和 <code>profile</code> Helm 值覆盖现在等效地支持全局或本地覆盖形式，例如</p><ul><li><code>--set global.platform=foo</code></li><li><code>--set global.profile=bar</code></li><li><code>--set platform=foo</code></li><li><code>--set profile=bar</code></li></ul></li><li><p><strong>改进</strong> 改进了 ztunnel Helm Chart，将资源名称设置为 <code>.Release.Name</code>，而不是硬编码为 ztunnel。</p></li><li><p><strong>新增</strong> 向 <code>WaypointBound</code> 条件添加了新消息，以表示服务绑定到入口的 waypoint 代理。</p></li><li><p><strong>新增</strong> 添加了 ‘istioctl install’ 在 Windows 上不起作用的问题。</p></li><li><p><strong>新增</strong> 当 <code>istio-cni</code> 以 <code>hostNetwork=true</code> 运行时（即 Ambient 模式），
向 <code>istio-cni</code> 添加 <code>dnsPolicy</code> 为 <code>ClusterFirstWithHostNet</code> 的 Pod。</p></li><li><p><strong>新增</strong> 添加了用于 Ambient 模式的 GKE 平台配置文件。
在 GKE 上安装时，使用 <code>--set global.platform=gke</code>（Helm）或 <code>--set values.global.platform=gke</code>（istioctl）来应用特定于 GKE 的值进行覆盖。
这取代了之前基于 <code>istio-cni</code> Chart 中使用的 K8S 版本的 GKE 自动检测。</p></li><li><p><strong>新增</strong> 添加了对 Envoy 配置参数的支持以跳过弃用的日志，默认设置为 true。
将 <code>ENVOY_SKIP_DEPRECATED_LOGS</code> 环境变量设置为 false 将启用弃用的日志。</p></li><li><p><strong>新增</strong> 默认情况下，向 Istio 发布的网关添加 Ambient 数据平面排除标签，
以避免在 <code>istio-system</code> 之外安装网关时出现开箱即用的混乱行为。
(<a href=https://github.com/istio/istio/issues/54824>Issue #54824</a>)</p></li><li><p><strong>修复</strong> 修复了在某些基于 Docker 的 Kubernetes 节点上创建 <code>ipset</code> 条目失败的问题。
(<a href=https://github.com/istio/istio/issues/53512>Issue #53512</a>)</p></li><li><p><strong>修复</strong> 修复了 Helm 渲染以正确在 Pilot <code>serviceAccount</code> 上应用注解的问题。
(<a href=https://github.com/istio/istio/issues/51289>Issue #51289</a>)</p></li><li><p><strong>修复</strong> 修复了当启用 <code>istio-cni</code> 时 <code>includeInboundPorts: ""</code> 不起作用的问题。
(<a href=https://github.com/istio/istio/issues/54288>Issue #54288</a>)</p></li><li><p><strong>修复</strong> 修复了在二进制复制过程中反复终止容器时，
CNI 安装在二进制复制过程中留下临时文件的问题，这些临时文件可能会填满存储空间。
(<a href=https://github.com/istio/istio/issues/54311>Issue #54311</a>)</p></li><li><p><strong>修复</strong> 修复了网关 Chart 中 <code>--set platform</code> 有效但 <code>--set global.platform</code> 无效的问题。</p></li><li><p><strong>修复</strong> 修复了 <code>gateway</code> 注入模板不尊重 <code>kubectl.kubernetes.io/default-logs-container</code>
和 <code>kubectl.kubernetes.io/default-container</code> 注解的问题。</p></li><li><p><strong>修复</strong> 修复了当系统中存在非内置表时导致 <code>istio-iptables</code> 命令失败的问题。</p></li><li><p><strong>修复</strong> 修复了阻止 <code>PodDisruptionBudget</code> <code>maxUnavailable</code> 字段可定制的问题。
(<a href=https://github.com/istio/istio/issues/54087>Issue #54087</a>)</p></li><li><p><strong>修复</strong> 修复了当 Sidecar 注入器无法处理 Sidecar 配置时，
注入配置错误被忽略（即记录但未返回）的问题。此更改现在会将错误传播给用户，而不是继续处理错误的配置。
(<a href=https://github.com/istio/istio/issues/53357>Issue #53357</a>)</p></li></ul><h2 id=istioctl>istioctl</h2><ul><li><p><strong>改进</strong> 改进了 <code>istioctl proxy-config secret</code> 的输出以显示 Spire 提供的信任包。</p></li><li><p><strong>新增</strong> 在 <code>istioctl analyze</code> 中为 <code>--revision</code> 标志添加别名 <code>-r</code>。</p></li><li><p><strong>新增</strong> 在 <code>istioct x authz check</code> 命令中添加对具有 <code>CUSTOM</code> 操作的 <code>AuthorizationPolicies</code> 支持。</p></li><li><p><strong>新增</strong> 添加了对 <code>istioctl experiments load group create</code> 命令的 <code>--network</code> 参数的支持。
(<a href=https://github.com/istio/istio/issues/54022>Issue #54022</a>)</p></li><li><p><strong>新增</strong> 添加了安全地就地重启/升级 <code>system-node-critical</code> <code>istio-cni</code> 节点代理 <code>DaemonSet</code> 的功能。
此功能通过防止在 <code>istio-cni</code> 重启或升级时在节点上启动新 Pod 来实现。
此功能默认启用，可通过在 <code>istio-cni</code> 中设置环境变量 <code>AMBIENT_DISABLE_SAFE_UPGRADE=true</code> 来禁用。
(<a href=https://github.com/istio/istio/issues/49009>Issue #49009</a>)</p></li><li><p><strong>新增</strong> 添加了 <code>rootca-compare</code> 命令的变更，以处理 Pod 具有多个根 CA 的情况。
(<a href=https://github.com/istio/istio/issues/54545>Issue #54545</a>)</p></li><li><p><strong>新增</strong> 添加了对 <code>istioctl waypoint delete</code> 的支持，以删除指定的修订 waypoint。</p></li><li><p><strong>新增</strong> 添加了对分析器的支持，以报告选定的 Istio 和 Kubernetes Gateway API 资源的负面状态情况。
(<a href=https://github.com/istio/istio/issues/55055>Issue #55055</a>)</p></li><li><p><strong>改进</strong> 改进了 <code>istioctl proxy-config secret</code> 和 <code>istioctl proxy-config</code> 的性能。
(<a href=https://github.com/istio/istio/issues/53931>Issue #53931</a>)</p></li><li><p><strong>修复</strong> 修复了 <code>rootca-compare</code> 命令中的问题，以处理 Pod 具有多个根 CA 的情况。
(<a href=https://github.com/istio/istio/issues/54545>Issue #54545</a>)</p></li><li><p><strong>修复</strong> 修复了如果在 <code>IstioOperator</code> 文件中指定了多个入口网关，则 <code>istioctl install</code> 会死锁的问题。
(<a href=https://github.com/istio/istio/issues/53875>Issue #53875</a>)</p></li><li><p><strong>修复</strong> 修复了 <code>istioctl waypoint delete --all</code> 会删除所有网关资源（甚至非 waypoint）的问题。
(<a href=https://github.com/istio/istio/issues/54056>Issue #54056</a>)</p></li><li><p><strong>修复</strong> 修复了 <code>istioctl experiments injection engine list</code> 命令不打印注入器 webhook 的冗余命名空间。</p></li><li><p><strong>修复</strong> 当使用具有不同端口和多个网关的同一主机时，<code>istioctl analyze</code> 报告 <code>IST0145</code> 错误。
(<a href=https://github.com/istio/istio/issues/54643>Issue #54643</a>)</p></li><li><p><strong>修复</strong> 修复了当使用 <code>--as</code> 而不使用 <code>--as-group</code> 时，<code>istioctl --as</code> 会隐式设置 <code>--as-group=""</code> 的问题。</p></li><li><p><strong>移除</strong> 删除了 <code>--recursive</code> 标志并将 <code>istioctl analyze</code> 的递归设置为 true。</p></li><li><p><strong>移除</strong> 从 <code>istioctl proxy-status</code> 命令中删除了实验标志 <code>--xds-via-agents</code>。</p></li></ul></div><nav class=pagenav><div class=left></div><div class=right><a title="升级到 Istio 1.25.0 时要考虑的重要变更。" href=/v1.25/zh/news/releases/1.25.x/announcing-1.25/upgrade-notes/ class=next-link>Istio 1.25 升级说明<svg class="icon right-arrow"><use xlink:href="/v1.25/img/icons.svg#right-arrow"/></svg></a></div></nav></article><footer class=footer><div class="footer-wrapper container-l"><div class="user-links footer-links"><a class=channel title='Istio 的代码在 GitHub 上开发' href=https://github.com/istio/community aria-label=GitHub><svg class="icon github"><use xlink:href="/v1.25/img/icons.svg#github"/></svg>
</a><a class=channel title='如果您想深入了解 Istio 的技术细节，请查看我们日益完善的设计文档' href=https://groups.google.com/forum/#!forum/istio-team-drive-access aria-label="team drive"><svg class="icon drive"><use xlink:href="/v1.25/img/icons.svg#drive"/></svg>
</a><a class=channel title='在 Slack 上与 Istio 社区交互讨论开发问题（仅限邀请）' href=https://slack.istio.io aria-label=slack><svg class="icon slack"><use xlink:href="/v1.25/img/icons.svg#slack"/></svg>
</a><a class=channel title='Stack Overflow 中列举了针对实际问题以及部署、配置和使用 Istio 的各项回答' href=https://stackoverflow.com/questions/tagged/istio aria-label="Stack Overflow"><svg class="icon stackoverflow"><use xlink:href="/v1.25/img/icons.svg#stackoverflow"/></svg>
</a><a class=channel title='关注我们的 LinkedIn 来获取最新信息' href=https://www.linkedin.com/company/istio/ aria-label=LinkedIn><svg class="icon linkedin"><use xlink:href="/v1.25/img/icons.svg#linkedin"/></svg>
</a><a class=channel title='关注我们的 Twitter 来获取最新信息' href=https://twitter.com/IstioMesh aria-label=Twitter><svg class="icon twitter"><use xlink:href="/v1.25/img/icons.svg#twitter"/></svg>
</a><a class=channel title='关注我们的 Bluesky 来获取最新信息' href=https://bsky.app/profile/istio.io aria-label=Bluesky><svg class="icon bluesky"><use xlink:href="/v1.25/img/icons.svg#bluesky"/></svg>
</a><a class=channel title='关注我们的 Mastodon 来获取最新信息' href=https://mastodon.social/@istio aria-label=Mastodon rel=me><svg class="icon mastodon"><use xlink:href="/v1.25/img/icons.svg#mastodon"/></svg></a></div><hr class=footer-separator role=separator><div class="info footer-info"><a class=logo href=/v1.25/zh/ aria-label=logotype><svg width="128" height="60" viewBox="0 0 128 60"><path d="M58.434 48.823A.441.441.0 0158.3 48.497V22.583a.444.444.0 01.134-.326.446.446.0 01.327-.134h3.527a.447.447.0 01.325.134.447.447.0 01.134.326v25.914a.443.443.0 01-.134.326.444.444.0 01-.325.134h-3.527a.444.444.0 01-.327-.134z"/><path d="m70.969 48.477a6.556 6.556.0 01-2.818-1.955 4.338 4.338.0 01-1-2.78v-.345a.443.443.0 01.134-.326.444.444.0 01.326-.135h3.374a.444.444.0 01.326.135.445.445.0 01.134.326v.077a2.014 2.014.0 001.054 1.667 4.672 4.672.0 002.664.709 4.446 4.446.0 002.492-.633 1.862 1.862.0 00.958-1.591 1.426 1.426.0 00-.786-1.322 12.7 12.7.0 00-2.549-.939l-1.457-.46a21.526 21.526.0 01-3.3-1.227 6.57 6.57.0 01-2.262-1.783 4.435 4.435.0 01-.92-2.894 5.081 5.081.0 012.109-4.275 8.993 8.993.0 015.558-1.591 10.445 10.445.0 014.1.748 6.3 6.3.0 012.722 2.07 5 5 0 01.958 3.009.441.441.0 01-.134.326.441.441.0 01-.325.134h-3.258a.441.441.0 01-.326-.134.443.443.0 01-.134-.326 1.974 1.974.0 00-.978-1.667 4.647 4.647.0 00-2.665-.671 4.741 4.741.0 00-2.435.556 1.724 1.724.0 00-.938 1.553 1.512 1.512.0 00.9 1.4 15.875 15.875.0 003.01 1.055l.843.229a27.368 27.368.0 013.412 1.246 6.67 6.67.0 012.338 1.763 4.387 4.387.0 01.958 2.933 4.988 4.988.0 01-2.146 4.275 9.543 9.543.0 01-5.712 1.552 11.626 11.626.0 01-4.227-.709z"/><path d="m97.039 32.837a.443.443.0 01-.326.135h-3.911a.169.169.0 00-.191.192v9.239a2.951 2.951.0 00.632 2.108 2.7 2.7.0 002.013.652h1.15a.444.444.0 01.325.134.441.441.0 01.134.326v2.875a.471.471.0 01-.459.5l-1.994.039a8 8 0 01-4.524-1.035q-1.495-1.035-1.533-3.91V33.166A.17.17.0 0088.164 32.974H85.978A.441.441.0 0185.652 32.839.441.441.0 0185.518 32.513V29.83a.441.441.0 01.134-.326.444.444.0 01.326-.135h2.186a.169.169.0 00.191-.192v-4.485a.438.438.0 01.134-.326.44.44.0 01.325-.134h3.336a.443.443.0 01.325.134.442.442.0 01.135.326v4.485a.169.169.0 00.191.192h3.911a.446.446.0 01.326.135.446.446.0 01.134.326v2.683a.446.446.0 01-.133.324z"/><path d="m101.694 25.917a2.645 2.645.0 01-.767-1.955 2.65 2.65.0 01.767-1.955 2.65 2.65.0 011.955-.767 2.65 2.65.0 011.955.767 2.652 2.652.0 01.767 1.955 2.647 2.647.0 01-.767 1.955 2.646 2.646.0 01-1.955.767 2.645 2.645.0 01-1.955-.767zm-.211 22.906a.441.441.0 01-.134-.326V29.79a.444.444.0 01.134-.326.446.446.0 01.326-.134h3.527a.446.446.0 01.326.134.445.445.0 01.134.326v18.707a.443.443.0 01-.134.326.443.443.0 01-.326.134h-3.527a.443.443.0 01-.326-.134z"/><path d="m114.019 47.734a8.1 8.1.0 01-3.047-4.255 14.439 14.439.0 01-.652-4.37 14.3 14.3.0 01.614-4.371A7.869 7.869.0 01114 30.56a9.072 9.072.0 015.252-1.5 8.543 8.543.0 015.041 1.5 7.985 7.985.0 013.009 4.14 12.439 12.439.0 01.69 4.37 13.793 13.793.0 01-.651 4.37 8.255 8.255.0 01-3.028 4.275 8.475 8.475.0 01-5.1 1.553 8.754 8.754.0 01-5.194-1.534zm7.629-3.1a4.536 4.536.0 001.476-2.262 11.335 11.335.0 00.383-3.221 10.618 10.618.0 00-.383-3.22 4.169 4.169.0 00-1.457-2.243 4.066 4.066.0 00-2.531-.785 3.942 3.942.0 00-2.453.785 4.376 4.376.0 00-1.5 2.243 11.839 11.839.0 00-.383 3.22 11.84 11.84.0 00.383 3.221 4.222 4.222.0 001.476 2.262 4.075 4.075.0 002.549.8 3.8 3.8.0 002.44-.809z"/><path d="m15.105 32.057v15.565a.059.059.0 01-.049.059L.069 50.25A.06.06.0 01.005 50.167l14.987-33.47a.06.06.0 01.114.025z"/><path d="m17.631 23.087v24.6a.06.06.0 00.053.059l22.449 2.507a.06.06.0 00.061-.084L17.745.032a.06.06.0 00-.114.024z"/><path d="m39.961 52.548-24.833 7.45a.062.062.0 01-.043.0L.079 52.548a.059.059.0 01.026-.113h39.839a.06.06.0 01.017.113z"/></svg></a><div class=footer-languages><a tabindex=-1 lang=en id=switch-lang-en class=footer-languages-item>English
</a><a tabindex=-1 lang=zh id=switch-lang-zh class="footer-languages-item active"><svg class="icon tick"><use xlink:href="/v1.25/img/icons.svg#tick"/></svg>
中文
</a><a tabindex=-1 lang=uk id=switch-lang-uk class=footer-languages-item>Українська</a></div></div><ul class=footer-policies><li class=footer-policies-item><a class=footer-policies-link href=https://www.linuxfoundation.org/legal/terms>条款
</a>|
<a class=footer-policies-link href=https://www.linuxfoundation.org/legal/privacy-policy>隐私政策
</a>|
<a class=footer-policies-link href=https://www.linuxfoundation.org/legal/trademark-usage>商标
</a>|
<a class=footer-policies-link href=https://github.com/istio/istio.io/edit/release-1.25/content/zh/news/releases/1.25.x/announcing-1.25/change-notes/index.md>在 GitHub 上编辑此页</a></li></ul><div class=footer-base><span class=footer-base-copyright>&copy; 2025 the Istio Authors.</span>
<span class=footer-base-version>部分内容可能滞后于英文版本，同步工作正在进行中<br>版本
Istio
1.25.2</span><ul class=footer-base-releases><li class=footer-base-releases-item><a tabindex=-1 class=footer-base-releases-link onclick='return navigateToUrlOrRoot("https://preliminary.istio.io/news/releases/1.25.x/announcing-1.25/change-notes/"),!1'>下个版本</a></li><li class=footer-base-releases-item><a tabindex=-1 class=footer-base-releases-link href=https://istio.io/archive>旧版本</a></li></ul></div></div></footer><div id=scroll-to-top-container aria-hidden=true><button id=scroll-to-top title=回到顶部 tabindex=-1><svg class="icon top"><use xlink:href="/v1.25/img/icons.svg#top"/></svg></button></div></body></html>