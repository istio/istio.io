{"version":3,"file":"themes_init.min.js","names":["darkThemeClass","darkTheme","darkThemeItem","lightTheme","lightThemeItem","themeStorageItem","applyStyleSheet","theme","document","documentElement","classList","add","remove","item","getElementById","active","readLocalStorage","name","value","localStorage","getItem","nameEQ","ca","cookie","split","c","charAt","substring","length","indexOf","setItem","readSystemDefault","window","matchMedia","matches","currentTheme"],"sources":["../../src/ts/themes_init.ts"],"sourcesContent":["// Copyright 2019 Istio Authors\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nconst darkThemeClass = \"dark-theme\";\nconst darkTheme = \"Dark Theme\";\nconst darkThemeItem = \"dark-theme-item\";\nconst lightTheme = \"Light Theme\";\nconst lightThemeItem = \"light-theme-item\";\nconst themeStorageItem = \"style\";\n\nfunction applyStyleSheet(theme: string | null): void {\n    // convert legacy cookie values\n    if (theme === \"dark\") {\n        theme = darkTheme;\n    } else if (theme === \"light\") {\n        theme = lightTheme;\n    }\n    theme = lightTheme;\n    if (theme === darkTheme) {\n        document.documentElement.classList.add(darkThemeClass);\n    } else {\n        document.documentElement.classList.remove(darkThemeClass);\n    }\n\n    // set the active theme menu item\n\n    let item = document.getElementById(lightThemeItem);\n    if (item) {\n        if (theme === darkTheme) {\n            item.classList.remove(active);\n        } else {\n            item.classList.add(active);\n        }\n    }\n\n    item = document.getElementById(darkThemeItem);\n    if (item) {\n        if (theme === darkTheme) {\n            item.classList.add(active);\n        } else {\n            item.classList.remove(active);\n        }\n    }\n}\n\nfunction readLocalStorage(name: string): string | null {\n    let value = localStorage.getItem(name);\n    if (value) {\n        return value;\n    }\n\n    // if couldn't find in local storage, fall back to the legacy cookies\n    const nameEQ = name + \"=\";\n    const ca = document.cookie.split(\";\");\n    for (let c of ca) {\n        while (c.charAt(0) === \" \") {\n            c = c.substring(1, c.length);\n        }\n\n        if (c.indexOf(nameEQ) === 0) {\n            value = c.substring(nameEQ.length, c.length);\n\n            // migrate the cookie value to localStorage\n            localStorage.setItem(name, value);\n\n            // delete the cookie once the value has been migrated to local storage\n            document.cookie = name + \"= ; expires = Thu, 01 Jan 1970 00:00:00 GMT\";\n\n            return value;\n        }\n    }\n\n    return null;\n}\n\nfunction readSystemDefault(): string | null {\n    if (window.matchMedia(\"(prefers-color-scheme: dark)\").matches) {\n        return darkTheme;\n    } else if (window.matchMedia(\"(prefers-color-scheme: light)\").matches) {\n        return lightTheme;\n    }\n    return null;\n}\n\nlet currentTheme = readLocalStorage(themeStorageItem);\nif (currentTheme === null) {\n    currentTheme = readSystemDefault();\n}\napplyStyleSheet(currentTheme);\n"],"mappings":"aAcA,KAAMA,eAAc,CAAG,YAAvB,CACA,KAAMC,UAAS,CAAG,YAAlB,CACA,KAAMC,cAAa,CAAG,iBAAtB,CACA,KAAMC,WAAU,CAAG,aAAnB,CACA,KAAMC,eAAc,CAAG,kBAAvB,CACA,KAAMC,iBAAgB,CAAG,OAAzB,CAEA,QAASC,gBAAT,CAAyBC,KAAzB,CAA6C,CAEzC,GAAIA,KAAK,GAAK,MAAd,CAAsB,CAClBA,KAAK,CAAGN,SACX,CAFD,IAEO,IAAIM,KAAK,GAAK,OAAd,CAAuB,CAC1BA,KAAK,CAAGJ,UACX,CACDI,KAAK,CAAGJ,UAAR,CACA,GAAII,KAAK,GAAKN,SAAd,CAAyB,CACrBO,QAAQ,CAACC,eAAT,CAAyBC,SAAzB,CAAmCC,GAAnC,CAAuCX,cAAvC,CACH,CAFD,IAEO,CACHQ,QAAQ,CAACC,eAAT,CAAyBC,SAAzB,CAAmCE,MAAnC,CAA0CZ,cAA1C,CACH,CAID,GAAIa,KAAI,CAAGL,QAAQ,CAACM,cAAT,CAAwBV,cAAxB,CAAX,CACA,GAAIS,IAAJ,CAAU,CACN,GAAIN,KAAK,GAAKN,SAAd,CAAyB,CACrBY,IAAI,CAACH,SAAL,CAAeE,MAAf,CAAsBG,MAAtB,CACH,CAFD,IAEO,CACHF,IAAI,CAACH,SAAL,CAAeC,GAAf,CAAmBI,MAAnB,CACH,CACJ,CAEDF,IAAI,CAAGL,QAAQ,CAACM,cAAT,CAAwBZ,aAAxB,CAAP,CACA,GAAIW,IAAJ,CAAU,CACN,GAAIN,KAAK,GAAKN,SAAd,CAAyB,CACrBY,IAAI,CAACH,SAAL,CAAeC,GAAf,CAAmBI,MAAnB,CACH,CAFD,IAEO,CACHF,IAAI,CAACH,SAAL,CAAeE,MAAf,CAAsBG,MAAtB,CACH,CACJ,CACJ,CAED,QAASC,iBAAT,CAA0BC,IAA1B,CAAsC,CAClC,GAAIC,MAAK,CAAGC,YAAY,CAACC,OAAb,CAAqBH,IAArB,CAAZ,CACA,GAAIC,KAAJ,CAAW,CACP,MAAOA,MACV,CAGD,KAAMG,OAAM,CAAGJ,IAAI,CAAG,GAAtB,CACA,KAAMK,GAAE,CAAGd,QAAQ,CAACe,MAAT,CAAgBC,KAAhB,CAAsB,GAAtB,CAAX,CACA,IAAK,GAAIC,EAAT,GAAcH,GAAd,CAAkB,CACd,MAAOG,CAAC,CAACC,MAAF,CAAS,CAAT,IAAgB,GAAvB,CAA4B,CACxBD,CAAC,CAAGA,CAAC,CAACE,SAAF,CAAY,CAAZ,CAAeF,CAAC,CAACG,MAAjB,CACP,CAED,GAAIH,CAAC,CAACI,OAAF,CAAUR,MAAV,IAAsB,CAA1B,CAA6B,CACzBH,KAAK,CAAGO,CAAC,CAACE,SAAF,CAAYN,MAAM,CAACO,MAAnB,CAA2BH,CAAC,CAACG,MAA7B,CAAR,CAGAT,YAAY,CAACW,OAAb,CAAqBb,IAArB,CAA2BC,KAA3B,EAGAV,QAAQ,CAACe,MAAT,CAAkBN,IAAI,CAAG,6CAAzB,CAEA,MAAOC,MACV,CACJ,CAED,MAAO,KACV,CAED,QAASa,kBAAT,EAA0B,CACtB,GAAIC,MAAM,CAACC,UAAP,CAAkB,8BAAlB,EAAkDC,OAAtD,CAA+D,CAC3D,MAAOjC,UACV,CAFD,IAEO,IAAI+B,MAAM,CAACC,UAAP,CAAkB,+BAAlB,EAAmDC,OAAvD,CAAgE,CACnE,MAAO/B,WACV,CACD,MAAO,KACV,CAED,GAAIgC,aAAY,CAAGnB,gBAAgB,CAACX,gBAAD,CAAnC,CACA,GAAI8B,YAAY,GAAK,IAArB,CAA2B,CACvBA,YAAY,CAAGJ,iBAAiB,EACnC,CACDzB,eAAe,CAAC6B,YAAD,CAAf"}