{"version":3,"file":"themes_init.min.js","names":["darkThemeClass","darkTheme","darkThemeItem","lightTheme","lightThemeItem","themeStorageItem","applyStyleSheet","theme","document","documentElement","classList","add","remove","item","getElementById","active","readLocalStorage","name","value","localStorage","getItem","nameEQ","ca","cookie","split","c","charAt","substring","length","indexOf","setItem","readSystemDefault","window","matchMedia","matches","currentTheme"],"sources":["../../src/ts/themes_init.ts"],"sourcesContent":["// Copyright 2019 Istio Authors\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nconst darkThemeClass = \"dark-theme\";\nconst darkTheme = \"Dark Theme\";\nconst darkThemeItem = \"dark-theme-item\";\nconst lightTheme = \"Light Theme\";\nconst lightThemeItem = \"light-theme-item\";\nconst themeStorageItem = \"style\";\n\nfunction applyStyleSheet(theme: string | null): void {\n    // convert legacy cookie values\n    if (theme === \"dark\") {\n        theme = darkTheme;\n    } else if (theme === \"light\") {\n        theme = lightTheme;\n    }\n    theme = lightTheme;\n    if (theme === darkTheme) {\n        document.documentElement.classList.add(darkThemeClass);\n    } else {\n        document.documentElement.classList.remove(darkThemeClass);\n    }\n\n    // set the active theme menu item\n\n    let item = document.getElementById(lightThemeItem);\n    if (item) {\n        if (theme === darkTheme) {\n            item.classList.remove(active);\n        } else {\n            item.classList.add(active);\n        }\n    }\n\n    item = document.getElementById(darkThemeItem);\n    if (item) {\n        if (theme === darkTheme) {\n            item.classList.add(active);\n        } else {\n            item.classList.remove(active);\n        }\n    }\n}\n\nfunction readLocalStorage(name: string): string | null {\n    let value = localStorage.getItem(name);\n    if (value) {\n        return value;\n    }\n\n    // if couldn't find in local storage, fall back to the legacy cookies\n    const nameEQ = name + \"=\";\n    const ca = document.cookie.split(\";\");\n    for (let c of ca) {\n        while (c.charAt(0) === \" \") {\n            c = c.substring(1, c.length);\n        }\n\n        if (c.indexOf(nameEQ) === 0) {\n            value = c.substring(nameEQ.length, c.length);\n\n            // migrate the cookie value to localStorage\n            localStorage.setItem(name, value);\n\n            // delete the cookie once the value has been migrated to local storage\n            document.cookie = name + \"= ; expires = Thu, 01 Jan 1970 00:00:00 GMT\";\n\n            return value;\n        }\n    }\n\n    return null;\n}\n\nfunction readSystemDefault(): string | null {\n    if (window.matchMedia(\"(prefers-color-scheme: dark)\").matches) {\n        return darkTheme;\n    } else if (window.matchMedia(\"(prefers-color-scheme: light)\").matches) {\n        return lightTheme;\n    }\n    return null;\n}\n\nlet currentTheme = readLocalStorage(themeStorageItem);\nif (currentTheme === null) {\n    currentTheme = readSystemDefault();\n}\napplyStyleSheet(currentTheme);\n"],"mappings":"aAcA,KAAM,CAAAA,cAAc,CAAG,YAAY,CACnC,KAAM,CAAAC,SAAS,CAAG,YAAY,CAC9B,KAAM,CAAAC,aAAa,CAAG,iBAAiB,CACvC,KAAM,CAAAC,UAAU,CAAG,aAAa,CAChC,KAAM,CAAAC,cAAc,CAAG,kBAAkB,CACzC,KAAM,CAAAC,gBAAgB,CAAG,OAAO,CAEhC,QAAS,CAAAC,eAAeA,CAACC,KAAoB,EAEzC,GAAIA,KAAK,GAAK,MAAM,CAAE,CAClBA,KAAK,CAAGN,UACX,IAAM,IAAIM,KAAK,GAAK,OAAO,CAAE,CAC1BA,KAAK,CAAGJ,WAEZI,KAAK,CAAGJ,UAAU,CAClB,GAAII,KAAK,GAAKN,SAAS,CAAE,CACrBO,QAAQ,CAACC,eAAe,CAACC,SAAS,CAACC,GAAG,CAACX,cAAc,EACxD,IAAM,CACHQ,QAAQ,CAACC,eAAe,CAACC,SAAS,CAACE,MAAM,CAACZ,cAAc,EAK5D,GAAI,CAAAa,IAAI,CAAGL,QAAQ,CAACM,cAAc,CAACV,cAAc,CAAC,CAClD,GAAIS,IAAI,CAAE,CACN,GAAIN,KAAK,GAAKN,SAAS,CAAE,CACrBY,IAAI,CAACH,SAAS,CAACE,MAAM,CAACG,MAAM,EAC/B,IAAM,CACHF,IAAI,CAACH,SAAS,CAACC,GAAG,CAACI,MAAM,GAIjCF,IAAI,CAAGL,QAAQ,CAACM,cAAc,CAACZ,aAAa,CAAC,CAC7C,GAAIW,IAAI,CAAE,CACN,GAAIN,KAAK,GAAKN,SAAS,CAAE,CACrBY,IAAI,CAACH,SAAS,CAACC,GAAG,CAACI,MAAM,EAC5B,IAAM,CACHF,IAAI,CAACH,SAAS,CAACE,MAAM,CAACG,MAAM,GAGxC,CAEA,QAAS,CAAAC,gBAAgBA,CAACC,IAAY,EAClC,GAAI,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAACH,IAAI,CAAC,CACtC,GAAIC,KAAK,CAAE,CACP,MAAO,CAAAA,MAIX,KAAM,CAAAG,MAAM,CAAGJ,IAAI,CAAG,GAAG,CACzB,KAAM,CAAAK,EAAE,CAAGd,QAAQ,CAACe,MAAM,CAACC,KAAK,CAAC,GAAG,CAAC,CACrC,IAAK,GAAI,CAAAC,CAAC,GAAI,CAAAH,EAAE,CAAE,CACd,MAAOG,CAAC,CAACC,MAAM,CAAC,CAAC,CAAC,GAAK,GAAG,CAAE,CACxBD,CAAC,CAAGA,CAAC,CAACE,SAAS,CAAC,CAAC,CAAEF,CAAC,CAACG,MAAM,EAG/B,GAAIH,CAAC,CAACI,OAAO,CAACR,MAAM,CAAC,GAAK,CAAC,CAAE,CACzBH,KAAK,CAAGO,CAAC,CAACE,SAAS,CAACN,MAAM,CAACO,MAAM,CAAEH,CAAC,CAACG,MAAM,CAAC,CAG5CT,YAAY,CAACW,OAAO,CAACb,IAAI,CAAEC,KAAK,CAAC,CAGjCV,QAAQ,CAACe,MAAM,CAAGN,IAAI,CAAG,6CAA6C,CAEtE,MAAO,CAAAC,OAIf,MAAO,KACX,CAEA,QAAS,CAAAa,iBAAiBA,CAAA,EACtB,GAAIC,MAAM,CAACC,UAAU,CAAC,8BAA8B,CAAC,CAACC,OAAO,CAAE,CAC3D,MAAO,CAAAjC,UACV,IAAM,IAAI+B,MAAM,CAACC,UAAU,CAAC,+BAA+B,CAAC,CAACC,OAAO,CAAE,CACnE,MAAO,CAAA/B,WAEX,MAAO,KACX,CAEA,GAAI,CAAAgC,YAAY,CAAGnB,gBAAgB,CAACX,gBAAgB,CAAC,CACrD,GAAI8B,YAAY,GAAK,IAAI,CAAE,CACvBA,YAAY,CAAGJ,iBAAiB,GAEpCzB,eAAe,CAAC6B,YAAY,CAAC"}