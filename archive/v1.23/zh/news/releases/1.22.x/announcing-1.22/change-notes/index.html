<!doctype html><html lang=zh itemscope itemtype=https://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=theme-color content="#466BB0"><meta name=title content="Istio 1.22.0 更新说明"><meta name=description content="Istio 1.22.0 更新说明。"><meta name=keywords content="microservices,services,mesh"><meta property="og:title" content="Istio 1.22.0 更新说明"><meta property="og:type" content="website"><meta property="og:description" content="Istio 1.22.0 更新说明。"><meta property="og:url" content="/v1.23/zh/news/releases/1.22.x/announcing-1.22/change-notes/"><meta property="og:image" content="https://raw.githubusercontent.com/istio/istio.io/master/static/img/istio-social.png"><meta property="og:image:alt" content="The Istio sailboat logo"><meta property="og:image:width" content="4096"><meta property="og:image:height" content="2048"><meta property="og:site_name" content="Istio"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@IstioMesh"><title>Istioldie 1.23 / Istio 1.22.0 更新说明</title>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5XBWY4YJ1E"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-5XBWY4YJ1E")</script><link rel=alternate type=application/rss+xml title="Istio Blog" href=/v1.23/blog/feed.xml><link rel=alternate type=application/rss+xml title="Istio News" href=/v1.23/news/feed.xml><link rel=alternate type=application/rss+xml title="Istio Blog and News" href=/v1.23/feed.xml><link rel="shortcut icon" href=/v1.23/favicons/favicon.ico><link rel=apple-touch-icon href=/v1.23/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/v1.23/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/v1.23/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/v1.23/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/v1.23/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/v1.23/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/v1.23/favicons/android-96x96.png sizes=96xW96><link rel=icon type=image/png href=/v1.23/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/v1.23/favicons/android-192x192.png sizes=192x192><link rel=icon type=image/svg+xml href=/v1.23/favicons/favicon.svg><link rel=icon type=image/png href=/v1.23/favicons/favicon.png><link rel=mask-icon href=/v1.23/favicons/safari-pinned-tab.svg color=#466BB0><link rel=manifest href=/v1.23/manifest.json><meta name=apple-mobile-web-app-title content="Istio"><meta name=application-name content="Istio"><meta name=msapplication-config content="/browserconfig.xml"><meta name=msapplication-TileColor content="#466BB0"><meta name=theme-color content="#466BB0"><link rel=stylesheet href=/v1.23/css/all.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,400;0,500;0,600;0,700;1,400;1,600&display=swap"><script src=/v1.23/js/themes_init.min.js></script></head><body class="language-unknown archive-site"><script>const branchName="release-1.23",docTitle="Istio 1.22.0 更新说明",iconFile="/v1.23//img/icons.svg",buttonCopy="复制到剪切板",buttonPrint="打印",buttonDownload="下载"</script><script src="https://www.google.com/cse/brand?form=search-form" defer></script><script src=/v1.23/js/all.min.js data-manual defer></script><header class=main-navigation><nav class="main-navigation-wrapper container-l"><div class=main-navigation-header><a id=brand href=/v1.23/zh/ aria-label=logotype><span class=logo><svg width="128" height="60" viewBox="0 0 128 60"><path d="M58.434 48.823A.441.441.0 0158.3 48.497V22.583a.444.444.0 01.134-.326.446.446.0 01.327-.134h3.527a.447.447.0 01.325.134.447.447.0 01.134.326v25.914a.443.443.0 01-.134.326.444.444.0 01-.325.134h-3.527a.444.444.0 01-.327-.134z"/><path d="m70.969 48.477a6.556 6.556.0 01-2.818-1.955 4.338 4.338.0 01-1-2.78v-.345a.443.443.0 01.134-.326.444.444.0 01.326-.135h3.374a.444.444.0 01.326.135.445.445.0 01.134.326v.077a2.014 2.014.0 001.054 1.667 4.672 4.672.0 002.664.709 4.446 4.446.0 002.492-.633 1.862 1.862.0 00.958-1.591 1.426 1.426.0 00-.786-1.322 12.7 12.7.0 00-2.549-.939l-1.457-.46a21.526 21.526.0 01-3.3-1.227 6.57 6.57.0 01-2.262-1.783 4.435 4.435.0 01-.92-2.894 5.081 5.081.0 012.109-4.275 8.993 8.993.0 015.558-1.591 10.445 10.445.0 014.1.748 6.3 6.3.0 012.722 2.07 5 5 0 01.958 3.009.441.441.0 01-.134.326.441.441.0 01-.325.134h-3.258a.441.441.0 01-.326-.134.443.443.0 01-.134-.326 1.974 1.974.0 00-.978-1.667 4.647 4.647.0 00-2.665-.671 4.741 4.741.0 00-2.435.556 1.724 1.724.0 00-.938 1.553 1.512 1.512.0 00.9 1.4 15.875 15.875.0 003.01 1.055l.843.229a27.368 27.368.0 013.412 1.246 6.67 6.67.0 012.338 1.763 4.387 4.387.0 01.958 2.933 4.988 4.988.0 01-2.146 4.275 9.543 9.543.0 01-5.712 1.552 11.626 11.626.0 01-4.227-.709z"/><path d="m97.039 32.837a.443.443.0 01-.326.135h-3.911a.169.169.0 00-.191.192v9.239a2.951 2.951.0 00.632 2.108 2.7 2.7.0 002.013.652h1.15a.444.444.0 01.325.134.441.441.0 01.134.326v2.875a.471.471.0 01-.459.5l-1.994.039a8 8 0 01-4.524-1.035q-1.495-1.035-1.533-3.91V33.166A.17.17.0 0088.164 32.974H85.978A.441.441.0 0185.652 32.839.441.441.0 0185.518 32.513V29.83a.441.441.0 01.134-.326.444.444.0 01.326-.135h2.186a.169.169.0 00.191-.192v-4.485a.438.438.0 01.134-.326.44.44.0 01.325-.134h3.336a.443.443.0 01.325.134.442.442.0 01.135.326v4.485a.169.169.0 00.191.192h3.911a.446.446.0 01.326.135.446.446.0 01.134.326v2.683a.446.446.0 01-.133.324z"/><path d="m101.694 25.917a2.645 2.645.0 01-.767-1.955 2.65 2.65.0 01.767-1.955 2.65 2.65.0 011.955-.767 2.65 2.65.0 011.955.767 2.652 2.652.0 01.767 1.955 2.647 2.647.0 01-.767 1.955 2.646 2.646.0 01-1.955.767 2.645 2.645.0 01-1.955-.767zm-.211 22.906a.441.441.0 01-.134-.326V29.79a.444.444.0 01.134-.326.446.446.0 01.326-.134h3.527a.446.446.0 01.326.134.445.445.0 01.134.326v18.707a.443.443.0 01-.134.326.443.443.0 01-.326.134h-3.527a.443.443.0 01-.326-.134z"/><path d="m114.019 47.734a8.1 8.1.0 01-3.047-4.255 14.439 14.439.0 01-.652-4.37 14.3 14.3.0 01.614-4.371A7.869 7.869.0 01114 30.56a9.072 9.072.0 015.252-1.5 8.543 8.543.0 015.041 1.5 7.985 7.985.0 013.009 4.14 12.439 12.439.0 01.69 4.37 13.793 13.793.0 01-.651 4.37 8.255 8.255.0 01-3.028 4.275 8.475 8.475.0 01-5.1 1.553 8.754 8.754.0 01-5.194-1.534zm7.629-3.1a4.536 4.536.0 001.476-2.262 11.335 11.335.0 00.383-3.221 10.618 10.618.0 00-.383-3.22 4.169 4.169.0 00-1.457-2.243 4.066 4.066.0 00-2.531-.785 3.942 3.942.0 00-2.453.785 4.376 4.376.0 00-1.5 2.243 11.839 11.839.0 00-.383 3.22 11.84 11.84.0 00.383 3.221 4.222 4.222.0 001.476 2.262 4.075 4.075.0 002.549.8 3.8 3.8.0 002.44-.809z"/><path d="m15.105 32.057v15.565a.059.059.0 01-.049.059L.069 50.25A.06.06.0 01.005 50.167l14.987-33.47a.06.06.0 01.114.025z"/><path d="m17.631 23.087v24.6a.06.06.0 00.053.059l22.449 2.507a.06.06.0 00.061-.084L17.745.032a.06.06.0 00-.114.024z"/><path d="m39.961 52.548-24.833 7.45a.062.062.0 01-.043.0L.079 52.548a.059.059.0 01.026-.113h39.839a.06.06.0 01.017.113z"/></svg></span>
</a><button id=hamburger class=main-navigation-toggle aria-label="Open navigation">
<svg class="icon menu-hamburger"><use xlink:href="/v1.23/img/icons.svg#menu-hamburger"/></svg>
</button>
<button id=menu-close class=main-navigation-toggle aria-label="Close navigation"><svg class="icon menu-close"><use xlink:href="/v1.23/img/icons.svg#menu-close"/></svg></button></div><div id=header-links class=main-navigation-links-wrapper><ul class=main-navigation-links><li class=main-navigation-links-item><a class="main-navigation-links-link has-dropdown"><span>关于</span><svg class="icon dropdown-arrow"><use xlink:href="/v1.23/img/icons.svg#dropdown-arrow"/></svg></a><ul class=main-navigation-links-dropdown><li class=main-navigation-links-dropdown-item><a href=/v1.23/zh/about/service-mesh class=main-navigation-links-link>服务网格</a></li><li class=main-navigation-links-dropdown-item><a href=/v1.23/zh/about/solutions class=main-navigation-links-link>解决方案</a></li><li class=main-navigation-links-dropdown-item><a href=/v1.23/zh/about/case-studies class=main-navigation-links-link>案例学习</a></li><li class=main-navigation-links-dropdown-item><a href=/v1.23/zh/about/ecosystem class=main-navigation-links-link>生态系统</a></li><li class=main-navigation-links-dropdown-item><a href=/v1.23/zh/about/deployment class=main-navigation-links-link>部署</a></li><li class=main-navigation-links-dropdown-item><a href=/v1.23/zh/about/faq class=main-navigation-links-link>FAQ</a></li></ul></li><li class=main-navigation-links-item><a href=/v1.23/zh/blog/ class=main-navigation-links-link><span>博客</span></a></li><li class=main-navigation-links-item><a href=/v1.23/zh/news/ class=main-navigation-links-link><span>新闻</span></a></li><li class=main-navigation-links-item><a href=/v1.23/zh/get-involved/ class=main-navigation-links-link><span>加入我们</span></a></li><li class=main-navigation-links-item><a href=/v1.23/zh/docs/ class=main-navigation-links-link><span>文档</span></a></li></ul><div class=main-navigation-footer><button id=search-show class=search-show title='搜索 istio.io' aria-label=搜索><svg class="icon magnifier"><use xlink:href="/v1.23/img/icons.svg#magnifier"/></svg></button>
<a href=/v1.23/zh/docs/setup/getting-started class="btn btn--primary" id=try-istio>试用 Istio</a></div></div><form id=search-form class=search name=cse role=search><input type=hidden name=cx value=002184991200833970123:iwwf17ikgf4>
<input type=hidden name=ie value=utf-8>
<input type=hidden name=hl value=zh>
<input type=hidden id=search-page-url value=/zh/search>
<input id=search-textbox class="search-textbox form-control" name=q type=search aria-label='搜索 istio.io' placeholder=搜索>
<button id=search-close title=取消搜索 type=reset aria-label=取消搜索><svg class="icon menu-close"><use xlink:href="/v1.23/img/icons.svg#menu-close"/></svg></button></form></nav></header><div class=banner-container></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><div class=header-content><h1>Istio 1.22.0 更新说明</h1><p>Istio 1.22.0 更新说明。</p></div><p class=post-author>May 13, 2024</p><div><h2 id=deprecation-notices>弃用通知</h2><p>以下通知说明了根据 <a href=/v1.23/zh/docs/releases/feature-stages/#feature-phase-definitions>Istio 的弃用政策</a>将在未来某个版本中移除的功能。
请考虑升级您的环境以移除弃用的功能。</p><ul><li><strong>弃用</strong> 弃用了 <code>values.istio_cni</code>，转而使用 <code>values.pilot.cni</code>。
(<a href=https://github.com/istio/istio/issues/49290>Issue #49290</a>)</li></ul><h2 id=traffic-management>流量治理</h2><ul><li><p><strong>改进</strong> 改进了如果指定 <code>targetPort</code> 后具有 <code>resolution: NONE</code> 的 <code>ServiceEntry</code>。
这在进行 TLS 发起时特别有用，允许设置 <code>port:80, targetPort: 443</code>。
如果不需要，请设置 <code>--compatibilityVersion=1.21</code> 以恢复到旧行为或删除 <code>targetPort</code> 规范。</p></li><li><p><strong>新增</strong> 添加了支持完全跳过 CNI 的初始安装。</p></li><li><p><strong>新增</strong> 向 istiod 添加了一个节点污点控制器，一旦 Istio CNI Pod 在该节点上准备就绪，
它就会从节点中删除 <code>cni.istio.io/not-ready</code> 污点。
(<a href=https://github.com/istio/istio/issues/48818>Issue #48818</a>),(<a href=https://github.com/istio/istio/issues/48286>Issue #48286</a>)</p></li><li><p><strong>新增</strong> 通过 Pilot 调试 API <code>/debug/config_distribution</code>，将端点确认生成添加到可用的代理分发报告中。
(<a href=https://github.com/istio/istio/issues/48985>Issue #48985</a>)</p></li><li><p><strong>新增</strong> 添加了对服务配置 waypoint 代理的支持。</p></li><li><p><strong>新增</strong> 添加了使用 <code>istio.io/use-waypoint</code> 注解增加到 Pod、服务、命名空间和其他类似类型的功能，
以 <code>[&lt;namespace name>/]&lt;waypoint name></code> 的形式指定 waypoint。
这取代了对 waypoint 的旧要求，即其范围仅限于整个命名空间或单个服务帐户。
选择退出 waypoint 也可以使用 <code>#none</code> 值来完成，以允许命名空间范围的 waypoint，
其中特定的 Pod 或服务不受 waypoint 的保护，从而允许 waypoint 规范和使用具有更大的灵活性。
(<a href=https://github.com/istio/istio/issues/49436>Issue #49436</a>)</p></li><li><p><strong>新增</strong> 添加了对 waypoint 代理中 <code>istio.io/waypoint-for</code> 注解的支持。
(<a href=https://github.com/istio/istio/issues/49851>Issue #49851</a>)</p></li><li><p><strong>新增</strong> 添加了一项检查，以防止当用户在其 AuthorizationPolicy
中将网关指定为 <code>targetRef</code> 时创建 ztunnel 配置。
(<a href=https://github.com/istio/istio/issues/50110>Issue #50110</a>)</p></li><li><p><strong>新增</strong> 添加了 <code>networking.istio.io/address-type</code> 注释以允许 <code>istio</code> GatewayClass 的 Gateway 使用 <code>ClusterIP</code> 作为状态地址。</p></li><li><p><strong>新增</strong> 添加了使用指向任意 GatewayClass 的 Gateway 的 <code>istio.io/use-waypoint</code> 注解工作负载或服务的能力。
这些更改允许将标准 Istio 网关配置为 waypoint。为此，必须将其配置为启用重定向的 <code>ClusterIP</code> Service。
这通俗地称为“网关三明治”，其中 ztunnel 层处理 mTLS。
(<a href=https://github.com/istio/istio/issues/48362>Issue #48362</a>)</p></li><li><p><strong>新增</strong> 添加了通过使用 <code>istio.io/dataplane-mode=ambient</code> 标记各个 Pod 将其注册到 Ambient 中的功能。
(<a href=https://github.com/istio/istio/issues/50355>Issue #50355</a>)</p></li><li><p><strong>新增</strong> 添加了允许 Pod 通过使用 <code>istio.io/dataplane-mode=none</code> 标签选择退出 Ambient 重定向。
(<a href=https://github.com/istio/istio/issues/50736>Issue #50736</a>)</p></li><li><p><strong>移除</strong> 移除了使用 <code>ambient.istio.io/redirection=disabled</code> 注解选择退出
Ambient 重定向的功能，因为这是为 CNI 保留的状态注解。
(<a href=https://github.com/istio/istio/issues/50736>Issue #50736</a>)</p></li><li><p><strong>新增</strong> 添加了 istiod <code>PILOT_GATEWAY_API_DEFAULT_GATEWAYCLASS_NAME</code> 的环境变量，
允许覆盖默认 <code>GatewayClass</code> Gateway API 资源的名称。默认值为 <code>istio</code>。</p></li><li><p><strong>新增</strong> 添加了 istiod <code>PILOT_GATEWAY_API_CONTROLLER_NAME</code> 的环境变量，
允许覆盖 <code>GatewayClass</code> 资源中 <code>spec.controllerName</code> 字段中公开的 Istio Gateway API 控制器的名称。
默认值为 <code>istio.io/gateway-controller</code>。</p></li><li><p><strong>新增</strong> 添加对使用代理协议进行出站流量的支持。通过在 <code>DestinationRule.trafficPolicy</code>
中指定 <code>proxyProtocol</code>，Sidecar 将向上游服务发送 PROXY 协议标头。HBONE 代理目前不支持此功能。</p></li><li><p><strong>新增</strong> 添加了验证检查以拒绝具有重复子集名称的 <code>DestinationRules</code>。</p></li><li><p><strong>新增</strong> 在控制器接受 GatewayClass 之前，在 Gateway API 的 Class 状态上添加了 <code>supportedFeatures</code> 字段。
(<a href=https://github.com/kubernetes-sigs/gateway-api/issues/2162>Issue #2162</a>)</p></li><li><p><strong>新增</strong> 在 <code>SidecarScope</code> 构建期间合并服务时添加了检查服务的
<code>Resolution</code>、<code>LabelSelector</code>、<code>ServiceRegistry</code> 和命名空间的能力。</p></li><li><p><strong>启用</strong> 默认情况下启用了 <a href=https://www.envoyproxy.io/docs/envoy/latest/api-docs/xds_protocol#incremental-xds>Delta xDS</a>。
有关详细信息，请参阅升级说明。
(<a href=https://github.com/istio/istio/issues/47949>Issue #47949</a>)</p></li><li><p><strong>修复</strong> 修复了一个 Kubernetes 网关无法与命名空间范围的 waypoint 代理正常协作的问题。</p></li><li><p><strong>修复</strong> 修复了 Delta ADS 客户端收到包含 <code>RemoveResources</code> 响应的问题。</p></li><li><p><strong>修复</strong> 修复了使用 <code>withoutHeaders</code> 在 <code>VirtualService</code> 中配置路由匹配规则时的问题。
如果请求头中不存在 <code>withoutHeaders</code> 中指定的字段，Istio 无法匹配该请求。
(<a href=https://github.com/istio/istio/issues/49537>Issue #49537</a>)</p></li><li><p><strong>修复</strong> 修复了当 Envoy 过滤器位于根命名空间和代理命名空间时，其优先级被忽略的问题。
(<a href=https://github.com/istio/istio/issues/49555>Issue #49555</a>)</p></li><li><p><strong>修复</strong> 修复了 <code>--log_as_json</code> 选项不适用于 <code>istio-init</code> 容器的问题。
(<a href=https://github.com/istio/istio/issues/44352>Issue #44352</a>)</p></li><li><p><strong>修复</strong> 修复了添加或删除重复主机时大量虚拟 IP 被重新洗牌的问题。
(<a href=https://github.com/istio/istio/issues/49965>Issue #49965</a>)</p></li><li><p><strong>修复</strong> 修复了网关状态地址从集群外部接收服务 VIP 的问题。</p></li><li><p><strong>修复</strong> 将 <code>use-waypoint</code> 注解修改为标签，以保持一致性。
(<a href=https://github.com/istio/istio/issues/50572>Issue #50572</a>)</p></li><li><p><strong>修复</strong> 修复了使用域名地址构建 EDS 类型的集群端点的问题。
(<a href=https://github.com/istio/istio/issues/50688>Issue #50688</a>)</p></li><li><p><strong>修复</strong> 修复了当 <code>InboundTrafficPolicy</code> 被设置为“localhost”时注入模板被错误评估的错误。
(<a href=https://github.com/istio/istio/issues/50700>Issue #50700</a>)</p></li><li><p><strong>修复</strong> 修复了向 waypoint HBONE 端点添加服务器端 <code>keeplive</code> 的问题。
(<a href=https://github.com/istio/istio/issues/50737>Issue #50737</a>)</p></li><li><p><strong>修复</strong> 修复了 <code>HTTPMatchRequest</code> 中的空前缀匹配不会被验证 Webhook 拒绝的问题。
(<a href=https://github.com/istio/istio/issues/48534>Issue #48534</a>)</p></li><li><p><strong>修复</strong> 修复了 Istio 1.20 中的行为更改，该更改导致 <code>ServiceEntries</code> 与相同主机名和端口名称的合并产生意外结果。
(<a href=https://github.com/istio/istio/issues/50478>Issue #50478</a>)</p></li><li><p><strong>修复</strong> 修复了当 Sidecar 资源配置了具有 Kubernetes 服务的不同端口的多个出口侦听器时，
Sidecar 资源无法正确合并端口的错误。这导致仅使用第一个端口创建一个集群，而第二个端口被忽略。</p></li><li><p><strong>修复</strong> 修复了导致路由被其他虚拟服务覆盖的问题。</p></li><li><p><strong>移除</strong> 从 <code>istio-cni</code> 节点代理 Chart 中移除了 <code>values.cni.privileged</code> 标志，以支持特定于功能的权限。
(<a href=https://github.com/istio/istio/issues/49004>Issue #49004</a>)</p></li><li><p><strong>移除</strong> 移除了 <code>PILOT_ENABLE_HEADLESS_SERVICE_POD_LISTENERS</code> 功能标志。</p></li><li><p><strong>移除</strong> 移除了 <code>PILOT_ENABLE_INBOUND_PASSTHROUGH</code> 设置，该设置在过去 8 个版本中默认启用。
现在可以使用新的<a href=https://github.com/istio/api/blob/9911a0a6990a18a45ed1b00559156dcc7e836e52/mesh/v1alpha1/config.proto#L203>入站流量策略模式</a>配置此功能。</p></li></ul><h2 id=security>安全性</h2><ul><li><p><strong>更新</strong> 将功能标志 <code>ENABLE_AUTO_ENHANCED_RESOURCE_SCOPING</code> 的默认值更新为 <code>true</code>。</p></li><li><p><strong>新增</strong> 添加了对 <code>AuthorizationPolicy</code> 中路径模板的支持。
请参阅 Envoy URI 模板<a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/path/match/uri_template/v3/uri_template_match.proto>文档</a>。
(<a href=https://github.com/istio/istio/issues/16585>Issue #16585</a>)</p></li><li><p><strong>新增</strong> 添加了支持在解析 <code>jwksUri</code> 时自定义连接超时设置。
(<a href=https://github.com/istio/istio/issues/47328>Issue #47328</a>)</p></li><li><p><strong>新增</strong> 添加了 Istio CA 支持通过模拟远程集群的身份来处理 CSR 的节点授权。
这可以帮助 Istio CA 在外部控制平面场景中对远程集群中的 ztunnel 进行身份验证。
(<a href=https://github.com/istio/istio/issues/47489>Issue #47489</a>)</p></li><li><p><strong>新增</strong> 添加了 <code>METRICS_LOCALHOST_ACCESS_ONLY</code> 环境变量，用于从 Pod 外部禁用指标端点，
以仅允许本地主机访问。用户可以在 <code>istioctl</code> 安装期间使用命令参数
<code>--set values.pilot.env.METRICS_LOCALHOST_ACCESS_ONLY=true</code>（对于控制平面）和
<code>--set meshConfig.defaultConfig.proxyMetadata.METRICS_LOCALHOST_ACCESS_ONLY=true</code>（对于代理）进行设置。</p></li><li><p><strong>新增</strong> 添加了 Certificate Revocation List（证书吊销列表，CRL）支持对等证书验证，
该支持基于 Sidecar 目标规则中的 <code>ClientTLSSettings</code> 和对于 Gateway 网关中 <code>ServerTLSSettings</code> 中指定的文件路径。</p></li><li><p><strong>修复</strong> 修复了 JWT 令牌中受众声明的列表匹配。
(<a href=https://github.com/istio/istio/issues/49913>Issue #49913</a>)</p></li><li><p><strong>移除</strong> 移除了 <code>values.global.jwtPolicy</code> 的 <code>first-party-jwt</code> 旧选项。
对更安全的 <code>third-party-jwt</code> 的支持多年来一直是默认设置，并且所有 Kubernetes 平台都支持。</p></li></ul><h2 id=telemetry>遥测</h2><ul><li><p><strong>改进</strong> 改进了 JSON 访问日志以一致的顺序发出 Key。</p></li><li><p><strong>新增</strong> 添加了选项以通过 HTTP 导出 OpenTelemetry 链路。
(<a href=/v1.23/zh/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-ExtensionProvider-OpenTelemetryTracingProvider>参考</a>) (<a href=https://github.com/istio/istio/issues/47835>Issue #47835</a>)</p></li><li><p><strong>启用</strong> 在 <code>MeshConfig</code> 中将 Dynatrace Sampler 配置为 <code>OpenTelemetryTracingProvider</code>。
(<a href=https://github.com/istio/istio/issues/50001>Issue #50001</a>)</p></li><li><p><strong>启用</strong> 在 <code>MeshConfig</code> 中将资源检测器配置为 <code>OpenTelemetryTracingProvider</code>。
(<a href=https://github.com/istio/istio/issues/48885>Issue #48885</a>)</p></li><li><p><strong>修复</strong> 修复了使用 OpenTelemetry 访问记录器时未传播 <code>TraceId</code> 的问题。
(<a href=https://github.com/istio/istio/issues/49911>Issue #49911</a>)</p></li><li><p><strong>移除</strong> 移除了默认启用链路追踪 <code>zipkin.istio-system.svc</code> 的配置。有关详细信息，请参阅升级说明。</p></li></ul><h2 id=extensibility>可扩展性</h2><ul><li><strong>改进</strong> 使用标记剥离的 URL 和 Checksum 作为 Wasm 模块缓存键，其中标记的 URL 单独缓存。
这可能会增加缓存命中的机会（例如，尝试使用标记 URL 和摘要 URL 查找相同的图像。）此外，
这将是实现 <code>ImagePullPolicy</code> 的基础。</li></ul><h2 id=installation>安装</h2><ul><li><p><strong>改进</strong> 改进了 Helm Value 字段名称，用于配置是否使用现已安装的 CNI。
支持字段将位于 <code>values.pilot.cni</code> 中，替代了 <code>values.istio_cni</code>，
因此 istiod 组件会被影响。新设置比使用 <code>values.cni</code> 用于安装配置和
<code>values.istio_cni</code> 用于 istiod 中更清晰。至少在两个版本中仍支持旧的 <code>values.istio_cni</code> 字段。
(<a href=https://github.com/istio/istio/issues/49290>Issue #49290</a>)</p></li><li><p><strong>改进</strong> 改进了 <code>meshConfig.defaultConfig.proxyMetadata</code> 字段在被覆盖时进行深度合并，而不是替换所有值。</p></li><li><p><strong>新增</strong> 添加了通过 Helm Chart 向 Istio 服务帐户资源添加自定义注解的功能。</p></li><li><p><strong>新增</strong> 添加了 <code>openshift-ambient</code> 配置文件。
(<a href=https://github.com/istio/istio/issues/42341>Issue #42341</a>)</p></li><li><p><strong>新增</strong> 添加了一个新的、可选的实验性准入政策，仅允许在 Istio API 中使用稳定的功能/字段。
(<a href=https://github.com/istio/enhancements/issues/173>Issue #173</a>)</p></li><li><p><strong>新增</strong> 添加了对配置 CA 捆绑包以进行验证和注入 Webhooks 的支持。</p></li><li><p><strong>修复</strong> 修复了从本地 ztunnel 管理端点收集 <code>pprof</code> 数据，由于缺少可写的容器内 <code>/tmp</code>，该数据将失败。
(<a href=https://github.com/istio/istio/issues/50060>Issue #50060</a>)</p></li><li><p><strong>移除</strong> 移除了已弃用的 <code>external</code> 配置文件。请使用 <code>remote</code> 配置文件进行安装。
(<a href=https://github.com/istio/istio/issues/48634>Issue #48634</a>)</p></li></ul><h2 id=istioctl>istioctl</h2><ul><li><p><strong>新增</strong> 添加了 <code>istioctl proxy-status</code> 命令，这是升级后的 <code>istioctl experimental proxy-status</code> 命令。
旧的 <code>istioctl proxy-status</code> 命令已被删除。此推动不应导致任何功能损失。
但是，现在请求是基于 xDS 而不是 HTTP 发送的，并且我们引入了一组新的基于 xDS 的标志来针对控制平面。</p></li><li><p><strong>新增</strong> 当通过<a href=/v1.23/zh/docs/setup/install/multicluster/>安装多集群</a>设置远程集群 Secret 时，
在 <code>istioctl analyze</code> 命令中添加了对多集群分析的支持。</p></li><li><p><strong>新增</strong> 添加了一个新的 <code>istioctl dashboard proxy</code> 命令，
可用于显示不同代理 Pod 的管理 UI，例如：Envoy、ztunnel 和 waypoint。</p></li><li><p><strong>新增</strong> 为 <code>istioctl experimental wait</code> 命令添加了 <code>--proxy</code> 选项。
(<a href=https://github.com/istio/istio/issues/48696>Issue #48696</a>)</p></li><li><p><strong>新增</strong> 为 <code>istioctl proxy-config workload</code> 命令添加了命名空间过滤，
使用 <code>--workloads-namespace</code> 标志来显示指定命名空间中的工作负载。</p></li><li><p><strong>新增</strong> 添加了 <code>istioctl dashboard istio-debug</code> 命令来显示 Istio 调试端点仪表板。</p></li><li><p><strong>新增</strong> 添加了 <code>istioctl experimental describe</code> 命令以支持显示 <code>PortLevelSettings</code> 策略的详细信息。
(<a href=https://github.com/istio/istio/issues/49802>Issue #49802</a>)</p></li><li><p><strong>新增</strong> 添加了在使用 <code>istioctl experimental waypoint apply</code> 命令时通过
<code>--for</code> 标志定义 waypoint 的流量地址类型（服务、工作负载、全部或无）的能力。
(<a href=https://github.com/istio/istio/issues/49896>Issue #49896</a>)</p></li><li><p><strong>新增</strong> 添加了通过 waypoint 命令上的 <code>--name</code> 标志使用 <code>istioctl</code> 命名 waypoint 的功能。
(<a href=https://github.com/istio/istio/issues/49915>Issue #49915</a>), (<a href=https://github.com/istio/istio/issues/50173>Issue #50173</a>)</p></li><li><p><strong>移除</strong> 移除了通过删除 waypoint 命令上的 <code>--service-account</code> 标志来指定 waypoint 的服务帐户的能力。
(<a href=https://github.com/istio/istio/issues/49915>Issue #49915</a>), (<a href=https://github.com/istio/istio/issues/50173>Issue #50173</a>)</p></li><li><p><strong>新增</strong> 添加了通过 waypoint 命令上的 <code>--enroll-namespace</code>
标志使用 <code>istioctl</code> 在 waypoint 的命名空间中注册 waypoint 代理的功能。
(<a href=https://github.com/istio/istio/issues/50248>Issue #50248</a>)</p></li><li><p><strong>新增</strong> 添加了 <code>istioctl ztunnel-config</code> 命令。
这允许用户通过 <code>istioctl ztunnel-config workload</code> 命令查看 ztunnel 配置信息。
(<a href=https://github.com/istio/istio/issues/49841>Issue #49841</a>)</p></li><li><p><strong>移除</strong> 从 proxy-config 命令中删除了工作负载标志。
使用 <code>istioctl ztunnel-config workload</code> 命令来查看 ztunnel 配置信息。
(<a href=https://github.com/istio/istio/issues/49841>Issue #49841</a>)</p></li><li><p><strong>新增</strong> 添加了使用 <code>istioctl experimental waypoint apply --enroll-namespace</code> 时的警告，
并且命名空间未被标记为 Ambient 重定向。
(<a href=https://github.com/istio/istio/issues/50396>Issue #50396</a>)</p></li><li><p><strong>新增</strong> 在 <code>istioctl experimental waypoint generate</code> 命令中添加了 <code>--for</code> 标志，
以便用户可以在应用 YAML 之前预览它。
(<a href=https://github.com/istio/istio/issues/50790>Issue #50790</a>)</p></li><li><p><strong>新增</strong> 向 <code>istioctl</code> 添加了实验性 OpenShift Kubernetes 平台配置文件。
要使用 OpenShift 配置文件进行安装，请使用 <code>istioctl install --set profile=openshift</code>。
请参阅 <a href=/v1.23/zh/docs/setup/platform-setup/openshift/>OpenShift 平台设置</a>和<a href=/v1.23/zh/docs/setup/install/istioctl/#install-a-different-profile>使用 <code>istioctl</code> 安装 OpenShift</a> 文档以获取更多信息。</p></li><li><p><strong>新增</strong> 为 <code>istioctl experimental envoy-stats</code> 命令添加了 <code>--proxy-admin-port</code> 标志，
以设置自定义代理管理端口。</p></li><li><p><strong>修复</strong> 修复了由于配置未知，<code>istioctl experimental proxy-status &lt;pod></code> 比较命令无法正常工作的问题。</p></li><li><p><strong>修复</strong> 修复了 <code>istioctl describe</code> 命令不显示非 <code>istio-system</code> 命名空间下的 Ingress 信息。
(<a href=https://github.com/istio/istio/issues/50074>Issue #50074</a>)</p></li></ul></div><nav class=pagenav><div class=left></div><div class=right><a title="Important changes to consider when upgrading to Istio 1.22.x.升级到 Istio 1.22.x 时要考虑的重要变更。" href=/v1.23/zh/news/releases/1.22.x/announcing-1.22/upgrade-notes/ class=next-link>Istio 1.22 升级说明<svg class="icon right-arrow"><use xlink:href="/v1.23/img/icons.svg#right-arrow"/></svg></a></div></nav></article><footer class=footer><div class="footer-wrapper container-l"><div class="user-links footer-links"><a class=channel title='Istio 的代码在 GitHub 上开发' href=https://github.com/istio/community aria-label=GitHub><svg class="icon github"><use xlink:href="/v1.23/img/icons.svg#github"/></svg>
</a><a class=channel title='如果您想深入了解 Istio 的技术细节，请查看我们日益完善的设计文档' href=https://groups.google.com/forum/#!forum/istio-team-drive-access aria-label="team drive"><svg class="icon drive"><use xlink:href="/v1.23/img/icons.svg#drive"/></svg>
</a><a class=channel title='在 Slack 上与 Istio 社区交互讨论开发问题（仅限邀请）' href=https://slack.istio.io aria-label=slack><svg class="icon slack"><use xlink:href="/v1.23/img/icons.svg#slack"/></svg>
</a><a class=channel title='Stack Overflow 中列举了针对实际问题以及部署、配置和使用 Istio 的各项回答' href=https://stackoverflow.com/questions/tagged/istio aria-label="Stack Overflow"><svg class="icon stackoverflow"><use xlink:href="/v1.23/img/icons.svg#stackoverflow"/></svg>
</a><a class=channel title='关注我们的 Twitter 来获取最新信息' href=https://twitter.com/IstioMesh aria-label=Twitter><svg class="icon twitter"><use xlink:href="/v1.23/img/icons.svg#twitter"/></svg></a></div><hr class=footer-separator role=separator><div class="info footer-info"><a class=logo href=/v1.23/zh/ aria-label=logotype><svg width="128" height="60" viewBox="0 0 128 60"><path d="M58.434 48.823A.441.441.0 0158.3 48.497V22.583a.444.444.0 01.134-.326.446.446.0 01.327-.134h3.527a.447.447.0 01.325.134.447.447.0 01.134.326v25.914a.443.443.0 01-.134.326.444.444.0 01-.325.134h-3.527a.444.444.0 01-.327-.134z"/><path d="m70.969 48.477a6.556 6.556.0 01-2.818-1.955 4.338 4.338.0 01-1-2.78v-.345a.443.443.0 01.134-.326.444.444.0 01.326-.135h3.374a.444.444.0 01.326.135.445.445.0 01.134.326v.077a2.014 2.014.0 001.054 1.667 4.672 4.672.0 002.664.709 4.446 4.446.0 002.492-.633 1.862 1.862.0 00.958-1.591 1.426 1.426.0 00-.786-1.322 12.7 12.7.0 00-2.549-.939l-1.457-.46a21.526 21.526.0 01-3.3-1.227 6.57 6.57.0 01-2.262-1.783 4.435 4.435.0 01-.92-2.894 5.081 5.081.0 012.109-4.275 8.993 8.993.0 015.558-1.591 10.445 10.445.0 014.1.748 6.3 6.3.0 012.722 2.07 5 5 0 01.958 3.009.441.441.0 01-.134.326.441.441.0 01-.325.134h-3.258a.441.441.0 01-.326-.134.443.443.0 01-.134-.326 1.974 1.974.0 00-.978-1.667 4.647 4.647.0 00-2.665-.671 4.741 4.741.0 00-2.435.556 1.724 1.724.0 00-.938 1.553 1.512 1.512.0 00.9 1.4 15.875 15.875.0 003.01 1.055l.843.229a27.368 27.368.0 013.412 1.246 6.67 6.67.0 012.338 1.763 4.387 4.387.0 01.958 2.933 4.988 4.988.0 01-2.146 4.275 9.543 9.543.0 01-5.712 1.552 11.626 11.626.0 01-4.227-.709z"/><path d="m97.039 32.837a.443.443.0 01-.326.135h-3.911a.169.169.0 00-.191.192v9.239a2.951 2.951.0 00.632 2.108 2.7 2.7.0 002.013.652h1.15a.444.444.0 01.325.134.441.441.0 01.134.326v2.875a.471.471.0 01-.459.5l-1.994.039a8 8 0 01-4.524-1.035q-1.495-1.035-1.533-3.91V33.166A.17.17.0 0088.164 32.974H85.978A.441.441.0 0185.652 32.839.441.441.0 0185.518 32.513V29.83a.441.441.0 01.134-.326.444.444.0 01.326-.135h2.186a.169.169.0 00.191-.192v-4.485a.438.438.0 01.134-.326.44.44.0 01.325-.134h3.336a.443.443.0 01.325.134.442.442.0 01.135.326v4.485a.169.169.0 00.191.192h3.911a.446.446.0 01.326.135.446.446.0 01.134.326v2.683a.446.446.0 01-.133.324z"/><path d="m101.694 25.917a2.645 2.645.0 01-.767-1.955 2.65 2.65.0 01.767-1.955 2.65 2.65.0 011.955-.767 2.65 2.65.0 011.955.767 2.652 2.652.0 01.767 1.955 2.647 2.647.0 01-.767 1.955 2.646 2.646.0 01-1.955.767 2.645 2.645.0 01-1.955-.767zm-.211 22.906a.441.441.0 01-.134-.326V29.79a.444.444.0 01.134-.326.446.446.0 01.326-.134h3.527a.446.446.0 01.326.134.445.445.0 01.134.326v18.707a.443.443.0 01-.134.326.443.443.0 01-.326.134h-3.527a.443.443.0 01-.326-.134z"/><path d="m114.019 47.734a8.1 8.1.0 01-3.047-4.255 14.439 14.439.0 01-.652-4.37 14.3 14.3.0 01.614-4.371A7.869 7.869.0 01114 30.56a9.072 9.072.0 015.252-1.5 8.543 8.543.0 015.041 1.5 7.985 7.985.0 013.009 4.14 12.439 12.439.0 01.69 4.37 13.793 13.793.0 01-.651 4.37 8.255 8.255.0 01-3.028 4.275 8.475 8.475.0 01-5.1 1.553 8.754 8.754.0 01-5.194-1.534zm7.629-3.1a4.536 4.536.0 001.476-2.262 11.335 11.335.0 00.383-3.221 10.618 10.618.0 00-.383-3.22 4.169 4.169.0 00-1.457-2.243 4.066 4.066.0 00-2.531-.785 3.942 3.942.0 00-2.453.785 4.376 4.376.0 00-1.5 2.243 11.839 11.839.0 00-.383 3.22 11.84 11.84.0 00.383 3.221 4.222 4.222.0 001.476 2.262 4.075 4.075.0 002.549.8 3.8 3.8.0 002.44-.809z"/><path d="m15.105 32.057v15.565a.059.059.0 01-.049.059L.069 50.25A.06.06.0 01.005 50.167l14.987-33.47a.06.06.0 01.114.025z"/><path d="m17.631 23.087v24.6a.06.06.0 00.053.059l22.449 2.507a.06.06.0 00.061-.084L17.745.032a.06.06.0 00-.114.024z"/><path d="m39.961 52.548-24.833 7.45a.062.062.0 01-.043.0L.079 52.548a.059.059.0 01.026-.113h39.839a.06.06.0 01.017.113z"/></svg></a><div class=footer-languages><a tabindex=-1 lang=en id=switch-lang-en class=footer-languages-item>English
</a><a tabindex=-1 lang=zh id=switch-lang-zh class="footer-languages-item active"><svg class="icon tick"><use xlink:href="/v1.23/img/icons.svg#tick"/></svg>
中文</a></div></div><ul class=footer-policies><li class=footer-policies-item><a class=footer-policies-link href=https://www.linuxfoundation.org/legal/terms>条款
</a>|
<a class=footer-policies-link href=https://www.linuxfoundation.org/legal/privacy-policy>隐私政策
</a>|
<a class=footer-policies-link href=https://www.linuxfoundation.org/legal/trademark-usage>商标
</a>|
<a class=footer-policies-link href=https://github.com/istio/istio.io/edit/release-1.23/content/zh/news/releases/1.22.x/announcing-1.22/change-notes/index.md>在 GitHub 上编辑此页</a></li></ul><div class=footer-base><span class=footer-base-copyright>&copy; 2024 the Istio Authors.</span>
<span class=footer-base-version>部分内容可能滞后于英文版本，同步工作正在进行中<br>版本
Istio 归档
1.23.3</span><ul class=footer-base-releases><li class=footer-base-releases-item><a tabindex=-1 class=footer-base-releases-link onclick='return navigateToUrlOrRoot("https://istio.io/news/releases/1.22.x/announcing-1.22/change-notes/"),!1'>当前版本</a></li><li class=footer-base-releases-item><a tabindex=-1 class=footer-base-releases-link onclick='return navigateToUrlOrRoot("https://preliminary.istio.io/news/releases/1.22.x/announcing-1.22/change-notes/"),!1'>下个版本</a></li><li class=footer-base-releases-item><a tabindex=-1 class=footer-base-releases-link href=https://istio.io/archive>旧版本</a></li></ul></div></div></footer><div id=scroll-to-top-container aria-hidden=true><button id=scroll-to-top title=回到顶部 tabindex=-1><svg class="icon top"><use xlink:href="/v1.23/img/icons.svg#top"/></svg></button></div></body></html>