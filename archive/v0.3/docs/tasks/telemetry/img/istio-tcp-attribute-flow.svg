<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="800" height="1540"><source><![CDATA[participant Source\nService as S [fillcolor="white"]
participant Destination\nEnvoy Proxy as P [fillcolor="#cfe2f3"]
participant Mixer as M [fillcolor="#cfe2f3"]
participant Destination\nService as D [fillcolor="white"]
# Note right of A: By listing the\n participants you can\n change their order

S->P: connect() [fillcolor="white"]

Note over P: Proxy must confirm \n connection allowed [fillcolor="white"]

P->M: Check(CheckRequest)

Note right of P: Attributes (values):\n context.protocol ("tcp")\n connection.id\n source.ip\n source.port\n source.user\n destination.uid\n destination.service\n request.time [fillcolor="#cfe2f3"]

M-->P: CheckResponse
P->D: connect() [fillcolor="white"]
D-->P: accept() [fillcolor="white"]
P-->S: accept() [fillcolor="white"]

Note over S: With connection\n established,\n start sending data [fillcolor="white"]

S->P: send() [fillcolor="white"]
P->D: send() [fillcolor="white"]
D-->P: recv() [fillcolor="white" ]
P-->S: recv() [fillcolor="white" ]

Note over S: ... [fillcolor="white"]

S->P: close() [fillcolor="white"]
P->D: close() [fillcolor="white"]
D-->P: close() [fillcolor="white" ]
P-->S: close() [fillcolor="white" ]

P->>M: Report(ReportRequest)

Note right of P: Attributes (values):\n connection.duration\n connection.id\n connection.received.bytes\n connection.received.bytes_total\n connection.sent.bytes\n connection.sent.bytes_total\n context.protocol ("tcp")\n context.time\n source.ip\n source.port\n source.user\n destination.ip\n destination.port\n destination.uid\n destination.service\n request.time [fillcolor="#cfe2f3"]

M-->P: ReportResponse]]></source><desc style="-webkit-tap-highlight-color:transparent">Created with RaphaÃ«l 2.2.0</desc><defs style="-webkit-tap-highlight-color:transparent"><path id="raphael-marker-block" stroke-linecap="round" d="M5,0 0,2.5 5,5z" style="-webkit-tap-highlight-color:transparent"/><marker id="raphael-marker-endblock55-objuivef" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objlacct" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objy1mdp" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objtg3s6" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objjumy3" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objyqhnp" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objvmh3h" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objiovjl" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-obj64i43" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objajm7i" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objr4x5a" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-obji2rks" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objw0z89" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objssggg" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><path id="raphael-marker-open" stroke-linecap="round" d="M6,1 1,3.5 6,6" style="-webkit-tap-highlight-color:transparent"/><marker id="raphael-marker-endopen77-objniepu" markerHeight="7" markerWidth="7" orient="auto" refX="4" refY="3.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" stroke="#000" stroke-width="1" transform="rotate(180 3.5 3.5) scale(1,1)" xlink:href="#raphael-marker-open" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objl3b9p" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker></defs><rect width="87.609" height="57.188" x="62.609" y="20" fill="#fff" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="67.609" height="37.188" x="72.797" y="30" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="106.414" y="48.594" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-3.594" style="-webkit-tap-highlight-color:transparent">Source</tspan><tspan x="106.414" dy="19.2" style="-webkit-tap-highlight-color:transparent">Service</tspan></text><rect width="87.609" height="57.188" x="62.609" y="1463.547" fill="#fff" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="67.609" height="37.188" x="72.797" y="1473.547" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="106.414" y="1492.141" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-3.594" style="-webkit-tap-highlight-color:transparent">Source</tspan><tspan x="106.414" dy="19.2" style="-webkit-tap-highlight-color:transparent">Service</tspan></text><path fill="none" stroke="#000" stroke-width="2" d="M106.4140625,77.1875L106.4140625,1463.546875" style="-webkit-tap-highlight-color:transparent"/><rect width="126.016" height="57.188" x="170.219" y="20" fill="#cfe2f3" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="106.016" height="37.188" x="180.406" y="30" fill="#cfe2f3" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="233.227" y="48.594" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-3.594" style="-webkit-tap-highlight-color:transparent">Destination</tspan><tspan x="233.227" dy="19.2" style="-webkit-tap-highlight-color:transparent">Envoy Proxy</tspan></text><rect width="126.016" height="57.188" x="170.219" y="1463.547" fill="#cfe2f3" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="106.016" height="37.188" x="180.406" y="1473.547" fill="#cfe2f3" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="233.227" y="1492.141" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-3.594" style="-webkit-tap-highlight-color:transparent">Destination</tspan><tspan x="233.227" dy="19.2" style="-webkit-tap-highlight-color:transparent">Envoy Proxy</tspan></text><path fill="none" stroke="#000" stroke-width="2" d="M233.2265625,77.1875L233.2265625,1463.546875" style="-webkit-tap-highlight-color:transparent"/><rect width="68.406" height="57.188" x="556.273" y="20" fill="#cfe2f3" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="48.406" height="18" x="566.469" y="39.594" fill="#cfe2f3" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="590.477" y="48.594" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Mixer</tspan></text><rect width="68.406" height="57.188" x="556.273" y="1463.547" fill="#cfe2f3" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="48.406" height="18" x="566.469" y="1483.141" fill="#cfe2f3" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="590.477" y="1492.141" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Mixer</tspan></text><path fill="none" stroke="#000" stroke-width="2" d="M590.4765625,77.1875L590.4765625,1463.546875" style="-webkit-tap-highlight-color:transparent"/><rect width="125.609" height="57.188" x="644.68" y="20" fill="#fff" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="105.609" height="37.188" x="654.672" y="30" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="707.484" y="48.594" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-3.594" style="-webkit-tap-highlight-color:transparent">Destination</tspan><tspan x="707.484" dy="19.2" style="-webkit-tap-highlight-color:transparent">Service</tspan></text><rect width="125.609" height="57.188" x="644.68" y="1463.547" fill="#fff" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="105.609" height="37.188" x="654.672" y="1473.547" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="707.484" y="1492.141" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-3.594" style="-webkit-tap-highlight-color:transparent">Destination</tspan><tspan x="707.484" dy="19.2" style="-webkit-tap-highlight-color:transparent">Service</tspan></text><path fill="none" stroke="#000" stroke-width="2" d="M707.484375,77.1875L707.484375,1463.546875" style="-webkit-tap-highlight-color:transparent"/><rect width="86.406" height="18" x="126.609" y="93.188" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="169.82" y="102.188" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">connect()</tspan></text><path fill="none" stroke="#000" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objuivef)" d="M106.4140625,115.1875C106.4140625,115.1875,204.7550246603787,115.1875,228.2358500980863,115.1875" style="-webkit-tap-highlight-color:transparent"/><rect width="192.422" height="47.188" x="137.016" y="135.188" fill="#fff" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="182.422" height="37.188" x="142" y="140.188" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="233.227" y="158.781" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-3.594" style="-webkit-tap-highlight-color:transparent">Proxy must confirm </tspan><tspan x="233.227" dy="19.2" style="-webkit-tap-highlight-color:transparent"> connection allowed</tspan></text><rect width="182.422" height="18" x="320.625" y="198.375" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="411.852" y="207.375" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Check(CheckRequest)</tspan></text><path fill="none" stroke="#000" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objlacct)" d="M233.2265625,220.375C233.2265625,220.375,542.2477786429226,220.375,585.477553264479,220.375" style="-webkit-tap-highlight-color:transparent"/><rect width="250.031" height="181.594" x="253.227" y="240.375" fill="#cfe2f3" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="240.031" height="171.594" x="258.219" y="245.375" fill="#cfe2f3" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="378.242" y="331.172" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-70.797" style="-webkit-tap-highlight-color:transparent">Attributes (values):</tspan><tspan x="378.242" dy="19.2" style="-webkit-tap-highlight-color:transparent"> context.protocol (&quot;tcp&quot;)</tspan><tspan x="378.242" dy="19.2" style="-webkit-tap-highlight-color:transparent"> connection.id</tspan><tspan x="378.242" dy="19.2" style="-webkit-tap-highlight-color:transparent"> source.ip</tspan><tspan x="378.242" dy="19.2" style="-webkit-tap-highlight-color:transparent"> source.port</tspan><tspan x="378.242" dy="19.2" style="-webkit-tap-highlight-color:transparent"> source.user</tspan><tspan x="378.242" dy="19.2" style="-webkit-tap-highlight-color:transparent"> destination.uid</tspan><tspan x="378.242" dy="19.2" style="-webkit-tap-highlight-color:transparent"> destination.service</tspan><tspan x="378.242" dy="19.2" style="-webkit-tap-highlight-color:transparent"> request.time</tspan></text><rect width="125.219" height="18" x="349.438" y="437.969" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="411.852" y="446.969" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">CheckResponse</tspan></text><path fill="none" stroke="#000" stroke-dasharray="6 2" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objy1mdp)" d="M590.4765625,459.96875C590.4765625,459.96875,281.45534635707736,459.96875,238.22557173552104,459.96875" style="-webkit-tap-highlight-color:transparent"/><rect width="86.406" height="18" x="427.141" y="475.969" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="470.355" y="484.969" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">connect()</tspan></text><path fill="none" stroke="#000" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objtg3s6)" d="M233.2265625,497.96875C233.2265625,497.96875,651.7933111488819,497.96875,702.4791283680825,497.96875" style="-webkit-tap-highlight-color:transparent"/><rect width="76.813" height="18" x="431.938" y="513.969" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="470.355" y="522.969" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">accept()</tspan></text><path fill="none" stroke="#000" stroke-dasharray="6 2" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objjumy3)" d="M707.484375,535.96875C707.484375,535.96875,288.9176263511181,535.96875,238.23180913191754,535.96875" style="-webkit-tap-highlight-color:transparent"/><rect width="76.813" height="18" x="131.406" y="551.969" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="169.82" y="560.969" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">accept()</tspan></text><path fill="none" stroke="#000" stroke-dasharray="6 2" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objyqhnp)" d="M233.2265625,573.96875C233.2265625,573.96875,134.8856003396213,573.96875,111.4047749019137,573.96875" style="-webkit-tap-highlight-color:transparent"/><rect width="192.828" height="66.391" x="10" y="593.969" fill="#fff" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="182.828" height="56.391" x="15.188" y="598.969" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="106.414" y="627.164" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-13.195" style="-webkit-tap-highlight-color:transparent">With connection</tspan><tspan x="106.414" dy="19.2" style="-webkit-tap-highlight-color:transparent"> established,</tspan><tspan x="106.414" dy="19.2" style="-webkit-tap-highlight-color:transparent"> start sending data</tspan></text><rect width="57.609" height="18" x="141.016" y="676.359" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="169.82" y="685.359" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">send()</tspan></text><path fill="none" stroke="#000" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objvmh3h)" d="M106.4140625,698.359375C106.4140625,698.359375,204.7550246603787,698.359375,228.2358500980863,698.359375" style="-webkit-tap-highlight-color:transparent"/><rect width="57.609" height="18" x="441.547" y="714.359" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="470.355" y="723.359" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">send()</tspan></text><path fill="none" stroke="#000" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objiovjl)" d="M233.2265625,736.359375C233.2265625,736.359375,651.7933111488819,736.359375,702.4791283680825,736.359375" style="-webkit-tap-highlight-color:transparent"/><rect width="57.609" height="18" x="441.547" y="752.359" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="470.355" y="761.359" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">recv()</tspan></text><path fill="none" stroke="#000" stroke-dasharray="6 2" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj64i43)" d="M707.484375,774.359375C707.484375,774.359375,288.9176263511181,774.359375,238.23180913191754,774.359375" style="-webkit-tap-highlight-color:transparent"/><rect width="57.609" height="18" x="141.016" y="790.359" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="169.82" y="799.359" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">recv()</tspan></text><path fill="none" stroke="#000" stroke-dasharray="6 2" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objajm7i)" d="M233.2265625,812.359375C233.2265625,812.359375,134.8856003396213,812.359375,111.4047749019137,812.359375" style="-webkit-tap-highlight-color:transparent"/><rect width="38.797" height="28" x="87.016" y="832.359" fill="#fff" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="28.797" height="18" x="92" y="837.359" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="106.414" y="846.359" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">...</tspan></text><rect width="67.203" height="18" x="136.203" y="876.359" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="169.82" y="885.359" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">close()</tspan></text><path fill="none" stroke="#000" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objr4x5a)" d="M106.4140625,898.359375C106.4140625,898.359375,204.7550246603787,898.359375,228.2358500980863,898.359375" style="-webkit-tap-highlight-color:transparent"/><rect width="67.203" height="18" x="436.75" y="914.359" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="470.355" y="923.359" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">close()</tspan></text><path fill="none" stroke="#000" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obji2rks)" d="M233.2265625,936.359375C233.2265625,936.359375,651.7933111488819,936.359375,702.4791283680825,936.359375" style="-webkit-tap-highlight-color:transparent"/><rect width="67.203" height="18" x="436.75" y="952.359" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="470.355" y="961.359" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">close()</tspan></text><path fill="none" stroke="#000" stroke-dasharray="6 2" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objw0z89)" d="M707.484375,974.359375C707.484375,974.359375,288.9176263511181,974.359375,238.23180913191754,974.359375" style="-webkit-tap-highlight-color:transparent"/><rect width="67.203" height="18" x="136.203" y="990.359" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="169.82" y="999.359" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">close()</tspan></text><path fill="none" stroke="#000" stroke-dasharray="6 2" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objssggg)" d="M233.2265625,1012.359375C233.2265625,1012.359375,134.8856003396213,1012.359375,111.4047749019137,1012.359375" style="-webkit-tap-highlight-color:transparent"/><rect width="201.625" height="18" x="311.031" y="1028.359" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="411.852" y="1037.359" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Report(ReportRequest)</tspan></text><path fill="none" stroke="#000" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endopen77-objniepu)" d="M233.2265625,1050.359375C233.2265625,1050.359375,559.7675545215607,1050.359375,588.4674463984556,1050.359375" style="-webkit-tap-highlight-color:transparent"/><rect width="317.25" height="335.188" x="253.227" y="1070.359" fill="#cfe2f3" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="307.25" height="325.188" x="258.219" y="1075.359" fill="#cfe2f3" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="411.852" y="1237.953" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-147.594" style="-webkit-tap-highlight-color:transparent">Attributes (values):</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> connection.duration</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> connection.id</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> connection.received.bytes</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> connection.received.bytes_total</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> connection.sent.bytes</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> connection.sent.bytes_total</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> context.protocol (&quot;tcp&quot;)</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> context.time</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> source.ip</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> source.port</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> source.user</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> destination.ip</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> destination.port</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> destination.uid</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> destination.service</tspan><tspan x="411.852" dy="19.2" style="-webkit-tap-highlight-color:transparent"> request.time</tspan></text><rect width="134.813" height="18" x="344.641" y="1421.547" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="411.852" y="1430.547" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">ReportResponse</tspan></text><path fill="none" stroke="#000" stroke-dasharray="6 2" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objl3b9p)" d="M590.4765625,1443.546875C590.4765625,1443.546875,281.45534635707736,1443.546875,238.22557173552104,1443.546875" style="-webkit-tap-highlight-color:transparent"/></svg>