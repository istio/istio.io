<!doctype html><html lang=en itemscope itemtype=https://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=theme-color content="#466BB0"><meta name=title content="Layer 4 Networking & mTLS with Ztunnel"><meta name=description content='Understand and manage Istio&#39;s "zero-trust tunnel" proxy.'><meta name=keywords content="microservices,services,mesh"><meta property="og:title" content="Layer 4 Networking & mTLS with Ztunnel"><meta property="og:type" content="website"><meta property="og:description" content='Understand and manage Istio&#39;s "zero-trust tunnel" proxy.'><meta property="og:url" content="/v1.21/docs/ops/ambient/usage/ztunnel/"><meta property="og:image" content="https://raw.githubusercontent.com/istio/istio.io/master/static/img/istio-social.png"><meta property="og:image:alt" content="The Istio sailboat logo"><meta property="og:image:width" content="4096"><meta property="og:image:height" content="2048"><meta property="og:site_name" content="Istio"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@IstioMesh"><title>Istioldie 1.21 / Layer 4 Networking & mTLS with Ztunnel</title>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-98480406-2"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-98480406-2")</script><link rel=alternate type=application/rss+xml title="Istio Blog" href=/v1.21/blog/feed.xml><link rel=alternate type=application/rss+xml title="Istio News" href=/v1.21/news/feed.xml><link rel=alternate type=application/rss+xml title="Istio Blog and News" href=/v1.21/feed.xml><link rel="shortcut icon" href=/v1.21/favicons/favicon.ico><link rel=apple-touch-icon href=/v1.21/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/v1.21/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/v1.21/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/v1.21/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/v1.21/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/v1.21/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/v1.21/favicons/android-96x96.png sizes=96xW96><link rel=icon type=image/png href=/v1.21/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/v1.21/favicons/android-192x192.png sizes=192x192><link rel=icon type=image/svg+xml href=/v1.21/favicons/favicon.svg><link rel=icon type=image/png href=/v1.21/favicons/favicon.png><link rel=mask-icon href=/v1.21/favicons/safari-pinned-tab.svg color=#466BB0><link rel=manifest href=/v1.21/manifest.json><meta name=apple-mobile-web-app-title content="Istio"><meta name=application-name content="Istio"><meta name=msapplication-config content="/browserconfig.xml"><meta name=msapplication-TileColor content="#466BB0"><meta name=theme-color content="#466BB0"><link rel=stylesheet href=/v1.21/css/all.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,400;0,500;0,600;0,700;1,400;1,600&display=swap"><script src=/v1.21/js/themes_init.min.js></script></head><body class="language-unknown archive-site"><script>const branchName="release-1.21",docTitle="Layer 4 Networking & mTLS with Ztunnel",iconFile="/v1.21//img/icons.svg",buttonCopy="Copy to clipboard",buttonPrint="Print",buttonDownload="Download"</script><script src="https://www.google.com/cse/brand?form=search-form" defer></script><script src=/v1.21/js/all.min.js data-manual defer></script><header class=main-navigation><nav class="main-navigation-wrapper container-l"><div class=main-navigation-header><a id=brand href=/v1.21/ aria-label=logotype><span class=logo><svg xmlns="http://www.w3.org/2000/svg" width="128" height="60" viewBox="0 0 128 60"><path d="M58.434 48.823A.441.441.0 0158.3 48.497V22.583a.444.444.0 01.134-.326.446.446.0 01.327-.134h3.527a.447.447.0 01.325.134.447.447.0 01.134.326v25.914a.443.443.0 01-.134.326.444.444.0 01-.325.134h-3.527a.444.444.0 01-.327-.134z"/><path d="m70.969 48.477a6.556 6.556.0 01-2.818-1.955 4.338 4.338.0 01-1-2.78v-.345a.443.443.0 01.134-.326.444.444.0 01.326-.135h3.374a.444.444.0 01.326.135.445.445.0 01.134.326v.077a2.014 2.014.0 001.054 1.667 4.672 4.672.0 002.664.709 4.446 4.446.0 002.492-.633 1.862 1.862.0 00.958-1.591 1.426 1.426.0 00-.786-1.322 12.7 12.7.0 00-2.549-.939l-1.457-.46a21.526 21.526.0 01-3.3-1.227 6.57 6.57.0 01-2.262-1.783 4.435 4.435.0 01-.92-2.894 5.081 5.081.0 012.109-4.275 8.993 8.993.0 015.558-1.591 10.445 10.445.0 014.1.748 6.3 6.3.0 012.722 2.07 5 5 0 01.958 3.009.441.441.0 01-.134.326.441.441.0 01-.325.134h-3.258a.441.441.0 01-.326-.134.443.443.0 01-.134-.326 1.974 1.974.0 00-.978-1.667 4.647 4.647.0 00-2.665-.671 4.741 4.741.0 00-2.435.556 1.724 1.724.0 00-.938 1.553 1.512 1.512.0 00.9 1.4 15.875 15.875.0 003.01 1.055l.843.229a27.368 27.368.0 013.412 1.246 6.67 6.67.0 012.338 1.763 4.387 4.387.0 01.958 2.933 4.988 4.988.0 01-2.146 4.275 9.543 9.543.0 01-5.712 1.552 11.626 11.626.0 01-4.227-.709z"/><path d="m97.039 32.837a.443.443.0 01-.326.135h-3.911a.169.169.0 00-.191.192v9.239a2.951 2.951.0 00.632 2.108 2.7 2.7.0 002.013.652h1.15a.444.444.0 01.325.134.441.441.0 01.134.326v2.875a.471.471.0 01-.459.5l-1.994.039a8 8 0 01-4.524-1.035q-1.495-1.035-1.533-3.91V33.166A.17.17.0 0088.164 32.974H85.978A.441.441.0 0185.652 32.839.441.441.0 0185.518 32.513V29.83a.441.441.0 01.134-.326.444.444.0 01.326-.135h2.186a.169.169.0 00.191-.192v-4.485a.438.438.0 01.134-.326.44.44.0 01.325-.134h3.336a.443.443.0 01.325.134.442.442.0 01.135.326v4.485a.169.169.0 00.191.192h3.911a.446.446.0 01.326.135.446.446.0 01.134.326v2.683a.446.446.0 01-.133.324z"/><path d="m101.694 25.917a2.645 2.645.0 01-.767-1.955 2.65 2.65.0 01.767-1.955 2.65 2.65.0 011.955-.767 2.65 2.65.0 011.955.767 2.652 2.652.0 01.767 1.955 2.647 2.647.0 01-.767 1.955 2.646 2.646.0 01-1.955.767 2.645 2.645.0 01-1.955-.767zm-.211 22.906a.441.441.0 01-.134-.326V29.79a.444.444.0 01.134-.326.446.446.0 01.326-.134h3.527a.446.446.0 01.326.134.445.445.0 01.134.326v18.707a.443.443.0 01-.134.326.443.443.0 01-.326.134h-3.527a.443.443.0 01-.326-.134z"/><path d="m114.019 47.734a8.1 8.1.0 01-3.047-4.255 14.439 14.439.0 01-.652-4.37 14.3 14.3.0 01.614-4.371A7.869 7.869.0 01114 30.56a9.072 9.072.0 015.252-1.5 8.543 8.543.0 015.041 1.5 7.985 7.985.0 013.009 4.14 12.439 12.439.0 01.69 4.37 13.793 13.793.0 01-.651 4.37 8.255 8.255.0 01-3.028 4.275 8.475 8.475.0 01-5.1 1.553 8.754 8.754.0 01-5.194-1.534zm7.629-3.1a4.536 4.536.0 001.476-2.262 11.335 11.335.0 00.383-3.221 10.618 10.618.0 00-.383-3.22 4.169 4.169.0 00-1.457-2.243 4.066 4.066.0 00-2.531-.785 3.942 3.942.0 00-2.453.785 4.376 4.376.0 00-1.5 2.243 11.839 11.839.0 00-.383 3.22 11.84 11.84.0 00.383 3.221 4.222 4.222.0 001.476 2.262 4.075 4.075.0 002.549.8 3.8 3.8.0 002.44-.809z"/><path d="m15.105 32.057v15.565a.059.059.0 01-.049.059L.069 50.25A.06.06.0 01.005 50.167l14.987-33.47a.06.06.0 01.114.025z"/><path d="m17.631 23.087v24.6a.06.06.0 00.053.059l22.449 2.507a.06.06.0 00.061-.084L17.745.032a.06.06.0 00-.114.024z"/><path d="m39.961 52.548-24.833 7.45a.062.062.0 01-.043.0L.079 52.548a.059.059.0 01.026-.113h39.839a.06.06.0 01.017.113z"/></svg></span>
</a><button id=hamburger class=main-navigation-toggle aria-label="Open navigation">
<svg class="icon menu-hamburger"><use xlink:href="/v1.21/img/icons.svg#menu-hamburger"/></svg>
</button>
<button id=menu-close class=main-navigation-toggle aria-label="Close navigation"><svg class="icon menu-close"><use xlink:href="/v1.21/img/icons.svg#menu-close"/></svg></button></div><div id=header-links class=main-navigation-links-wrapper><ul class=main-navigation-links><li class=main-navigation-links-item><a class="main-navigation-links-link has-dropdown"><span>About</span><svg class="icon dropdown-arrow"><use xlink:href="/v1.21/img/icons.svg#dropdown-arrow"/></svg></a><ul class=main-navigation-links-dropdown><li class=main-navigation-links-dropdown-item><a href=/v1.21/about/service-mesh class=main-navigation-links-link>Service mesh</a></li><li class=main-navigation-links-dropdown-item><a href=/v1.21/about/solutions class=main-navigation-links-link>Solutions</a></li><li class=main-navigation-links-dropdown-item><a href=/v1.21/about/case-studies class=main-navigation-links-link>Case studies</a></li><li class=main-navigation-links-dropdown-item><a href=/v1.21/about/ecosystem class=main-navigation-links-link>Ecosystem</a></li><li class=main-navigation-links-dropdown-item><a href=/v1.21/about/deployment class=main-navigation-links-link>Deployment</a></li><li class=main-navigation-links-dropdown-item><a href=/v1.21/about/faq class=main-navigation-links-link>FAQ</a></li></ul></li><li class=main-navigation-links-item><a href=/v1.21/blog/ class=main-navigation-links-link><span>Blog</span></a></li><li class=main-navigation-links-item><a href=/v1.21/news/ class=main-navigation-links-link><span>News</span></a></li><li class=main-navigation-links-item><a href=/v1.21/get-involved/ class=main-navigation-links-link><span>Get involved</span></a></li><li class=main-navigation-links-item><a href=/v1.21/docs/ class=main-navigation-links-link><span>Documentation</span></a></li></ul><div class=main-navigation-footer><button id=search-show class=search-show title='Search this site' aria-label=Search><svg class="icon magnifier"><use xlink:href="/v1.21/img/icons.svg#magnifier"/></svg></button>
<a href=/v1.21/docs/setup/getting-started class="btn btn--primary" id=try-istio>Try Istio</a></div></div><form id=search-form class=search name=cse role=search><input type=hidden name=cx value=002184991200833970123:iwwf17ikgf4>
<input type=hidden name=ie value=utf-8>
<input type=hidden name=hl value=en>
<input type=hidden id=search-page-url value=/search>
<input id=search-textbox class="search-textbox form-control" name=q type=search aria-label='Search this site' placeholder=Search>
<button id=search-close title='Cancel search' type=reset aria-label='Cancel search'><svg class="icon menu-close"><use xlink:href="/v1.21/img/icons.svg#menu-close"/></svg></button></form></nav></header><div class=banner-container></div><main class="primary container has-sidebar has-toc docs"><div id=sidebar-container class=sidebar-container><nav id=sidebar aria-label="Section Navigation"><button id=sidebar-close class="main-navigation-toggle sidebar-close" aria-label="Close sidebar"><svg class="icon menu-close"><use xlink:href="/v1.21/img/icons.svg#menu-close"/></svg></button><div class=sidebar-nav><div class=search><form id=search-docs-form name=cse role=search><input type=hidden name=ie value=utf-8>
<input type=hidden name=hl value=en>
<input type=hidden id=search-docs-url value=/v1.21//search>
<input id=search-docs-textbox class=form-control name=docs-search type=search aria-label='Search this site' placeholder=Search>
<button id=search-show2 class=search-show title='Search this site' aria-label=Search><svg class="icon magnifier"><use xlink:href="/v1.21/img/icons.svg#magnifier"/></svg></button></form></div><div class=card><div class="body default" aria-labelledby=header0><ul role=tree aria-expanded=true aria-labelledby=header0><li role=treeitem aria-label=Concepts><a class=main title="Learn about the different parts of the Istio system and the abstractions it uses." href=/v1.21/docs/concepts/>Concepts</a><ul role=group aria-expanded=true class=leaf-section><li role=none><a role=treeitem title="Describes the various Istio features focused on traffic routing and control." href=/v1.21/docs/concepts/traffic-management/>Traffic Management</a></li><li role=none><a role=treeitem title="Describes Istio's authorization and authentication functionality." href=/v1.21/docs/concepts/security/>Security</a></li><li role=none><a role=treeitem title="Describes the telemetry and monitoring features provided by Istio." href=/v1.21/docs/concepts/observability/>Observability</a></li><li role=none><a role=treeitem title="Describes Istio's WebAssembly Plugin system." href=/v1.21/docs/concepts/wasm/>Extensibility</a></li></ul></li><li role=treeitem aria-label=Setup><a class=main title="Instructions for installing the Istio control plane on Kubernetes." href=/v1.21/docs/setup/>Setup</a><ul role=group aria-expanded=true><li role=none><a role=treeitem title="Try Istio’s features quickly and easily." href=/v1.21/docs/setup/getting-started/>Getting Started</a></li><li role=treeitem aria-label="Platform Setup"><button aria-hidden=true tabindex=-1></button><a title="How to prepare various Kubernetes platforms before installing Istio." href=/v1.21/docs/setup/platform-setup/>Platform Setup</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Prerequisites for platform setup for Istio." href=/v1.21/docs/setup/platform-setup/prerequisites/>Platform Prerequisites</a></li><li role=none><a role=treeitem title="Instructions to set up an Alibaba Cloud Kubernetes cluster for Istio." href=/v1.21/docs/setup/platform-setup/alicloud/>Alibaba Cloud</a></li><li role=none><a role=treeitem title="Instructions to set up Istio on Amazon EKS in AWS cloud." href=/v1.21/docs/setup/platform-setup/amazon-eks/>Amazon EKS</a></li><li role=none><a role=treeitem title="Instructions to set up an Azure cluster for Istio." href=/v1.21/docs/setup/platform-setup/azure/>Azure</a></li><li role=none><a role=treeitem title="Instructions to set up Docker Desktop for Istio." href=/v1.21/docs/setup/platform-setup/docker/>Docker Desktop</a></li><li role=none><a role=treeitem title="Instructions to set up a Google Kubernetes Engine cluster for Istio." href=/v1.21/docs/setup/platform-setup/gke/>Google Kubernetes Engine</a></li><li role=none><a role=treeitem title="Instructions to set up an Huawei Cloud kubernetes cluster for Istio." href=/v1.21/docs/setup/platform-setup/huaweicloud/>Huawei Cloud</a></li><li role=none><a role=treeitem title="Instructions to set up an IBM Cloud cluster for Istio." href=/v1.21/docs/setup/platform-setup/ibm/>IBM Cloud</a></li><li role=none><a role=treeitem title="Instructions to set up k3d for Istio." href=/v1.21/docs/setup/platform-setup/k3d/>k3d</a></li><li role=none><a role=treeitem title="Instructions to set up kind for Istio." href=/v1.21/docs/setup/platform-setup/kind/>kind</a></li><li role=none><a role=treeitem title="Instructions to set up Kops for use with Istio." href=/v1.21/docs/setup/platform-setup/kops/>Kops</a></li><li role=none><a role=treeitem title="Instructions to set up a Gardener cluster for Istio." href=/v1.21/docs/setup/platform-setup/gardener/>Kubernetes Gardener</a></li><li role=none><a role=treeitem title="Instructions to set up a KubeSphere Container Platform for Istio." href=/v1.21/docs/setup/platform-setup/kubesphere/>KubeSphere Container Platform</a></li><li role=none><a role=treeitem title="Instructions to set up MicroK8s for use with Istio." href=/v1.21/docs/setup/platform-setup/microk8s/>MicroK8s</a></li><li role=none><a role=treeitem title="Instructions to set up minikube for Istio." href=/v1.21/docs/setup/platform-setup/minikube/>Minikube</a></li><li role=none><a role=treeitem title="Instructions to set up an OpenShift cluster for Istio." href=/v1.21/docs/setup/platform-setup/openshift/>OpenShift</a></li><li role=none><a role=treeitem title="Instructions to prepare a cluster for Istio using Oracle Container Engine for Kubernetes (OKE)." href=/v1.21/docs/setup/platform-setup/oci/>Oracle Cloud Infrastructure</a></li><li role=none><a role=treeitem title="Instructions to set up Istio quickly in Tencent Cloud." href=/v1.21/docs/setup/platform-setup/tencent-cloud-mesh/>Tencent Cloud</a></li></ul></li><li role=treeitem aria-label=Install><button aria-hidden=true tabindex=-1></button><a title="Choose the guide that best suits your needs and platform." href=/v1.21/docs/setup/install/>Install</a><ul role=group aria-expanded=false><li role=none><a role=treeitem title="Install and customize any Istio configuration profile for in-depth evaluation or production use." href=/v1.21/docs/setup/install/istioctl/>Install with Istioctl</a></li><li role=none><a role=treeitem title="Instructions to install and configure Istio in a Kubernetes cluster using Helm." href=/v1.21/docs/setup/install/helm/>Install with Helm</a></li><li role=treeitem aria-label="Install Multicluster"><button aria-hidden=true tabindex=-1></button><a title="Install an Istio mesh across multiple Kubernetes clusters." href=/v1.21/docs/setup/install/multicluster/>Install Multicluster</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Initial steps before installing Istio on multiple clusters." href=/v1.21/docs/setup/install/multicluster/before-you-begin/>Before you begin</a></li><li role=none><a role=treeitem title="Install an Istio mesh across multiple primary clusters." href=/v1.21/docs/setup/install/multicluster/multi-primary/>Install Multi-Primary</a></li><li role=none><a role=treeitem title="Install an Istio mesh across primary and remote clusters." href=/v1.21/docs/setup/install/multicluster/primary-remote/>Install Primary-Remote</a></li><li role=none><a role=treeitem title="Install an Istio mesh across multiple primary clusters on different networks." href=/v1.21/docs/setup/install/multicluster/multi-primary_multi-network/>Install Multi-Primary on different networks</a></li><li role=none><a role=treeitem title="Install an Istio mesh across primary and remote clusters on different networks." href=/v1.21/docs/setup/install/multicluster/primary-remote_multi-network/>Install Primary-Remote on different networks</a></li><li role=none><a role=treeitem title="Verify that Istio has been installed properly on multiple clusters." href=/v1.21/docs/setup/install/multicluster/verify/>Verify the installation</a></li></ul></li><li role=none><a role=treeitem title="Install Istio with an external control plane and a remote cluster data plane." href=/v1.21/docs/setup/install/external-controlplane/>Install Istio with an External Control Plane</a></li><li role=none><a role=treeitem title="Install multiple Istio control planes in a single cluster using revisions and discoverySelectors." href=/v1.21/docs/setup/install/multiple-controlplanes/>Install Multiple Istio Control Planes in a Single Cluster</a></li><li role=none><a role=treeitem title="Deploy Istio and connect a workload running within a virtual machine to it." href=/v1.21/docs/setup/install/virtual-machine/>Virtual Machine Installation</a></li><li role=none><a role=treeitem title="Instructions to install Istio in a Kubernetes cluster using the Istio operator." href=/v1.21/docs/setup/install/operator/>Istio Operator Install</a></li></ul></li><li role=treeitem aria-label=Upgrade><button aria-hidden=true tabindex=-1></button><a title="Upgrade, downgrade, and manage Istio across multiple control plane revisions." href=/v1.21/docs/setup/upgrade/>Upgrade</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Upgrade Istio by first running a canary deployment of a new control plane." href=/v1.21/docs/setup/upgrade/canary/>Canary Upgrades</a></li><li role=none><a role=treeitem title="Upgrade or downgrade Istio in place." href=/v1.21/docs/setup/upgrade/in-place/>In-place Upgrades</a></li><li role=none><a role=treeitem title="Instructions to upgrade Istio using Helm." href=/v1.21/docs/setup/upgrade/helm/>Upgrade with Helm</a></li></ul></li><li role=treeitem aria-label="More Guides"><button aria-hidden=true tabindex=-1></button><a title="More information on additional setup tasks." href=/v1.21/docs/setup/additional-setup/>More Guides</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Try Istio’s features quickly and easily." href=/v1.21/docs/setup/additional-setup/getting-started/>Getting Started with Istio and Kubernetes Gateway API</a></li><li role=none><a role=treeitem title="Describes the built-in Istio installation configuration profiles." href=/v1.21/docs/setup/additional-setup/config-profiles/>Installation Configuration Profiles</a></li><li role=none><a role=treeitem title='How to configure "compatibility versions", to decouple behavioral changes from releases.' href=/v1.21/docs/setup/additional-setup/compatibility-versions/>Compatibility Versions</a></li><li role=none><a role=treeitem title="Install and customize Istio Gateways." href=/v1.21/docs/setup/additional-setup/gateway/>Installing Gateways</a></li><li role=none><a role=treeitem title="Install the Istio sidecar in application pods automatically using the sidecar injector webhook or manually using istioctl CLI." href=/v1.21/docs/setup/additional-setup/sidecar-injection/>Installing the Sidecar</a></li><li role=none><a role=treeitem title="Describes how to customize installation configuration options." href=/v1.21/docs/setup/additional-setup/customize-installation/>Customizing the installation configuration</a></li><li role=none><a role=treeitem title="Describes how to customize installation configuration options when installing with helm." href=/v1.21/docs/setup/additional-setup/customize-installation-helm/>Advanced Helm Chart Customization</a></li><li role=none><a role=treeitem title="Install and use Istio in Dual-Stack mode running on a Dual-Stack Kubernetes cluster." href=/v1.21/docs/setup/additional-setup/dual-stack/>Install Istio in Dual-Stack mode</a></li><li role=none><a role=treeitem title="Install and use Istio with the Pod Security admission controller." href=/v1.21/docs/setup/additional-setup/pod-security-admission/>Install Istio with Pod Security Admission</a></li><li role=none><a role=treeitem title="Install and use Istio with the Istio CNI plugin, allowing operators to deploy services with lower privilege." href=/v1.21/docs/setup/additional-setup/cni/>Install Istio with the Istio CNI plugin</a></li></ul></li></ul></li><li role=treeitem aria-label=Tasks><a class=main title="How to do single specific targeted activities with the Istio system." href=/v1.21/docs/tasks/>Tasks</a><ul role=group aria-expanded=true><li role=treeitem aria-label="Traffic Management"><button aria-hidden=true tabindex=-1></button><a title="Tasks that demonstrate Istio's traffic routing features." href=/v1.21/docs/tasks/traffic-management/>Traffic Management</a><ul role=group aria-expanded=false><li role=none><a role=treeitem title="This task shows you how to configure dynamic request routing to multiple versions of a microservice." href=/v1.21/docs/tasks/traffic-management/request-routing/>Request Routing</a></li><li role=none><a role=treeitem title="This task shows you how to inject faults to test the resiliency of your application." href=/v1.21/docs/tasks/traffic-management/fault-injection/>Fault Injection</a></li><li role=none><a role=treeitem title="Shows you how to migrate traffic from an old to new version of a service." href=/v1.21/docs/tasks/traffic-management/traffic-shifting/>Traffic Shifting</a></li><li role=none><a role=treeitem title="Shows you how to migrate TCP traffic from an old to new version of a TCP service." href=/v1.21/docs/tasks/traffic-management/tcp-traffic-shifting/>TCP Traffic Shifting</a></li><li role=none><a role=treeitem title="This task shows you how to set up request timeouts in Envoy using Istio." href=/v1.21/docs/tasks/traffic-management/request-timeouts/>Request Timeouts</a></li><li role=none><a role=treeitem title="This task shows you how to configure circuit breaking for connections, requests, and outlier detection." href=/v1.21/docs/tasks/traffic-management/circuit-breaking/>Circuit Breaking</a></li><li role=none><a role=treeitem title="This task demonstrates the traffic mirroring/shadowing capabilities of Istio." href=/v1.21/docs/tasks/traffic-management/mirroring/>Mirroring</a></li><li role=treeitem aria-label="Locality Load Balancing"><button aria-hidden=true tabindex=-1></button><a title="This series of tasks demonstrate how to configure locality load balancing in Istio." href=/v1.21/docs/tasks/traffic-management/locality-load-balancing/>Locality Load Balancing</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Initial steps before configuring locality load balancing." href=/v1.21/docs/tasks/traffic-management/locality-load-balancing/before-you-begin/>Before you begin</a></li><li role=none><a role=treeitem title="This task demonstrates how to configure your mesh for locality failover." href=/v1.21/docs/tasks/traffic-management/locality-load-balancing/failover/>Locality failover</a></li><li role=none><a role=treeitem title="This guide demonstrates how to configure locality distribution." href=/v1.21/docs/tasks/traffic-management/locality-load-balancing/distribute/>Locality weighted distribution</a></li><li role=none><a role=treeitem title="Cleanup steps for locality load balancing." href=/v1.21/docs/tasks/traffic-management/locality-load-balancing/cleanup/>Cleanup</a></li></ul></li><li role=treeitem aria-label=Ingress><button aria-hidden=true tabindex=-1></button><a title="Controlling ingress traffic for an Istio service mesh." href=/v1.21/docs/tasks/traffic-management/ingress/>Ingress</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Describes how to configure an Istio gateway to expose a service outside of the service mesh." href=/v1.21/docs/tasks/traffic-management/ingress/ingress-control/>Ingress Gateways</a></li><li role=none><a role=treeitem title="Expose a service outside of the service mesh over TLS or mTLS." href=/v1.21/docs/tasks/traffic-management/ingress/secure-ingress/>Secure Gateways</a></li><li role=none><a role=treeitem title="Describes how to configure SNI passthrough for an ingress gateway." href=/v1.21/docs/tasks/traffic-management/ingress/ingress-sni-passthrough/>Ingress Gateway without TLS Termination</a></li><li role=none><a role=treeitem title="Describes how to terminate TLS traffic at a sidecar without using an Ingress Gateway." href=/v1.21/docs/tasks/traffic-management/ingress/ingress-sidecar-tls-termination/>Ingress Sidecar TLS Termination</a></li><li role=none><a role=treeitem title="Describes how to configure a Kubernetes Ingress object to expose a service outside of the service mesh." href=/v1.21/docs/tasks/traffic-management/ingress/kubernetes-ingress/>Kubernetes Ingress</a></li><li role=none><a role=treeitem title="Describes how to configure the Kubernetes Gateway API with Istio." href=/v1.21/docs/tasks/traffic-management/ingress/gateway-api/>Kubernetes Gateway API</a></li></ul></li><li role=treeitem aria-label=Egress><button aria-hidden=true tabindex=-1></button><a title="Controlling egress traffic for an Istio service mesh." href=/v1.21/docs/tasks/traffic-management/egress/>Egress</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Describes how to configure Istio to route traffic from services in the mesh to external services." href=/v1.21/docs/tasks/traffic-management/egress/egress-control/>Accessing External Services</a></li><li role=none><a role=treeitem title="Describes how to configure Istio to perform TLS origination for traffic to external services." href=/v1.21/docs/tasks/traffic-management/egress/egress-tls-origination/>Egress TLS Origination</a></li><li role=none><a role=treeitem title="Describes how to configure Istio to direct traffic to external services through a dedicated gateway." href=/v1.21/docs/tasks/traffic-management/egress/egress-gateway/>Egress Gateways</a></li><li role=none><a role=treeitem title="Describes how to configure an Egress Gateway to perform TLS origination to external services." href=/v1.21/docs/tasks/traffic-management/egress/egress-gateway-tls-origination/>Egress Gateways with TLS Origination</a></li><li role=none><a role=treeitem title="Describes how to enable egress traffic for a set of hosts in a common domain, instead of configuring each and every host separately." href=/v1.21/docs/tasks/traffic-management/egress/wildcard-egress-hosts/>Egress using Wildcard Hosts</a></li><li role=none><a role=treeitem title="Shows how to configure Istio for Kubernetes External Services." href=/v1.21/docs/tasks/traffic-management/egress/egress-kubernetes-services/>Kubernetes Services for Egress Traffic</a></li><li role=none><a role=treeitem title="Describes how to configure Istio to let applications use an external HTTPS proxy." href=/v1.21/docs/tasks/traffic-management/egress/http-proxy/>Using an External HTTPS Proxy</a></li></ul></li></ul></li><li role=treeitem aria-label=Security><button aria-hidden=true tabindex=-1></button><a title="Demonstrates how to secure the mesh." href=/v1.21/docs/tasks/security/>Security</a><ul role=group aria-expanded=false><li role=treeitem aria-label="Certificate Management"><button aria-hidden=true tabindex=-1></button><a title="Management of the certificates in Istio." href=/v1.21/docs/tasks/security/cert-management/>Certificate Management</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Shows how system administrators can configure Istio's CA with a root certificate, signing certificate and key." href=/v1.21/docs/tasks/security/cert-management/plugin-ca-cert/>Plug in CA Certificates</a></li><li role=none><a role=treeitem title="Shows how to use a Custom Certificate Authority (that integrates with the Kubernetes CSR API) to provision Istio workload certificates (Experimental)" href=/v1.21/docs/tasks/security/cert-management/custom-ca-k8s/>Custom CA Integration using Kubernetes CSR *</a></li></ul></li><li role=treeitem aria-label=Authentication><button aria-hidden=true tabindex=-1></button><a title="Controlling mutual TLS and end-user authentication for mesh services." href=/v1.21/docs/tasks/security/authentication/>Authentication</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Shows you how to use Istio authentication policy to set up mutual TLS and basic end-user authentication." href=/v1.21/docs/tasks/security/authentication/authn-policy/>Authentication Policy</a></li><li role=none><a role=treeitem title="Shows you how to use Istio authentication policy to route requests based on JWT claims (Alpha)" href=/v1.21/docs/tasks/security/authentication/jwt-route/>JWT claim based routing *</a></li><li role=none><a role=treeitem title="Shows how users can copy their JWT claims to HTTP headers (Experimental)" href=/v1.21/docs/tasks/security/authentication/claim-to-header/>Copy JWT Claims to HTTP Headers *</a></li><li role=none><a role=treeitem title="Shows you how to incrementally migrate your Istio services to mutual TLS." href=/v1.21/docs/tasks/security/authentication/mtls-migration/>Mutual TLS Migration</a></li></ul></li><li role=treeitem aria-label=Authorization><button aria-hidden=true tabindex=-1></button><a title="Shows how to control access to Istio services." href=/v1.21/docs/tasks/security/authorization/>Authorization</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Shows how to set up access control for HTTP traffic." href=/v1.21/docs/tasks/security/authorization/authz-http/>HTTP Traffic</a></li><li role=none><a role=treeitem title="Shows how to set up access control for TCP traffic." href=/v1.21/docs/tasks/security/authorization/authz-tcp/>TCP Traffic</a></li><li role=none><a role=treeitem title="Shows how to set up access control for JWT token." href=/v1.21/docs/tasks/security/authorization/authz-jwt/>JWT Token</a></li><li role=none><a role=treeitem title="Shows how to integrate and delegate access control to an external authorization system." href=/v1.21/docs/tasks/security/authorization/authz-custom/>External Authorization</a></li><li role=none><a role=treeitem title="Shows how to set up access control to deny traffic explicitly." href=/v1.21/docs/tasks/security/authorization/authz-deny/>Explicit Deny</a></li><li role=none><a role=treeitem title="Shows how to set up access control on an ingress gateway." href=/v1.21/docs/tasks/security/authorization/authz-ingress/>Ingress Access Control</a></li><li role=none><a role=treeitem title="Shows how to migrate from one trust domain to another without changing authorization policy." href=/v1.21/docs/tasks/security/authorization/authz-td-migration/>Trust Domain Migration</a></li><li role=none><a role=treeitem title="Shows how to dry-run an authorization policy without enforcing it (Alpha)" href=/v1.21/docs/tasks/security/authorization/authz-dry-run/>Dry Run *</a></li></ul></li><li role=treeitem aria-label="TLS Configuration"><button aria-hidden=true tabindex=-1></button><a title="TLS configuration in Istio." href=/v1.21/docs/tasks/security/tls-configuration/>TLS Configuration</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Shows how to configure the minimum TLS version for Istio workloads." href=/v1.21/docs/tasks/security/tls-configuration/workload-min-tls-version/>Istio Workload Minimum TLS Version Configuration</a></li></ul></li></ul></li><li role=treeitem aria-label="Policy Enforcement"><button aria-hidden=true tabindex=-1></button><a title="Demonstrates policy enforcement features." href=/v1.21/docs/tasks/policy-enforcement/>Policy Enforcement</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="This task shows you how to configure Istio to dynamically limit the traffic to a service." href=/v1.21/docs/tasks/policy-enforcement/rate-limit/>Enabling Rate Limits using Envoy</a></li></ul></li><li role=treeitem aria-label=Observability><button aria-hidden=true tabindex=-1></button><a title="Demonstrates how to collect telemetry information from the mesh." href=/v1.21/docs/tasks/observability/>Observability</a><ul role=group aria-expanded=false><li role=none><a role=treeitem title="This task shows you how to configure the Telemetry API (Alpha)" href=/v1.21/docs/tasks/observability/telemetry/>Telemetry API *</a></li><li role=treeitem aria-label=Metrics><button aria-hidden=true tabindex=-1></button><a title="Demonstrates the collection and querying of metrics within Istio." href=/v1.21/docs/tasks/observability/metrics/>Metrics</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="This task shows you how to customize the Istio metrics with Telemetry API." href=/v1.21/docs/tasks/observability/metrics/telemetry-api/>Customizing Istio Metrics with Telemetry API</a></li><li role=none><a role=treeitem title="This task shows you how to configure Istio to collect metrics for TCP services." href=/v1.21/docs/tasks/observability/metrics/tcp-metrics/>Collecting Metrics for TCP Services</a></li><li role=none><a role=treeitem title="This task shows you how to customize the Istio metrics." href=/v1.21/docs/tasks/observability/metrics/customize-metrics/>Customizing Istio Metrics</a></li><li role=none><a role=treeitem title="This task shows you how to improve telemetry by grouping requests and responses by their type." href=/v1.21/docs/tasks/observability/metrics/classify-metrics/>Classifying Metrics Based on Request or Response</a></li><li role=none><a role=treeitem title="This task shows you how to query for Istio Metrics using Prometheus." href=/v1.21/docs/tasks/observability/metrics/querying-metrics/>Querying Metrics from Prometheus</a></li><li role=none><a role=treeitem title="This task shows you how to set up and use the Istio Dashboard to monitor mesh traffic." href=/v1.21/docs/tasks/observability/metrics/using-istio-dashboard/>Visualizing Metrics with Grafana</a></li></ul></li><li role=treeitem aria-label=Logs><button aria-hidden=true tabindex=-1></button><a title="Demonstrates the collection of logs within Istio." href=/v1.21/docs/tasks/observability/logs/>Logs</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="This task shows you how to configure Envoy proxies to send access logs with Telemetry API." href=/v1.21/docs/tasks/observability/logs/telemetry-api/>Configure access logs with Telemetry API</a></li><li role=none><a role=treeitem title="This task shows you how to configure Envoy proxies to print access logs to their standard output." href=/v1.21/docs/tasks/observability/logs/access-log/>Envoy Access Logs</a></li><li role=none><a role=treeitem title="This task shows you how to configure Envoy proxies to send access logs with OpenTelemetry collector." href=/v1.21/docs/tasks/observability/logs/otel-provider/>OpenTelemetry</a></li></ul></li><li role=treeitem aria-label="Distributed Tracing"><button aria-hidden=true tabindex=-1></button><a title="This task shows you how to configure Istio-enabled applications to collect trace spans." href=/v1.21/docs/tasks/observability/distributed-tracing/>Distributed Tracing</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Overview of distributed tracing in Istio." href=/v1.21/docs/tasks/observability/distributed-tracing/overview/>Overview</a></li><li role=none><a role=treeitem title="How to configure tracing options using Telemetry API." href=/v1.21/docs/tasks/observability/distributed-tracing/telemetry-api/>Configure tracing with Telemetry API</a></li><li role=none><a role=treeitem title="Learn how to configure the proxies to send tracing requests to Apache SkyWalking." href=/v1.21/docs/tasks/observability/distributed-tracing/skywalking/>Apache SkyWalking</a></li><li role=none><a role=treeitem title="Learn how to configure the proxies to send tracing requests to Jaeger." href=/v1.21/docs/tasks/observability/distributed-tracing/jaeger/>Jaeger</a></li><li role=none><a role=treeitem title="Learn how to configure the proxies to send OpenCensus-formatted spans to OpenTelemetry Collector." href=/v1.21/docs/tasks/observability/distributed-tracing/opencensusagent/>OpenCensus Agent</a></li><li role=none><a role=treeitem title="Learn how to configure the proxies to send tracing requests to Zipkin." href=/v1.21/docs/tasks/observability/distributed-tracing/zipkin/>Zipkin</a></li><li role=none><a role=treeitem title="How to configure tracing options using MeshConfig and pod annotations." href=/v1.21/docs/tasks/observability/distributed-tracing/mesh-and-proxy-config/>Configure tracing using MeshConfig and Pod annotations</a></li><li role=none><a role=treeitem title="How to configure the proxies to send tracing requests to Lightstep." href=/v1.21/docs/tasks/observability/distributed-tracing/lightstep/>Lightstep</a></li></ul></li><li role=none><a role=treeitem title="This task shows you how to visualize your services within an Istio mesh." href=/v1.21/docs/tasks/observability/kiali/>Visualizing Your Mesh</a></li><li role=none><a role=treeitem title="This task shows you how to configure external access to the set of Istio telemetry addons." href=/v1.21/docs/tasks/observability/gateways/>Remotely Accessing Telemetry Addons</a></li></ul></li><li role=treeitem aria-label=Extensibility><button aria-hidden=true tabindex=-1></button><a title="Demonstrates how to extend mesh behavior." href=/v1.21/docs/tasks/extensibility/>Extensibility</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Describes how to make remote WebAssembly modules available in the mesh (Alpha)" href=/v1.21/docs/tasks/extensibility/wasm-module-distribution/>Distributing WebAssembly Modules *</a></li></ul></li></ul></li><li role=treeitem aria-label=Examples><a class=main title="A variety of fully working example uses for Istio that you can experiment with." href=/v1.21/docs/examples/>Examples</a><ul role=group aria-expanded=true><li role=none><a role=treeitem title="Deploys a sample application composed of four separate microservices used to demonstrate various Istio features." href=/v1.21/docs/examples/bookinfo/>Bookinfo Application</a></li><li role=none><a role=treeitem title="Run the Bookinfo application with a MySQL service running on a virtual machine within your mesh." href=/v1.21/docs/examples/virtual-machines/>Bookinfo with a Virtual Machine</a></li><li role=treeitem aria-label="Learn Microservices using Kubernetes and Istio"><button aria-hidden=true tabindex=-1></button><a title="This modular tutorial provides new users with hands-on experience using Istio for common microservices scenarios, one step at a time." href=/v1.21/docs/examples/microservices-istio/>Learn Microservices using Kubernetes and Istio</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title href=/v1.21/docs/examples/microservices-istio/prereq/>Prerequisites</a></li><li role=none><a role=treeitem title href=/v1.21/docs/examples/microservices-istio/setup-kubernetes-cluster/>Set up a Kubernetes Cluster</a></li><li role=none><a role=treeitem title href=/v1.21/docs/examples/microservices-istio/setup-local-computer/>Set up a Local Computer</a></li><li role=none><a role=treeitem title href=/v1.21/docs/examples/microservices-istio/single/>Run a Microservice Locally</a></li><li role=none><a role=treeitem title href=/v1.21/docs/examples/microservices-istio/package-service/>Run ratings in Docker</a></li><li role=none><a role=treeitem title href=/v1.21/docs/examples/microservices-istio/bookinfo-kubernetes/>Run Bookinfo with Kubernetes</a></li><li role=none><a role=treeitem title href=/v1.21/docs/examples/microservices-istio/production-testing/>Test in production</a></li><li role=none><a role=treeitem title href=/v1.21/docs/examples/microservices-istio/add-new-microservice-version/>Add a new version of reviews</a></li><li role=none><a role=treeitem title href=/v1.21/docs/examples/microservices-istio/add-istio/>Enable Istio on productpage</a></li><li role=none><a role=treeitem title href=/v1.21/docs/examples/microservices-istio/enable-istio-all-microservices/>Enable Istio on all the microservices</a></li><li role=none><a role=treeitem title href=/v1.21/docs/examples/microservices-istio/istio-ingress-gateway/>Configure Istio Ingress Gateway</a></li><li role=none><a role=treeitem title href=/v1.21/docs/examples/microservices-istio/logs-istio/>Monitoring with Istio</a></li></ul></li></ul></li><li role=treeitem aria-label=Operations><a class=main title="Concepts, tools, and techniques to deploy and manage an Istio mesh." href=/v1.21/docs/ops/>Operations</a><ul role=group aria-expanded=true><li role=treeitem aria-label=Deployment><button aria-hidden=true tabindex=-1></button><a title="Requirements, concepts, and considerations for setting up an Istio deployment." href=/v1.21/docs/ops/deployment/>Deployment</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Describes Istio's high-level architecture and design goals." href=/v1.21/docs/ops/deployment/architecture/>Architecture</a></li><li role=none><a role=treeitem title="Describes the options and considerations when configuring your Istio deployment." href=/v1.21/docs/ops/deployment/deployment-models/>Deployment Models</a></li><li role=none><a role=treeitem title="Describes Istio's high-level architecture for virtual machines." href=/v1.21/docs/ops/deployment/vm-architecture/>Virtual Machine Architecture</a></li><li role=none><a role=treeitem title="Istio performance and scalability summary." href=/v1.21/docs/ops/deployment/performance-and-scalability/>Performance and Scalability</a></li><li role=none><a role=treeitem title="Requirements of applications deployed in an Istio-enabled cluster." href=/v1.21/docs/ops/deployment/requirements/>Application Requirements</a></li></ul></li><li role=treeitem aria-label=Configuration><button aria-hidden=true tabindex=-1></button><a title="Advanced concepts and features for configuring a running Istio mesh." href=/v1.21/docs/ops/configuration/>Configuration</a><ul role=group aria-expanded=false><li role=treeitem aria-label="Mesh Configuration"><button aria-hidden=true tabindex=-1></button><a title="Helps you manage the global mesh configuration." href=/v1.21/docs/ops/configuration/mesh/>Mesh Configuration</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Provides a general overview of Istio's use of Kubernetes webhooks and the related issues that can arise." href=/v1.21/docs/ops/configuration/mesh/webhook/>Dynamic Admission Webhooks Overview</a></li><li role=none><a role=treeitem title="Describes how to wait until a resource reaches a given status of readiness." href=/v1.21/docs/ops/configuration/mesh/config-resource-ready/>Wait on Resource Status for Applied Configuration</a></li><li role=none><a role=treeitem title="Shows how to do health checking for Istio services." href=/v1.21/docs/ops/configuration/mesh/app-health-check/>Health Checking of Istio Services</a></li></ul></li><li role=treeitem aria-label="Traffic Management"><button aria-hidden=true tabindex=-1></button><a title="Helps you manage the networking aspects of a running mesh." href=/v1.21/docs/ops/configuration/traffic-management/>Traffic Management</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Information on how to specify protocols." href=/v1.21/docs/ops/configuration/traffic-management/protocol-selection/>Protocol Selection</a></li><li role=none><a role=treeitem title="How to configure certificates within your mesh." href=/v1.21/docs/ops/configuration/traffic-management/manage-mesh-certificates/>Managing In-Mesh Certificates</a></li><li role=none><a role=treeitem title="How to configure TLS settings to secure network traffic." href=/v1.21/docs/ops/configuration/traffic-management/tls-configuration/>TLS Configuration</a></li><li role=none><a role=treeitem title="How Istio routes traffic through the mesh." href=/v1.21/docs/ops/configuration/traffic-management/traffic-routing/>Traffic Routing</a></li><li role=none><a role=treeitem title="How DNS interacts with Istio." href=/v1.21/docs/ops/configuration/traffic-management/dns/>DNS</a></li><li role=none><a role=treeitem title="How to configure gateway network topology (Alpha)" href=/v1.21/docs/ops/configuration/traffic-management/network-topologies/>Configuring Gateway Network Topology *</a></li><li role=none><a role=treeitem title="How to configure DNS proxying." href=/v1.21/docs/ops/configuration/traffic-management/dns-proxy/>DNS Proxying</a></li><li role=none><a role=treeitem title="How to configure how traffic is distributed among clusters in the mesh." href=/v1.21/docs/ops/configuration/traffic-management/multicluster/>Multi-cluster Traffic Management</a></li></ul></li><li role=treeitem aria-label=Security><button aria-hidden=true tabindex=-1></button><a title="Helps you manage the security aspects of a running mesh." href=/v1.21/docs/ops/configuration/security/>Security</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Shows common examples of using Istio security policy." href=/v1.21/docs/ops/configuration/security/security-policy-examples/>Security policy examples</a></li><li role=none><a role=treeitem title="Use hardened container images to reduce Istio's attack surface." href=/v1.21/docs/ops/configuration/security/harden-docker-images/>Harden Docker Container Images</a></li></ul></li><li role=treeitem aria-label=Observability><button aria-hidden=true tabindex=-1></button><a title="Helps you manage telemetry collection and visualization in a running mesh." href=/v1.21/docs/ops/configuration/telemetry/>Observability</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Fine-grained control of Envoy statistics." href=/v1.21/docs/ops/configuration/telemetry/envoy-stats/>Envoy Statistics</a></li><li role=none><a role=treeitem title="Configure Prometheus to monitor multicluster Istio." href=/v1.21/docs/ops/configuration/telemetry/monitoring-multicluster-prometheus/>Monitoring Multicluster Istio with Prometheus</a></li></ul></li><li role=treeitem aria-label=Extensibility><button aria-hidden=true tabindex=-1></button><a title="Helps you manage extensions to the service mesh." href=/v1.21/docs/ops/configuration/extensibility/>Extensibility</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Describes how Istio determines whether to pull Wasm modules or use cached versions (Alpha)" href=/v1.21/docs/ops/configuration/extensibility/wasm-pull-policy/>Pull Policy for WebAssembly Modules *</a></li></ul></li></ul></li><li role=treeitem aria-label="Best Practices"><button aria-hidden=true tabindex=-1></button><a title="Best practices for setting up and managing an Istio service mesh." href=/v1.21/docs/ops/best-practices/>Best Practices</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="General best practices when setting up an Istio service mesh." href=/v1.21/docs/ops/best-practices/deployment/>Deployment Best Practices</a></li><li role=none><a role=treeitem title="Configuration best practices to avoid networking or traffic management issues." href=/v1.21/docs/ops/best-practices/traffic-management/>Traffic Management Best Practices</a></li><li role=none><a role=treeitem title="Best practices for securing applications using Istio." href=/v1.21/docs/ops/best-practices/security/>Security Best Practices</a></li><li role=none><a role=treeitem title="Describes how to use image signatures to verify the provenance of Istio images." href=/v1.21/docs/ops/best-practices/image-signing-validation/>Image Signing and Validation</a></li><li role=none><a role=treeitem title="Best practices for observing applications using Istio." href=/v1.21/docs/ops/best-practices/observability/>Observability Best Practices</a></li></ul></li><li role=treeitem aria-label="Common Problems"><button aria-hidden=true tabindex=-1></button><a title="Describes how to identify and resolve common problems in Istio." href=/v1.21/docs/ops/common-problems/>Common Problems</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Techniques to address common Istio traffic management and network problems." href=/v1.21/docs/ops/common-problems/network-issues/>Traffic Management Problems</a></li><li role=none><a role=treeitem title="Techniques to address common Istio authentication, authorization, and general security-related problems." href=/v1.21/docs/ops/common-problems/security-issues/>Security Problems</a></li><li role=none><a role=treeitem title="Dealing with telemetry collection issues." href=/v1.21/docs/ops/common-problems/observability-issues/>Observability Problems</a></li><li role=none><a role=treeitem title="Resolve common problems with Istio's use of Kubernetes webhooks for automatic sidecar injection." href=/v1.21/docs/ops/common-problems/injection/>Sidecar Injection Problems</a></li><li role=none><a role=treeitem title="Describes how to resolve configuration validation problems." href=/v1.21/docs/ops/common-problems/validation/>Configuration Validation Problems</a></li><li role=none><a role=treeitem title="Resolve common problems with Istio upgrades." href=/v1.21/docs/ops/common-problems/upgrade-issues/>Upgrade Problems</a></li></ul></li><li role=treeitem aria-label="Diagnostic Tools"><button aria-hidden=true tabindex=-1></button><a title="Tools and techniques to help troubleshoot an Istio mesh." href=/v1.21/docs/ops/diagnostic-tools/>Diagnostic Tools</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Istio includes a supplemental tool that provides debugging and diagnosis for Istio service mesh deployments." href=/v1.21/docs/ops/diagnostic-tools/istioctl/>Using the Istioctl Command-line Tool</a></li><li role=none><a role=treeitem title="Describes tools and techniques to diagnose Envoy configuration issues related to traffic management." href=/v1.21/docs/ops/diagnostic-tools/proxy-cmd/>Debugging Envoy and Istiod</a></li><li role=none><a role=treeitem title="Shows you how to use istioctl describe to verify the configurations of a pod in your mesh." href=/v1.21/docs/ops/diagnostic-tools/istioctl-describe/>Understand your Mesh with Istioctl Describe</a></li><li role=none><a role=treeitem title="Shows you how to use istioctl analyze to identify potential issues with your configuration." href=/v1.21/docs/ops/diagnostic-tools/istioctl-analyze/>Diagnose your Configuration with Istioctl Analyze</a></li><li role=none><a role=treeitem title="Learn how to use istioctl check-inject to confirm if Istio sidecar injection is properly enabled for your deployments." href=/v1.21/docs/ops/diagnostic-tools/check-inject/>Verifying Istio Sidecar Injection with Istioctl Check-Inject</a></li><li role=none><a role=treeitem title="Describes how to use ControlZ to get insight into a running istiod component." href=/v1.21/docs/ops/diagnostic-tools/controlz/>Istiod Introspection</a></li><li role=none><a role=treeitem title="Describes how to use component-level logging to get insights into a running component's behavior." href=/v1.21/docs/ops/diagnostic-tools/component-logging/>Component Logging</a></li><li role=none><a role=treeitem title="Describes tools and techniques to diagnose issues with Virtual Machines." href=/v1.21/docs/ops/diagnostic-tools/virtual-machines/>Debugging Virtual Machines</a></li><li role=none><a role=treeitem title="Describes tools and techniques to diagnose issues with multicluster and multi-network installations." href=/v1.21/docs/ops/diagnostic-tools/multicluster/>Troubleshooting Multicluster</a></li><li role=none><a role=treeitem title="Describes tools and techniques to diagnose issues using Istio with the CNI plugin." href=/v1.21/docs/ops/diagnostic-tools/cni/>Troubleshooting the Istio CNI plugin</a></li></ul></li><li role=treeitem aria-label="Ambient Mode"><button class=show aria-hidden=true tabindex=-1></button><a title="Information for setting up and operating Istio in ambient mode." href=/v1.21/docs/ops/ambient/>Ambient Mode</a><ul role=group aria-expanded=true><li role=none><a role=treeitem title="How to deploy and install Istio in ambient mode." href=/v1.21/docs/ops/ambient/getting-started/>Getting Started with Ambient Mode</a></li><li role=treeitem aria-label="Installation Guide"><button aria-hidden=true tabindex=-1></button><a title="Installation guide for Istio Ambient mesh." href=/v1.21/docs/ops/ambient/install/>Installation Guide</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Install Istio in Ambient mode with Helm." href=/v1.21/docs/ops/ambient/install/helm-installation/>Install with Helm</a></li><li role=none><a role=treeitem title="Platform-specific prerequisites for installing Istio in ambient mode." href=/v1.21/docs/ops/ambient/install/platform-prerequisites/>Platform-Specific Prerequisites</a></li></ul></li><li role=treeitem aria-label="Upgrade Guide"><button aria-hidden=true tabindex=-1></button><a title="Upgrade guide for Istio Ambient mesh." href=/v1.21/docs/ops/ambient/upgrade/>Upgrade Guide</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Upgrading an ambient mode installation with Helm (Experimental)" href=/v1.21/docs/ops/ambient/upgrade/helm-upgrade/>Upgrade with Helm *</a></li></ul></li><li role=treeitem aria-label="Ambient Mode User Guides"><button class=show aria-hidden=true tabindex=-1></button><a title="How to configure a mesh in ambient mode." href=/v1.21/docs/ops/ambient/usage/>Ambient Mode User Guides</a><ul role=group aria-expanded=true class=leaf-section><li role=none><a role=treeitem title='Understand and manage Istio&#39;s "zero-trust tunnel" proxy.' href=/v1.21/docs/ops/ambient/usage/ztunnel/>Layer 4 Networking & mTLS with Ztunnel</a></li><li role=none><a role=treeitem title="Gain the full set of Istio feature with optional waypoint proxies." href=/v1.21/docs/ops/ambient/usage/waypoint/>Layer 7 Networking & Services with Waypoint Proxies</a></li><li role=none><a role=treeitem title="Understand how traffic is redirected between pods and the ztunnel node proxy." href=/v1.21/docs/ops/ambient/usage/traffic-redirection/>Ztunnel traffic redirection</a></li></ul></li><li role=none><a role=treeitem title="A deep dive into the architecture of ambient mode." href=/v1.21/docs/ops/ambient/architecture/>Ambient Mode Architecture</a></li></ul></li><li role=treeitem aria-label=Integrations><button aria-hidden=true tabindex=-1></button><a title="Other software that Istio can integrate with to provide additional functionality." href=/v1.21/docs/ops/integrations/>Integrations</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Information on how to integrate with cert-manager." href=/v1.21/docs/ops/integrations/certmanager/>cert-manager</a></li><li role=none><a role=treeitem title="Information on how to integrate with Grafana to set up Istio dashboards." href=/v1.21/docs/ops/integrations/grafana/>Grafana</a></li><li role=none><a role=treeitem title="How to integrate with Jaeger." href=/v1.21/docs/ops/integrations/jaeger/>Jaeger</a></li><li role=none><a role=treeitem title="Information on how to integrate with Kiali." href=/v1.21/docs/ops/integrations/kiali/>Kiali</a></li><li role=none><a role=treeitem title="How to integrate with Prometheus." href=/v1.21/docs/ops/integrations/prometheus/>Prometheus</a></li><li role=none><a role=treeitem title="How to configure Istio to integrate with SPIRE to get cryptographic identities through Envoy's SDS API." href=/v1.21/docs/ops/integrations/spire/>SPIRE</a></li><li role=none><a role=treeitem title="How to integrate with Apache SkyWalking." href=/v1.21/docs/ops/integrations/skywalking/>Apache SkyWalking</a></li><li role=none><a role=treeitem title="How to integrate with Zipkin." href=/v1.21/docs/ops/integrations/zipkin/>Zipkin</a></li><li role=none><a role=treeitem title="How to integrate Istio with third party load balancers." href=/v1.21/docs/ops/integrations/loadbalancers/>Third Party Load Balancers</a></li></ul></li></ul></li><li role=treeitem aria-label=Releases><a class=main title="Information relating to Istio releases." href=/v1.21/docs/releases/>Releases</a><ul role=group aria-expanded=true><li role=none><a role=treeitem title="List of features and their release stages." href=/v1.21/docs/releases/feature-stages/>Feature Status</a></li><li role=none><a role=treeitem title="What to do if you find a bug." href=/v1.21/docs/releases/bugs/>Reporting Bugs</a></li><li role=none><a role=treeitem title="How we handle security vulnerabilities." href=/v1.21/docs/releases/security-vulnerabilities/>Security Vulnerabilities</a></li><li role=none><a role=treeitem title="The currently supported Istio releases." href=/v1.21/docs/releases/supported-releases/>Supported Releases</a></li><li role=treeitem aria-label="Contribute Documentation"><button aria-hidden=true tabindex=-1></button><a title="Details how to create and maintain Istio documentation pages." href=/v1.21/docs/releases/contribute/>Contribute Documentation</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Shows you how to use GitHub to contribute to the Istio documentation." href=/v1.21/docs/releases/contribute/github/>Work with GitHub</a></li><li role=none><a role=treeitem title="Details how to contribute new documentation to Istio." href=/v1.21/docs/releases/contribute/add-content/>Add New Documentation</a></li><li role=none><a role=treeitem title="Details how to contribute retired documentation to Istio." href=/v1.21/docs/releases/contribute/remove-content/>Remove Retired Documentation</a></li><li role=none><a role=treeitem title="Explains how to locally build, test, serve, and preview the website." href=/v1.21/docs/releases/contribute/build/>Build and serve the website locally</a></li><li role=none><a role=treeitem title="Explains the front matter used in our documentation and the fields available." href=/v1.21/docs/releases/contribute/front-matter/>Front matter</a></li><li role=none><a role=treeitem title="Shows you how changes to the Istio documentation and website are reviewed and approved." href=/v1.21/docs/releases/contribute/review/>Documentation Review Process</a></li><li role=none><a role=treeitem title="Explains how to include code in your documentation." href=/v1.21/docs/releases/contribute/code-blocks/>Add Code Blocks</a></li><li role=none><a role=treeitem title="Explains the shortcodes available and how to use them." href=/v1.21/docs/releases/contribute/shortcodes/>Use Shortcodes</a></li><li role=none><a role=treeitem title="Explains the standard markup used to format Istio documentation." href=/v1.21/docs/releases/contribute/formatting/>Follow Formatting Standards</a></li><li role=none><a role=treeitem title="Explains the style conventions used in the Istio documentation." href=/v1.21/docs/releases/contribute/style-guide/>Style Guide</a></li><li role=none><a role=treeitem title="Explains the terminology standards used in the Istio documentation." href=/v1.21/docs/releases/contribute/terminology/>Terminology Standards</a></li><li role=none><a role=treeitem title="Provides assets and instructions to create diagrams for the Istio documentation." href=/v1.21/docs/releases/contribute/diagrams/>Diagram Creation Guidelines</a></li></ul></li><li role=none><a role=treeitem title="List of recent changes to this website." href=/v1.21/docs/releases/log/>Website Content Changes</a></li></ul></li><li role=treeitem aria-label=Reference><a class=main title="Detailed authoritative reference material such as command-line options, configuration options, and API calling parameters." href=/v1.21/docs/reference/>Reference</a><ul role=group aria-expanded=true><li role=treeitem aria-label=Configuration><button aria-hidden=true tabindex=-1></button><a title="Detailed information on configuration options." href=/v1.21/docs/reference/config/>Configuration</a><ul role=group aria-expanded=false><li role=none><a role=treeitem title="Telemetry configuration for workloads." href=/v1.21/docs/reference/config/telemetry/>Telemetry</a></li><li role=none><a role=treeitem title="Describes the structure of messages generated by Istio analyzers." href=/v1.21/docs/reference/config/istio.analysis.v1alpha1/>Analysis Messages</a></li><li role=none><a role=treeitem title="Configuration affecting the service mesh as a whole." href=/v1.21/docs/reference/config/istio.mesh.v1alpha1/>Global Mesh Options</a></li><li role=none><a role=treeitem title="Configuration affecting Istio control plane installation version and shape." href=/v1.21/docs/reference/config/istio.operator.v1alpha1/>IstioOperator Options</a></li><li role=none><a role=treeitem title="Describes the role of the `status` field in configuration workflow." href=/v1.21/docs/reference/config/config-status/>Configuration Status Field</a></li><li role=treeitem aria-label="Proxy Extensions"><button aria-hidden=true tabindex=-1></button><a title="Describes how to configure Istio proxy extensions." href=/v1.21/docs/reference/config/proxy_extensions/>Proxy Extensions</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Extend the functionality provided by the Istio proxy through WebAssembly filters." href=/v1.21/docs/reference/config/proxy_extensions/wasm-plugin/>Wasm Plugin</a></li><li role=none><a role=treeitem title="Configuration for AccessLogPolicy Filter." href=/v1.21/docs/reference/config/proxy_extensions/accesslogpolicy/>AccessLogPolicy Config</a></li><li role=none><a role=treeitem title="Configuration for Stackdriver filter." href=/v1.21/docs/reference/config/proxy_extensions/stackdriver/>Stackdriver Config</a></li><li role=none><a role=treeitem title="Configuration for Stats Filter." href=/v1.21/docs/reference/config/proxy_extensions/stats/>Stats Config</a></li><li role=none><a role=treeitem title="How to enable telemetry generation with the Wasm runtime (Experimental)" href=/v1.21/docs/reference/config/proxy_extensions/wasm_telemetry/>Wasm-based Telemetry *</a></li></ul></li><li role=treeitem aria-label="Traffic Management"><button aria-hidden=true tabindex=-1></button><a title="Describes how to configure HTTP/TCP routing features." href=/v1.21/docs/reference/config/networking/>Traffic Management</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Configuration affecting load balancing, outlier detection, etc." href=/v1.21/docs/reference/config/networking/destination-rule/>Destination Rule</a></li><li role=none><a role=treeitem title="Customizing Envoy configuration generated by Istio." href=/v1.21/docs/reference/config/networking/envoy-filter/>Envoy Filter</a></li><li role=none><a role=treeitem title="Configuration affecting edge load balancer." href=/v1.21/docs/reference/config/networking/gateway/>Gateway</a></li><li role=none><a role=treeitem title="Provides configuration for individual workloads." href=/v1.21/docs/reference/config/networking/proxy-config/>ProxyConfig</a></li><li role=none><a role=treeitem title="Configuration affecting service registry." href=/v1.21/docs/reference/config/networking/service-entry/>Service Entry</a></li><li role=none><a role=treeitem title="Configuration affecting network reachability of a sidecar." href=/v1.21/docs/reference/config/networking/sidecar/>Sidecar</a></li><li role=none><a role=treeitem title="Configuration affecting label/content routing, sni routing, etc." href=/v1.21/docs/reference/config/networking/virtual-service/>Virtual Service</a></li><li role=none><a role=treeitem title="Configuration affecting VMs onboarded into the mesh." href=/v1.21/docs/reference/config/networking/workload-entry/>Workload Entry</a></li><li role=none><a role=treeitem title="Describes a collection of workload instances." href=/v1.21/docs/reference/config/networking/workload-group/>Workload Group</a></li></ul></li><li role=treeitem aria-label=Security><button aria-hidden=true tabindex=-1></button><a title="Describes how to configure Istio's security features." href=/v1.21/docs/reference/config/security/>Security</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Configuration to validate JWT." href=/v1.21/docs/reference/config/security/jwt/>JWTRule</a></li><li role=none><a role=treeitem title="Peer authentication configuration for workloads." href=/v1.21/docs/reference/config/security/peer_authentication/>PeerAuthentication</a></li><li role=none><a role=treeitem title="Request authentication configuration for workloads." href=/v1.21/docs/reference/config/security/request_authentication/>RequestAuthentication</a></li><li role=none><a role=treeitem title="Configuration for access control on workloads." href=/v1.21/docs/reference/config/security/authorization-policy/>Authorization Policy</a></li><li role=none><a role=treeitem title="Describes the supported conditions in authorization policies." href=/v1.21/docs/reference/config/security/conditions/>Authorization Policy Conditions</a></li><li role=none><a role=treeitem title="Describes the supported normalizations in authorization policies." href=/v1.21/docs/reference/config/security/normalization/>Authorization Policy Normalization</a></li></ul></li><li role=treeitem aria-label="Common Types"><button aria-hidden=true tabindex=-1></button><a title="Describes common types in Istio API." href=/v1.21/docs/reference/config/type/>Common Types</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Definition of a workload selector." href=/v1.21/docs/reference/config/type/workload-selector/>Workload Selector</a></li></ul></li><li role=none><a role=treeitem title="Istio standard metrics exported by Istio telemetry." href=/v1.21/docs/reference/config/metrics/>Istio Standard Metrics</a></li><li role=none><a role=treeitem title="Resource annotations used by Istio." href=/v1.21/docs/reference/config/annotations/>Resource Annotations</a></li><li role=none><a role=treeitem title="Resource labels used by Istio." href=/v1.21/docs/reference/config/labels/>Resource Labels</a></li><li role=treeitem aria-label="Configuration Analysis Messages"><button aria-hidden=true tabindex=-1></button><a title="Documents the individual error and warning messages produced during configuration analysis." href=/v1.21/docs/reference/config/analysis/>Configuration Analysis Messages</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0136/>AlphaAnnotation</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/message-format/>Analyzer Message Format</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0109/>ConflictingMeshGatewayVirtualServiceHosts</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0110/>ConflictingSidecarWorkloadSelectors</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0159/>ConflictingTelemetryWorkloadSelectors</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0116/>DeploymentAssociatedToMultipleServices</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0137/>DeploymentConflictingPorts</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0002/>Deprecated</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0135/>DeprecatedAnnotation</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0153/>EnvoyFilterUsesAddOperationIncorrectly</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0151/>EnvoyFilterUsesRelativeOperation</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0155/>EnvoyFilterUsesRelativeOperationWithProxyVersion</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0154/>EnvoyFilterUsesRemoveOperationIncorrectly</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0152/>EnvoyFilterUsesReplaceOperationIncorrectly</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0164/>ExternalControlPlaneAddressIsNotAHostname</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0150/>ExternalNameServiceTypeInvalidPortName</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0162/>GatewayPortNotDefinedOnService</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0167/>IneffectivePolicy</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0166/>IneffectiveSelector</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0001/>InternalError</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0125/>InvalidAnnotation</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0144/>InvalidApplicationUID</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0163/>InvalidExternalControlPlaneConfig</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0161/>InvalidGatewayCredential</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0122/>InvalidRegexp</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0157/>InvalidTelemetryProvider</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0143/>LocalhostListener</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0107/>MisplacedAnnotation</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0111/>MultipleSidecarsWithoutWorkloadSelectors</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0160/>MultipleTelemetriesWithoutWorkloadSelectors</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0123/>NamespaceMultipleInjectionLabels</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0102/>NamespaceNotInjected</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0127/>NoMatchingWorkloadsFound</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0128/>NoServerCertificateVerificationDestinationLevel</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0129/>NoServerCertificateVerificationPortLevel</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0103/>PodMissingProxy</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0158/>PodsIstioProxyImageMismatchInNamespace</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0118/>PortNameIsNotUnderNamingConvention</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0101/>ReferencedResourceNotFound</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0106/>SchemaValidationError</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0134/>ServiceEntryAddressesRequired</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0108/>UnknownAnnotation</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0112/>VirtualServiceDestinationPortSelectorRequired</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0132/>VirtualServiceHostNotFoundInGateway</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0131/>VirtualServiceIneffectiveMatch</a></li><li role=none><a role=treeitem title href=/v1.21/docs/reference/config/analysis/ist0130/>VirtualServiceUnreachableRule</a></li></ul></li></ul></li><li role=treeitem aria-label=Commands><button aria-hidden=true tabindex=-1></button><a title="Describes usage and options of the Istio commands and utilities." href=/v1.21/docs/reference/commands/>Commands</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title="Install and configure Istio CNI plugin on a node, detect and repair pod which is broken by race condition." href=/v1.21/docs/reference/commands/install-cni/>install-cni</a></li><li role=none><a role=treeitem title="Istio control interface." href=/v1.21/docs/reference/commands/istioctl/>istioctl</a></li><li role=none><a role=treeitem title="The Istio operator." href=/v1.21/docs/reference/commands/operator/>operator</a></li><li role=none><a role=treeitem title="Istio Pilot agent." href=/v1.21/docs/reference/commands/pilot-agent/>pilot-agent</a></li><li role=none><a role=treeitem title="Istio Pilot." href=/v1.21/docs/reference/commands/pilot-discovery/>pilot-discovery</a></li></ul></li><li role=none><a role=treeitem title="A glossary of common Istio terms." href=/v1.21/docs/reference/glossary/>Glossary</a></li></ul></li></ul></div></div></div></nav></div><div class=article-container><button id=sidebar-toggle class=main-navigation-toggle aria-label="Open sidebar">
<svg class="icon hamburger-sidebar"><use xlink:href="/v1.21/img/icons.svg#hamburger-sidebar"/></svg>
Contents</button><article aria-labelledby=title><nav aria-label=Breadcrumb><ol><li><a href=/v1.21/docs/ title="Learn how to deploy, use, and operate Istio.">Documentation</a><svg class="icon breadcrumb-arrow"><use xlink:href="/v1.21/img/icons.svg#breadcrumb-arrow"/></svg></li><li><a href=/v1.21/docs/ops/ title="Concepts, tools, and techniques to deploy and manage an Istio mesh.">Operations</a><svg class="icon breadcrumb-arrow"><use xlink:href="/v1.21/img/icons.svg#breadcrumb-arrow"/></svg></li><li><a href=/v1.21/docs/ops/ambient/ title="Information for setting up and operating Istio in ambient mode.">Ambient Mode</a><svg class="icon breadcrumb-arrow"><use xlink:href="/v1.21/img/icons.svg#breadcrumb-arrow"/></svg></li><li><a href=/v1.21/docs/ops/ambient/usage/ title="How to configure a mesh in ambient mode.">Ambient Mode User Guides</a><svg class="icon breadcrumb-arrow"><use xlink:href="/v1.21/img/icons.svg#breadcrumb-arrow"/></svg></li><li>Layer 4 Networking & mTLS with Ztunnel</li></ol></nav><div class=title-area><div style=width:100%><h1 id=title>Layer 4 Networking & mTLS with Ztunnel</h1><p class=byline><span class=reading-time title="6389 words"><svg class="icon clock"><use xlink:href="/v1.21/img/icons.svg#clock"/></svg><span>&nbsp;</span>30 minute read</span>
<span>&nbsp;</span>
<span><a href=https://github.com/istio/istio.io/tree/master/README.md#testing-document-content title='No automated test is available for this page. Click for details or to help create one.'><svg class="icon cancel-grey"><use xlink:href="/v1.21/img/icons.svg#cancel-grey"/></svg><span>&nbsp;</span>
page test</a></span></p></div></div><nav class=toc-inlined aria-label="Table of Contents"><div><hr><ol><li role=none aria-label=Introduction><a href=#introsection>Introduction</a><li role=none aria-label="Current Caveats"><a href=#caveats>Current Caveats</a><ol><li role=none aria-label="Environment used for this guide"><a href=#environment-used-for-this-guide>Environment used for this guide</a></ol></li><li role=none aria-label="Functional Overview"><a href=#functionaloverview>Functional Overview</a><ol><li role=none aria-label="Control plane overview"><a href=#control-plane-overview>Control plane overview</a><li role=none aria-label="Data plane overview"><a href=#data-plane-overview>Data plane overview</a><ol><li role=none aria-label="Ztunnel to ztunnel datapath"><a href=#ztunnel-to-ztunnel-datapath>Ztunnel to ztunnel datapath</a><li role=none aria-label="Ztunnel datapath via waypoint"><a href=#ztunnel-datapath-via-waypoint>Ztunnel datapath via waypoint</a><li role=none aria-label="Ztunnel datapath hair-pinning"><a href=#ztunnel-datapath-hair-pinning>Ztunnel datapath hair-pinning</a></ol></li><li role=none aria-label="Note on HBONE"><a href=#hbonesection>Note on HBONE</a></ol></li><li role=none aria-label="Deploying an Application"><a href=#deployapplication>Deploying an Application</a><ol><li role=none aria-label="Basic application deployment without Ambient"><a href=#basic-application-deployment-without-ambient>Basic application deployment without Ambient</a><li role=none aria-label="Enabling ambient for an application"><a href=#enabling-ambient-for-an-application>Enabling ambient for an application</a></ol></li><li role=none aria-label="Monitoring the ztunnel proxy & L4 networking"><a href=#monitoringzt>Monitoring the ztunnel proxy & L4 networking</a><ol><li role=none aria-label="Viewing ztunnel proxy state"><a href=#viewing-ztunnel-proxy-state>Viewing ztunnel proxy state</a><li role=none aria-label="Viewing Istiod state for ztunnel xDS resources"><a href=#viewing-istiod-state-for-ztunnel-xds-resources>Viewing Istiod state for ztunnel xDS resources</a><li role=none aria-label="Verifying ztunnel traffic logs"><a href=#verifying-ztunnel-traffic-logs>Verifying ztunnel traffic logs</a><li role=none aria-label="Monitoring and Telemetry via Prometheus, Grafana, Kiali"><a href=#monitoring-and-telemetry-via-prometheus-grafana-kiali>Monitoring and Telemetry via Prometheus, Grafana, Kiali</a><li role=none aria-label="Verifying ztunnel load balancing"><a href=#verifying-ztunnel-load-balancing>Verifying ztunnel load balancing</a><li role=none aria-label="Pod selection logic for ambient and sidecar modes"><a href=#pod-selection-logic-for-ambient-and-sidecar-modes>Pod selection logic for ambient and sidecar modes</a></ol></li><li role=none aria-label="L4 Authorization Policy"><a href=#l4auth>L4 Authorization Policy</a><li role=none aria-label="Ambient Interoperability with non-ambient endpoints"><a href=#interop>Ambient Interoperability with non-ambient endpoints</a><ol><li role=none aria-label="East-West non-mesh pod to ambient mesh pod (and use of PeerAuthentication resource)"><a href=#ewnonmesh>East-West non-mesh pod to ambient mesh pod (and use of PeerAuthentication resource)</a><li role=none aria-label="East-West Istio sidecar proxy pod to ambient mesh pod"><a href=#ewside2ambient>East-West Istio sidecar proxy pod to ambient mesh pod</a><li role=none aria-label="North-South Ingress Gateway to ambient backend pods"><a href=#nsingress2ambient>North-South Ingress Gateway to ambient backend pods</a></ol></li></ol><hr></div></nav><div><aside class="callout warning"><div class=type><svg class="large-icon"><use xlink:href="/v1.21/img/icons.svg#callout-warning"/></svg></div><div class=content><p>Ambient mode is currently in the <a href=/v1.21/docs/releases/feature-stages/#feature-phase-definitions>Alpha</a> phase.</p><p>Please <strong>do not use ambient mode in production</strong>, and be sure to thoroughly review the <a href=/v1.21/docs/releases/feature-stages/#feature-phase-definitions>feature phase definitions</a> before use.</p><p>In particular, there are known performance, stability, and security issues in the alpha release.
There are also planned breaking changes, including some that will prevent upgrades.
These limitations will be addressed before ambient mode moves to Beta.</p></div></aside></div><h2 id=introsection>Introduction</h2><p>This guide describes in-depth the functionality and usage of the ztunnel proxy and Layer 4 networking functions in Istio ambient mesh. To simply try out Istio ambient mesh, follow the <a href=/v1.21/docs/ops/ambient/getting-started/>Ambient Quickstart</a> instead. This guide follows a user journey and works through multiple examples to detail the design and architecture of Istio ambient. It is highly recommended to follow the topics linked below in sequence.</p><ul><li><a href=/v1.21/docs/ops/ambient/usage/ztunnel/#introsection>Introduction</a></li><li><a href=/v1.21/docs/ops/ambient/usage/ztunnel/#caveats>Current Caveats</a></li><li><a href=/v1.21/docs/ops/ambient/usage/ztunnel/#functionaloverview>Functional Overview</a></li><li><a href=/v1.21/docs/ops/ambient/usage/ztunnel/#deployapplication>Deploying an Application</a></li><li><a href=/v1.21/docs/ops/ambient/usage/ztunnel/#monitoringzt>Monitoring the ztunnel proxy & L4 networking</a></li><li><a href=/v1.21/docs/ops/ambient/usage/ztunnel/#l4auth>L4 Authorization Policy</a></li><li><a href=/v1.21/docs/ops/ambient/usage/ztunnel/#interop>Ambient Interoperability with non-Ambient endpoints</a></li></ul><p>The ztunnel (Zero Trust Tunnel) component is a purpose-built per-node proxy for Istio ambient mesh. Since workload pods no longer require proxies running in sidecars in order to participate in the mesh, Istio in ambient mode is informally also referred to as &ldquo;sidecar-less&rdquo; mesh.</p><div><aside class="callout tip"><div class=type><svg class="large-icon"><use xlink:href="/v1.21/img/icons.svg#callout-tip"/></svg></div><div class=content>Pods/workloads using sidecar proxies can co-exist within the same mesh as pods that operate in ambient mode. Mesh pods that use sidecar proxies can also interoperate with pods in the same Istio mesh that are running in ambient mode. The term ambient mesh refers to an Istio mesh that has a superset of the capabilities and hence can support mesh pods that use either type of proxying.</div></aside></div><p>The ztunnel node proxy is responsible for securely connecting and authenticating workloads within the ambient mesh. The ztunnel proxy is written in Rust and is intentionally scoped to handle L3 and L4 functions in the ambient mesh such as mTLS, authentication, L4 authorization and telemetry. Ztunnel does not terminate workload HTTP traffic or parse workload HTTP headers. The ztunnel ensures L3 and L4 traffic is efficiently and securely transported to <strong>waypoint proxies</strong>, where the full suite of Istio’s L7 functionality, such as HTTP telemetry and load balancing, is implemented. The term &ldquo;Secure Overlay Networking&rdquo; is used informally to collectively describe the set of L4 networking functions implemented in an ambient mesh via the ztunnel proxy. At the transport layer, this is implemented via an HTTP CONNECT-based traffic tunneling protocol called HBONE which is described in a <a href=/v1.21/docs/ops/ambient/usage/ztunnel/#hbonesection>later section</a> of this guide.</p><p>Some use cases of Istio in ambient mode may be addressed solely via the L4 secure overlay networking features, and will not need L7 features thereby not requiring deployment of a waypoint proxy. Other use cases requiring advanced traffic management and L7 networking features will require deployment of a waypoint proxy. This guide focuses on functionality related to the L4 secure overlay network using ztunnel proxies. This guide refers to L7 only when needed to describe some L4 ztunnel function. Other guides are dedicated to cover the advanced L7 networking functions and the use of waypoint proxies in detail.</p><table><thead><tr><th>Application Deployment Use Case</th><th>Istio Ambient Mesh Configuration</th></tr></thead><tbody><tr><td>Zero Trust networking via mutual-TLS, encrypted and tunneled data transport of client application traffic, L4 authorization, L4 telemetry</td><td>Baseline Ambient Mesh with ztunnel proxy networking</td></tr><tr><td>Application requires L4 Mutual-TLS plus advanced Istio traffic management features (incl VirtualService, L7 telemetry, L7 Authorization)</td><td>Full Istio Ambient Mesh configuration both ztunnel proxy and waypoint proxy based networking</td></tr></tbody></table><h2 id=caveats>Current Caveats</h2><div><aside class="callout warning"><div class=type><svg class="large-icon"><use xlink:href="/v1.21/img/icons.svg#callout-warning"/></svg></div><div class=content><p>Ambient mode is currently in the <a href=/v1.21/docs/releases/feature-stages/#feature-phase-definitions>Alpha</a> phase.</p><p>Please <strong>do not use ambient mode in production</strong>, and be sure to thoroughly review the <a href=/v1.21/docs/releases/feature-stages/#feature-phase-definitions>feature phase definitions</a> before use.</p><p>In particular, there are known performance, stability, and security issues in the alpha release.
There are also planned breaking changes, including some that will prevent upgrades.
These limitations will be addressed before ambient mode moves to Beta.</p></div></aside></div><p>The following is a list of feature restrictions or caveats in ambient mode alpha. These restrictions are planned to be addressed or removed in future releases.</p><ol><li><p><strong>Kubernetes only:</strong> Istio in ambient mode is currently only supported for deployment on Kubernetes clusters. Deployment on non-Kubernetes endpoints such as virtual machines is not currently supported.</p></li><li><p><strong>No Istio multi-cluster support:</strong> Only single cluster deployments are currently supported for Istio ambient mode.</p></li><li><p><strong>TCP/IPv4 only:</strong> In the current release, TCP over IPv4 is the only protocol supported for transport on an Istio secure overlay tunnel (this includes protocols such as HTTP that run between application layer endpoints on top of the TCP/ IPv4 connection).</p></li><li><p><strong>Cannot transparently convert existing Istio deployments to ambient mode:</strong> Ambient mode can only be enabled on a new Istio mesh control plane that is deployed using the ambient <code>istioctl</code> profile or Helm configuration. An existing Istio mesh deployed using a sidecar profile cannot currently be dynamically switched to enable ambient mode.</p></li><li><p><strong>Restrictions with Istio <code>PeerAuthentication</code>:</strong> as of the time of writing, the <code>PeerAuthentication</code> resource is not supported by all components (i.e. waypoint proxies) in Istio ambient mode. Hence it is recommended to only use the <code>STRICT</code> mTLS mode currently. Like many of the other alpha stage caveats, this shall be addressed as the feature moves toward beta status.</p></li><li><p><strong>istioctl CLI gaps:</strong> There may be some minor functional gaps in areas such as Istio CLI output displays when it comes to displaying or monitoring Istio&rsquo;s ambient mode related information. These will be addressed as the feature matures.</p></li></ol><h3 id=environment-used-for-this-guide>Environment used for this guide</h3><p>The examples in this guide used a deployment of Istio version <code>1.21.0</code> on a <code>kind</code> cluster of version <code>0.20.0</code> running Kubernetes version <code>1.27.3</code>.</p><p>The examples below require a cluster with more than 1 worker node in order to explain how cross-node traffic operates. Refer to the <a href=/v1.21/docs/ops/ambient/install/>installation user guide</a> or <a href=/v1.21/docs/ops/ambient/getting-started/>getting started guide</a> for information on installing Istio in ambient mode on a Kubernetes cluster.</p><h2 id=functionaloverview>Functional Overview</h2><p>The functional behavior of the ztunnel proxy can be divided into its data plane behavior and its interaction with the Istio control plane. This section takes a brief look at these two aspects - detailed description of the internal design of the ztunnel proxy is out of scope for this guide.</p><h3 id=control-plane-overview>Control plane overview</h3><p>The figure shows an overview of the control plane related components and flows between ztunnel proxy and the <code>istiod</code> control plane.</p><figure style=width:100%><div class=wrapper-with-intrinsic-ratio style=padding-bottom:67.74193548387096%><a data-skipendnotes=true href=/v1.21/docs/ops/ambient/usage/ztunnel/ztunnel-architecture.png title="Ztunnel architecture"><img class=element-to-stretch src=/v1.21/docs/ops/ambient/usage/ztunnel/ztunnel-architecture.png alt="Ztunnel architecture"></a></div><figcaption>Ztunnel architecture</figcaption></figure><p>The ztunnel proxy uses xDS APIs to communicate with the Istio control plane (<code>istiod</code>). This enables the fast, dynamic configuration updates required in modern distributed systems. The ztunnel proxy also obtains mTLS certificates for the Service Accounts of all pods that are scheduled on its Kubernetes node using xDS. A single ztunnel proxy may implement L4 data plane functionality on behalf of any pod sharing it&rsquo;s node which requires efficiently obtaining relevant configuration and certificates. This multi-tenant architecture contrasts sharply with the sidecar model where each application pod has its own proxy.</p><p>It is also worth noting that in ambient mode, a simplified set of resources are used in the xDS APIs for ztunnel proxy configuration. This results in improved performance (having to transmit and process a much smaller set of information that is sent from istiod to the ztunnel proxies) and improved troubleshooting.</p><h3 id=data-plane-overview>Data plane overview</h3><p>This section briefly summarizes key aspects of the data plane functionality.</p><h4 id=ztunnel-to-ztunnel-datapath>Ztunnel to ztunnel datapath</h4><p>The first scenario is ztunnel to ztunnel L4 networking. This is depicted in the following figure.</p><figure style=width:100%><div class=wrapper-with-intrinsic-ratio style=padding-bottom:38.50883935434281%><a data-skipendnotes=true href=/v1.21/docs/ops/ambient/usage/ztunnel/ztunnel-datapath-1.png title="Basic ztunnel L4-only datapath"><img class=element-to-stretch src=/v1.21/docs/ops/ambient/usage/ztunnel/ztunnel-datapath-1.png alt="Basic ztunnel L4-only datapath"></a></div><figcaption>Basic ztunnel L4-only datapath</figcaption></figure><p>The figure depicts ambient pod workloads running on two nodes W1 and W2 of a Kubernetes cluster. There is a single instance of the ztunnel proxy on each node. In this scenario, application client pods C1, C2 and C3 need to access a service provided by pod S1 and there is no requirement for advanced L7 features such as L7 traffic routing or L7 traffic management so no Waypoint proxy is needed.</p><p>The figure shows that pods C1 and C2 running on node W1 connect with pod S1 running on node W2 and their TCP traffic is tunneled through HBONE tunnel instances that have been created by the ztunnel proxy pods of each node. Mutual TLS (mTLS) is used for encryption as well as mutual authentication of traffic being tunneled. SPIFFE identities are used to identify the workloads on each side of the connection. The term <code>HBONE</code> (for HTTP Based Overlay Network Encapsulation) is used in Istio ambient to refer to a technique for transparently and securely tunneling TCP packets encapsulated within HTTPS packets. For more details on the datapath, including HBONE and the traffic redirection details, refer to the <a href=/v1.21/docs/ops/ambient/usage/traffic-redirection/>ztunnel traffic redirection</a> guide.</p><div><aside class="callout tip"><div class=type><svg class="large-icon"><use xlink:href="/v1.21/img/icons.svg#callout-tip"/></svg></div><div class=content>Note: Although the figure shows the HBONE tunnels to be between the two ztunnel proxies, in the in-pod redirection implementation introduced in Istio 1.21.0 the tunnels are in fact between the source and destination pods. Traffic is HBONE encapsulated and encrypted in the network namespace of the source pod itself, and eventually decapsulated and decrypted in the network namespace of the destination pod on the destination worker node. The ztunnel proxy still logically handles both the control plane and data plane needed for HBONE transport, however it is able to do that from inside the network namespaces of the source and destination pods.</div></aside></div><p>Note that the figure shows that local traffic - from pod C3 to destination pod S1 on worker node W2 - also traverses the local ztunnel proxy instance so that L4 traffic management functions such as L4 Authorization and L4 Telemetry are enforced identically on traffic, whether or not it crosses a node boundary.</p><h4 id=ztunnel-datapath-via-waypoint>Ztunnel datapath via waypoint</h4><p>The next figure depicts the data path for a use case which requires advanced L7 traffic routing, management or policy handling. Here ztunnel uses HBONE tunneling to send traffic to a waypoint proxy for L7 processing. After processing, the waypoint sends traffic via a second HBONE tunnel to the ztunnel on the node hosting the selected service destination pod. In general the waypoint proxy may or may not be located on the same nodes as the source or destination pod.</p><figure style=width:100%><div class=wrapper-with-intrinsic-ratio style=padding-bottom:37.84143904063957%><a data-skipendnotes=true href=/v1.21/docs/ops/ambient/usage/ztunnel/ztunnel-waypoint-datapath.png title="Ztunnel datapath via an interim waypoint"><img class=element-to-stretch src=/v1.21/docs/ops/ambient/usage/ztunnel/ztunnel-waypoint-datapath.png alt="Ztunnel datapath via an interim waypoint"></a></div><figcaption>Ztunnel datapath via an interim waypoint</figcaption></figure><h4 id=ztunnel-datapath-hair-pinning>Ztunnel datapath hair-pinning</h4><div><aside class="callout warning"><div class=type><svg class="large-icon"><use xlink:href="/v1.21/img/icons.svg#callout-warning"/></svg></div><div class=content>As noted earlier, some ambient functions may change as the project moves to beta status and beyond. This feature (hair-pinning) is an example of a feature that is currently available in the alpha version of ambient and under review for possible modification as the project evolves.</div></aside></div><p>It was noted earlier that traffic is always sent to a destination pod by first sending it to the ztunnel proxy on the same node as the destination pod. But what if the sender is either completely outside the Istio ambient mesh and hence does not initiate HBONE tunnels to the destination ztunnel first? What if the sender is malicious and trying to send traffic directly to an ambient pod destination, bypassing the destination ztunnel proxy?</p><p>There are two scenarios here, both of which are depicted in the following figure:</p><ol><li>Traffic stream B1 is being received by node W2 outside of any HBONE tunnel and directly addressed to ambient pod S1&rsquo;s IP address for some reason (possibly because the traffic source is not an ambient pod). As shown in the figure, the ztunnel traffic redirection logic intercepts such traffic and redirects it via the local ztunnel proxy for destination-side proxy processing and possible filtering based on AuthorizationPolicy prior to sending it into pod S1.</li><li>Traffic stream G1 is being received by the ztunnel proxy of node W2 (possibly over an HBONE tunnel). However, the ztunnel proxy checks that the destination service requires waypoint processing and yet the source sending this traffic is not a waypoint or is not associated with this destination service. In this case, the ztunnel proxy hairpins the traffic towards one of the waypoints associated with the destination service from where it can then be delivered to any pod implementing the destination service (possibly to pod S1 itself, as shown in the figure).</li></ol><figure style=width:100%><div class=wrapper-with-intrinsic-ratio style=padding-bottom:43.80883417813179%><a data-skipendnotes=true href=/v1.21/docs/ops/ambient/usage/ztunnel/ztunnel-hairpin.png title="Ztunnel traffic hair-pinning"><img class=element-to-stretch src=/v1.21/docs/ops/ambient/usage/ztunnel/ztunnel-hairpin.png alt="Ztunnel traffic hair-pinning"></a></div><figcaption>Ztunnel traffic hair-pinning</figcaption></figure><h3 id=hbonesection>Note on HBONE</h3><p>HBONE (HTTP Based Overlay Network Encapsulation) is an Istio-specific term. It refers to the use of standard HTTP tunneling via the <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/CONNECT>HTTP CONNECT</a> method to transparently tunnel application packets/ byte streams. In its current implementation within Istio, it transports TCP packets by tunneling these transparently using the HTTP CONNECT method, uses <a href=https://httpwg.org/specs/rfc7540.html>HTTP/2</a>, with encryption and mutual authentication provided by <a href=https://www.cloudflare.com/learning/access-management/what-is-mutual-tls/>mutual TLS</a> and the HBONE tunnel itself runs on TCP port 15008. The overall HBONE packet format from IP layer onwards is depicted in the following figure.</p><figure style=width:100%><div class=wrapper-with-intrinsic-ratio style=padding-bottom:8.038147138964577%><a data-skipendnotes=true href=/v1.21/docs/ops/ambient/usage/ztunnel/hbone-packet.png title="HBONE L3 packet format"><img class=element-to-stretch src=/v1.21/docs/ops/ambient/usage/ztunnel/hbone-packet.png alt="HBONE L3 packet format"></a></div><figcaption>HBONE L3 packet format</figcaption></figure><p>Additional use cases of HBONE and HTTP tunneling (such as support for IPv6 and UDP packets) will be investigated in the future as ambient mode evolves.</p><h2 id=deployapplication>Deploying an Application</h2><p>Normally, a user with Istio admin privileges will deploy the Istio mesh infrastructure. Once Istio is successfully deployed in ambient mode, it will be transparently available to applications deployed by all users in namespaces that have been annotated to use Istio ambient as illustrated in the examples below.</p><h3 id=basic-application-deployment-without-ambient>Basic application deployment without Ambient</h3><p>First, deploy a simple HTTP client server application without making it part of the Istio ambient mesh. Execute the following examples from the top of a local Istio repository or Istio folder created by downloading the istioctl client as described in Istio guides.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl create ns ambient-demo
$ kubectl apply -f samples/httpbin/httpbin.yaml -n ambient-demo
$ kubectl apply -f samples/sleep/sleep.yaml -n ambient-demo
$ kubectl apply -f samples/sleep/notsleep.yaml -n ambient-demo
$ kubectl scale deployment sleep --replicas=2 -n ambient-demo
</code></pre><p>These manifests deploy multiple replicas of the <code>sleep</code> and <code>notsleep</code> pods which will be used as clients for the httpbin service pod (for simplicity, the command-line outputs have been deleted in the code samples above).</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl wait -n ambient-demo --for=condition=ready pod --selector=app=httpbin --timeout=90s
pod/httpbin-648cd984f8-7vg8w condition met
</code></pre><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl get pods -n ambient-demo
NAME                       READY   STATUS    RESTARTS   AGE
httpbin-648cd984f8-7vg8w   1/1     Running   0          31m
notsleep-bb6696574-2tbzn   1/1     Running   0          31m
sleep-69cfb4968f-mhccl     1/1     Running   0          31m
sleep-69cfb4968f-rhhhp     1/1     Running   0          31m
</code></pre><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl get svc httpbin -n ambient-demo
NAME      TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)    AGE
httpbin   ClusterIP   10.110.145.219   &lt;none&gt;        8000/TCP   28m
</code></pre><p>Note that each application pod has just 1 container running in it (the &ldquo;1/1&rdquo; indicator) and that <code>httpbin</code> is an http service listening on <code>ClusterIP</code> service port 8000. You should now be able to <code>curl</code> this service from either client pod and confirm it returns the <code>httpbin</code> web page as shown below. At this point there is no <code>TLS</code> of any form being used.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl exec deploy/sleep -n ambient-demo  -- curl httpbin:8000 -s | grep title -m 1
    &lt;title&gt;httpbin.org&lt;/title&gt;
</code></pre><h3 id=enabling-ambient-for-an-application>Enabling ambient for an application</h3><p>You can now enable ambient for the application deployed in the prior subsection by simply adding the label <code>istio.io/dataplane-mode=ambient</code> to the application&rsquo;s namespace as shown below. Note that this example focuses on a fresh namespace with new, sidecar-less workloads captured via ambient mode only. Later sections will describe how conflicts are resolved in hybrid scenarios that mix sidecar mode and ambient mode within the same mesh.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl label namespace ambient-demo istio.io/dataplane-mode=ambient
$ kubectl  get pods -n ambient-demo
NAME                       READY   STATUS    RESTARTS   AGE
httpbin-648cd984f8-7vg8w   1/1     Running   0          78m
notsleep-bb6696574-2tbzn   1/1     Running   0          77m
sleep-69cfb4968f-mhccl     1/1     Running   0          78m
sleep-69cfb4968f-rhhhp     1/1     Running   0          78m
</code></pre><p>Note that after ambient is enabled for the namespace, every application pod still only has 1 container, and the uptime of these pods indicates these were not restarted in order to enable ambient mode (unlike sidecar mode, which requires pods to be restarted when the sidecar proxies are injected). This results in better user experience and operational performance since ambient mode can seamlessly be enabled (or disabled) completely transparently as far as the application pods are concerned.</p><p>Initiate a <code>curl</code> request again from one of the client pods to the service to verify that traffic continues to flow while ambient mode.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl exec deploy/sleep -n ambient-demo  -- curl httpbin:8000 -s | grep title -m 1
    &lt;title&gt;httpbin.org&lt;/title&gt;
</code></pre><p>This indicates the traffic path is working. The next section looks at how to monitor the configuration and data plane of the ztunnel proxy to confirm that traffic is correctly using the ztunnel proxy.</p><h2 id=monitoringzt>Monitoring the ztunnel proxy & L4 networking</h2><p>This section describes some options for monitoring the ztunnel proxy configuration and data path. This information can also help with some high level troubleshooting and in identifying information that would be useful to collect and provide in a bug report if there are any problems. Additional advanced monitoring of ztunnel internals and advanced troubleshooting is out of scope for this guide.</p><h3 id=viewing-ztunnel-proxy-state>Viewing ztunnel proxy state</h3><p>As indicated previously, the ztunnel proxy on each node gets configuration and discovery information from the istiod component via xDS APIs. Use the <code>istioctl proxy-config</code> command shown below to view discovered workloads as seen by a ztunnel proxy as well as secrets holding the TLS certificates that the ztunnel proxy has received from the istiod control plane to use in mTLS signaling on behalf of the local workloads.</p><p>In the first example, you see all the workloads and control plane components that the specific ztunnel pod is currently tracking including information about the IP address and protocol to use when connecting to that component and whether there is a Waypoint proxy associated with that workload. This example can repeated with any of the other ztunnel pods in the system to display their current configuration.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ export ZTUNNEL=$(kubectl get pods -n istio-system -o wide | grep ztunnel -m 1 | sed &#39;s/ .*//&#39;)
$ echo &#34;$ZTUNNEL&#34;
</code></pre><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ istioctl proxy-config workloads &#34;$ZTUNNEL&#34;.istio-system
NAME                                   NAMESPACE          IP         NODE               WAYPOINT PROTOCOL
coredns-6d4b75cb6d-ptbhb               kube-system        10.240.0.2 amb1-control-plane None     TCP
coredns-6d4b75cb6d-tv5nz               kube-system        10.240.0.3 amb1-control-plane None     TCP
httpbin-648cd984f8-2q9bn               ambient-demo       10.240.1.5 amb1-worker        None     HBONE
httpbin-648cd984f8-7dglb               ambient-demo       10.240.2.3 amb1-worker2       None     HBONE
istiod-5c7f79574c-pqzgc                istio-system       10.240.1.2 amb1-worker        None     TCP
local-path-provisioner-9cd9bd544-x7lq2 local-path-storage 10.240.0.4 amb1-control-plane None     TCP
notsleep-bb6696574-r4xjl               ambient-demo       10.240.2.5 amb1-worker2       None     HBONE
sleep-69cfb4968f-mwglt                 ambient-demo       10.240.1.4 amb1-worker        None     HBONE
sleep-69cfb4968f-qjmfs                 ambient-demo       10.240.2.4 amb1-worker2       None     HBONE
ztunnel-5jfj2                          istio-system       10.240.0.5 amb1-control-plane None     TCP
ztunnel-gkldc                          istio-system       10.240.1.3 amb1-worker        None     TCP
ztunnel-xxbgj                          istio-system       10.240.2.2 amb1-worker2       None     TCP
</code></pre><p>In the second example, you see the list of TLS certificates that this ztunnel proxy instance has received from istiod to use in TLS signaling.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ istioctl proxy-config secrets &#34;$ZTUNNEL&#34;.istio-system
NAME                                                  TYPE           STATUS        VALID CERT     SERIAL NUMBER                        NOT AFTER                NOT BEFORE
spiffe://cluster.local/ns/ambient-demo/sa/httpbin     CA             Available     true           edf7f040f4b4d0b75a1c9a97a9b13545     2023-09-20T19:02:00Z     2023-09-19T19:00:00Z
spiffe://cluster.local/ns/ambient-demo/sa/httpbin     Cert Chain     Available     true           ec30e0e1b7105e3dce4425b5255287c6     2033-09-16T18:26:19Z     2023-09-19T18:26:19Z
spiffe://cluster.local/ns/ambient-demo/sa/sleep       CA             Available     true           3b9dbea3b0b63e56786a5ea170995f48     2023-09-20T19:00:44Z     2023-09-19T18:58:44Z
spiffe://cluster.local/ns/ambient-demo/sa/sleep       Cert Chain     Available     true           ec30e0e1b7105e3dce4425b5255287c6     2033-09-16T18:26:19Z     2023-09-19T18:26:19Z
spiffe://cluster.local/ns/istio-system/sa/istiod      CA             Available     true           885ee63c08ef9f1afd258973a45c8255     2023-09-20T18:26:34Z     2023-09-19T18:24:34Z
spiffe://cluster.local/ns/istio-system/sa/istiod      Cert Chain     Available     true           ec30e0e1b7105e3dce4425b5255287c6     2033-09-16T18:26:19Z     2023-09-19T18:26:19Z
spiffe://cluster.local/ns/istio-system/sa/ztunnel     CA             Available     true           221b4cdc4487b60d08e94dc30a0451c6     2023-09-20T18:26:35Z     2023-09-19T18:24:35Z
spiffe://cluster.local/ns/istio-system/sa/ztunnel     Cert Chain     Available     true           ec30e0e1b7105e3dce4425b5255287c6     2033-09-16T18:26:19Z     2023-09-19T18:26:19Z
</code></pre><p>Using these CLI commands, a user can check that ztunnel proxies are getting configured with all the expected workloads and TLS certificates and missing information can be used for troubleshooting to explain any potential observed networking errors. A user may also use the <code>all</code> option to view all parts of the proxy-config with a single CLI command and the JSON output formatter as shown in the example below to display the complete set of available state information.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ istioctl proxy-config all &#34;$ZTUNNEL&#34;.istio-system -o json | jq
</code></pre><p>Note that when used with a ztunnel proxy instance, not all options of the <code>istioctl proxy-config</code> CLI are supported since some apply only to sidecar proxies.</p><p>An advanced user may also view the raw configuration dump of a ztunnel proxy via a <code>curl</code> to the endpoint inside a ztunnel proxy pod as shown in the following example.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl exec ds/ztunnel -n istio-system  -- curl http://localhost:15000/config_dump | jq .
</code></pre><h3 id=viewing-istiod-state-for-ztunnel-xds-resources>Viewing Istiod state for ztunnel xDS resources</h3><p>Sometimes an advanced user may want to view the state of ztunnel proxy config resources as maintained in the istiod control plane, in the format of the xDS API resources defined specially for ztunnel proxies. This can be done by exec-ing into the istiod pod and obtaining this information from port 15014 for a given ztunnel proxy as shown in the example below. This output can then also be saved and viewed with a JSON pretty print formatter utility for easier browsing (not shown in the example).</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl exec -n istio-system deploy/istiod -- curl localhost:15014/debug/config_dump?proxyID=&#34;$ZTUNNEL&#34;.istio-system | jq
</code></pre><h3 id=verifying-ztunnel-traffic-logs>Verifying ztunnel traffic logs</h3><p>Send some traffic from a client <code>sleep</code> pod to the <code>httpbin</code> service.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl -n ambient-demo exec deploy/sleep -- sh -c &#34;for i in $(seq 1 10); do curl -s -I http://httpbin:8000/; done&#34;
HTTP/1.1 200 OK
Server: gunicorn/19.9.0
--snip--
</code></pre><p>The response displayed confirms the client pod receives responses from the service. Now check logs of the ztunnel pods to confirm the traffic was sent over the HBONE tunnel.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl -n istio-system logs -l app=ztunnel | grep -E &#34;inbound|outbound&#34;
2023-08-14T09:15:46.542651Z  INFO outbound{id=7d344076d398339f1e51a74803d6c854}: ztunnel::proxy::outbound: proxying to 10.240.2.10:80 using node local fast path
2023-08-14T09:15:46.542882Z  INFO outbound{id=7d344076d398339f1e51a74803d6c854}: ztunnel::proxy::outbound: complete dur=269.272µs
--snip--
</code></pre><p>These log messages confirm the traffic indeed used the ztunnel proxy in the datapath. Additional fine-grained monitoring can be done by checking logs on the specific ztunnel proxy instances that are on the same nodes as the source and destination pods of traffic. If these logs are not seen, then a possibility is that traffic redirection may not be working correctly. Detailed description of monitoring and troubleshooting of the traffic redirection logic is out of scope for this guide. Note that as mentioned previously, with ambient traffic always traverses the ztunnel pod even when the source and destination of the traffic are on the same compute node.</p><h3 id=monitoring-and-telemetry-via-prometheus-grafana-kiali>Monitoring and Telemetry via Prometheus, Grafana, Kiali</h3><p>In addition to checking ztunnel logs and other monitoring options noted above, one can also use normal Istio monitoring and telemetry functions to monitor application traffic within an Istio Ambient mesh.
The use of Istio in ambient mode does not change this behavior. Since this functionality is largely unchanged in Istio ambient mode from Istio sidecar mode, these details are not repeated in this guide. Please refer to:</p><ul><li><a href=/v1.21/docs/ops/integrations/prometheus/#installation>Prometheus installation</a></li><li><a href=/v1.21/docs/ops/integrations/kiali/#installation>Kiali installation</a></li><li><a href=/v1.21/docs/reference/config/metrics/>Istio metrics</a></li><li><a href=/v1.21/docs/tasks/observability/metrics/querying-metrics/>Querying Metrics from Prometheus</a></li></ul><p>One point to note is that in case of a service that is only using ztunnel and L4 networking, the Istio metrics reported will currently only be the L4 TCP metrics (namely <code>istio_tcp_sent_bytes_total</code>, <code>istio_tcp_received_bytes_total</code>, <code>istio_tcp_connections_opened_total</code>, <code>istio_tcp_connections_closed_total</code>). The full set of Istio and Envoy metrics will be reported when a Waypoint proxy is involved.</p><h3 id=verifying-ztunnel-load-balancing>Verifying ztunnel load balancing</h3><p>The ztunnel proxy automatically performs client-side load balancing if the destination is a service with multiple endpoints. No additional configuration is needed. The ztunnel load balancing algorithm is an internally fixed L4 Round Robin algorithm that distributes traffic based on L4 connection state and is not user configurable.</p><div><aside class="callout tip"><div class=type><svg class="large-icon"><use xlink:href="/v1.21/img/icons.svg#callout-tip"/></svg></div><div class=content>If the destination is a service with multiple instances or pods and there is no Waypoint associated with the destination service, then the source ztunnel proxy performs L4 load balancing directly across these instances or service backends and then sends traffic via the remote ztunnel proxies associated with those backends. If the destination service does have a Waypoint deployment (with one or more backend instances of the Waypoint proxy) associated with it, then the source ztunnel proxy performs load balancing by distributing traffic across these Waypoint proxies and sends traffic via the remote ztunnel proxies associated with the Waypoint proxy instances.</div></aside></div><p>Now repeat the previous example with multiple replicas of the service pod and verify that client traffic is load balanced across the service replicas. Wait for all pods in the ambient-demo namespace to go into Running state before continuing to the next step.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl -n ambient-demo scale deployment httpbin --replicas=2 ; kubectl wait --for condition=available  deployment/httpbin -n ambient-demo
deployment.apps/httpbin scaled
deployment.apps/httpbin condition met
</code></pre><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl -n ambient-demo exec deploy/sleep -- sh -c &#34;for i in $(seq 1 10); do curl -s -I http://httpbin:8000/; done&#34;
</code></pre><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl -n istio-system logs -l app=ztunnel | grep -E &#34;inbound|outbound&#34;
--snip--

2023-08-14T09:33:24.969996Z  INFO inbound{id=ec177a563e4899869359422b5cdd1df4 peer_ip=10.240.2.16 peer_id=spiffe://cluster.local/ns/ambient-demo/sa/sleep}: ztunnel::proxy::inbound: got CONNECT request to 10.240.1.11:80
2023-08-14T09:33:25.028601Z  INFO inbound{id=1ebc3c7384ee68942bbb7c7ed866b3d9 peer_ip=10.240.2.16 peer_id=spiffe://cluster.local/ns/ambient-demo/sa/sleep}: ztunnel::proxy::inbound: got CONNECT request to 10.240.1.11:80

--snip--

2023-08-14T09:33:25.226403Z  INFO outbound{id=9d99723a61c9496532d34acec5c77126}: ztunnel::proxy::outbound: proxy to 10.240.1.11:80 using HBONE via 10.240.1.11:15008 type Direct
2023-08-14T09:33:25.273268Z  INFO outbound{id=9d99723a61c9496532d34acec5c77126}: ztunnel::proxy::outbound: complete dur=46.9099ms
2023-08-14T09:33:25.276519Z  INFO outbound{id=cc87b4de5ec2ccced642e22422ca6207}: ztunnel::proxy::outbound: proxying to 10.240.2.10:80 using node local fast path
2023-08-14T09:33:25.276716Z  INFO outbound{id=cc87b4de5ec2ccced642e22422ca6207}: ztunnel::proxy::outbound: complete dur=231.892µs

--snip--
</code></pre><p>Here note the logs from the ztunnel proxies first indicating the http CONNECT request to the new destination pod (10.240.1.11) which indicates the setup of the HBONE tunnel to ztunnel on the node hosting the additional destination service pod. This is then followed by logs indicating the client traffic being sent to both 10.240.1.11 and 10.240.2.10 which are the two destination pods providing the service. Also note that the data path is performing client-side load balancing in this case and not depending on Kubernetes service load balancing. In your setup these numbers will be different and will match the pod addresses of the httpbin pods in your cluster.</p><p>This is a round robin load balancing algorithm and is separate from and independent of any load balancing algorithm that may be configured within a <code>VirtualService</code>&rsquo;s <code>TrafficPolicy</code> field, since as discussed previously, all aspects of <code>VirtualService</code> API objects are instantiated on the Waypoint proxies and not the ztunnel proxies.</p><h3 id=pod-selection-logic-for-ambient-and-sidecar-modes>Pod selection logic for ambient and sidecar modes</h3><p>Istio with sidecar proxies can co-exist with ambient based node level proxies within the same compute cluster. It is important to ensure that the same pod or namespace does not get configured to use both a sidecar proxy and an ambient node-level proxy. However, if this does occur, currently sidecar injection takes precedence for such a pod or namespace.</p><p>Note that two pods within the same namespace could in theory be set to use different modes by labeling individual pods separately from the namespace label, however this is not recommended. For most common use cases it is recommended that a single mode be used for all pods within a single namespace.</p><p>The exact logic to determine whether a pod is set up to use ambient mode is as follows.</p><ol><li><p>The <code>istio-cni</code> plugin configuration exclude list configured in <code>cni.values.excludeNamespaces</code> is used to skip namespaces in the exclude list.</p></li><li><p><code>ambient</code> mode is used for a pod if</p><ul><li>The namespace has label <code>istio.io/dataplane-mode=ambient</code></li><li>The annotation <code>sidecar.istio.io/status</code> is not present on the pod</li><li><code>ambient.istio.io/redirection</code> is not <code>disabled</code></li></ul></li></ol><p>The simplest option to avoid a configuration conflict is for a user to ensure that for each namespace, it either has the label for sidecar injection (<code>istio-injection=enabled</code>) or for ambient data plane mode (<code>istio.io/dataplane-mode=ambient</code>) but never both.</p><h2 id=l4auth>L4 Authorization Policy</h2><p>As mentioned previously, the ztunnel proxy performs Authorization policy enforcement when it requires only L4 traffic processing in order to enforce the policy in the data plane and there are no Waypoints involved. The actual enforcement point is at the receiving (or server side) ztunnel proxy in the path of a connection.</p><p>Apply a basic L4 Authorization policy for the already deployed <code>httpbin</code> application as shown in the example below.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl apply -n ambient-demo -f - &lt;&lt;EOF
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
 name: allow-sleep-to-httpbin
spec:
 selector:
   matchLabels:
     app: httpbin
 action: ALLOW
 rules:
 - from:
   - source:
       principals:
       - cluster.local/ns/ambient-demo/sa/sleep
EOF
</code></pre><p>The behavior of the <code>AuthorizationPolicy</code> API has the same functional behavior in Istio ambient mode as in sidecar mode. When there is no <code>AuthorizationPolicy</code> provisioned, then the default action is <code>ALLOW</code>. Once the policy above is provisioned, pods matching the selector in the policy (i.e. app:httpbin) only allow traffic explicitly whitelisted which in this case is sources with principal (i.e. identity) of <code>cluster.local/ns/ambient-demo/sa/sleep</code>. Now as shown below, if you try the curl operation to the <code>httpbin</code> service from the <code>sleep</code> pods, it still works but the same operation is blocked when initiated from the <code>notsleep</code> pods.</p><p>Note that this policy performs an explicit <code>ALLOW</code> action on traffic from sources with principal (i.e. identity) of <code>cluster.local/ns/ambient-demo/sa/sleep</code> and hence traffic from all other sources will be denied.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl exec deploy/sleep -n ambient-demo -- curl httpbin:8000 -s | grep title -m 1
    &lt;title&gt;httpbin.org&lt;/title&gt;
</code></pre><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl exec deploy/notsleep -n ambient-demo -- curl httpbin:8000 -s | grep title -m 1
command terminated with exit code 56
</code></pre><p>Note that there are no waypoint proxies deployed and yet this <code>AuthorizationPolicy</code> is getting enforced and this is because this policy only requires L4 traffic processing which can be performed by ztunnel proxies. These policy actions can be further confirmed by checking ztunnel logs and looking for logs that indicate RBAC actions as shown in the following example.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl logs ds/ztunnel -n istio-system  | grep -E RBAC
-- snip --
2023-10-10T23:14:00.534962Z  INFO inbound{id=cc493da5e89877489a786fd3886bd2cf peer_ip=10.240.2.2 peer_id=spiffe://cluster.local/ns/ambient-demo/sa/notsleep}: ztunnel::proxy::inbound: RBAC rejected conn=10.240.2.2(spiffe://cluster.local/ns/ambient-demo/sa/notsleep)-&gt;10.240.1.2:80
2023-10-10T23:15:33.339867Z  INFO inbound{id=4c4de8de802befa5da58a165a25ff88a peer_ip=10.240.2.2 peer_id=spiffe://cluster.local/ns/ambient-demo/sa/notsleep}: ztunnel::proxy::inbound: RBAC rejected conn=10.240.2.2(spiffe://cluster.local/ns/ambient-demo/sa/notsleep)-&gt;10.240.1.2:80
</code></pre><div><aside class="callout warning"><div class=type><svg class="large-icon"><use xlink:href="/v1.21/img/icons.svg#callout-warning"/></svg></div><div class=content>If an <code>AuthorizationPolicy</code> has been configured that requires any traffic processing beyond L4, and if no waypoint proxies are configured for the destination of the traffic, then ztunnel proxy will simply drop all traffic as a defensive move. Hence, check to ensure that either all rules involve L4 processing only or else if non-L4 rules are unavoidable, then waypoint proxies are also configured to handle policy enforcement.</div></aside></div><p>As an example, modify the <code>AuthorizationPolicy</code> to include a check for the HTTP GET method as shown below. Now notice that both <code>sleep</code> and <code>notsleep</code> pods are blocked from sending traffic to the destination <code>httpbin</code> service.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl apply -n ambient-demo -f - &lt;&lt;EOF
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
 name: allow-sleep-to-httpbin
spec:
 selector:
   matchLabels:
     app: httpbin
 action: ALLOW
 rules:
 - from:
   - source:
       principals:
       - cluster.local/ns/ambient-demo/sa/sleep
   to:
   - operation:
       methods: [&#34;GET&#34;]
EOF
</code></pre><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl exec deploy/sleep -n ambient-demo -- curl httpbin:8000 -s | grep title -m 1
command terminated with exit code 56
</code></pre><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl exec deploy/notsleep -n ambient-demo -- curl httpbin:8000 -s | grep title -m 1
command terminated with exit code 56
</code></pre><p>You can also confirm by viewing logs of specific ztunnel proxy pods (not shown in the example here) that it is always the ztunnel proxy on the node hosting the destination pod that actually enforces the policy.</p><p>Go ahead and delete this <code>AuthorizationPolicy</code> before continuing with the rest of the examples in the guide.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl delete AuthorizationPolicy allow-sleep-to-httpbin  -n ambient-demo
</code></pre><h2 id=interop>Ambient Interoperability with non-ambient endpoints</h2><p>In the use cases so far, the traffic source and destination pods are both ambient pods. This section covers some mixed use cases where ambient endpoints need to communicate with non-ambient endpoints. As with prior examples in this guide, this section covers use cases that do not require waypoint proxies.</p><ol><li><a href=/v1.21/docs/ops/ambient/usage/ztunnel/#ewnonmesh>East-West non-mesh pod to ambient mesh pod (and use of <code>PeerAuthentication</code> resource)</a></li><li><a href=/v1.21/docs/ops/ambient/usage/ztunnel/#ewside2ambient>East-West Istio sidecar proxy pod to ambient mesh pod</a></li><li><a href=/v1.21/docs/ops/ambient/usage/ztunnel/#nsingress2ambient>North-South Ingress Gateway to ambient backend pods</a></li></ol><h3 id=ewnonmesh>East-West non-mesh pod to ambient mesh pod (and use of PeerAuthentication resource)</h3><p>In the example below, the same <code>httpbin</code> service which has already been set up in the prior examples is accessed via client <code>sleep</code> pods that are running in a separate namespace that is not part of the Istio mesh. This example shows that East-west traffic between ambient mesh pods and non mesh pods is seamlessly supported. Note that as described previously, this use case leverages the traffic hair-pinning capability of ambient. Since the non-mesh pods initiate traffic directly to the backend pods without going through HBONE or ztunnel, at the destination node, traffic is redirected via the ztunnel proxy at the destination node to ensure that ambient authorization policy is applied (this can be verified by viewing logs of the appropriate ztunnel proxy pod on the destination node; the logs are not shown in the example snippet below for simplicity).</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl create namespace client-a
$ kubectl apply -f samples/sleep/sleep.yaml -n client-a
$ kubectl wait --for condition=available  deployment/sleep -n client-a
</code></pre><p>Wait for the pods to get to Running state in the client-a namespace before continuing.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl exec deploy/sleep -n client-a  -- curl httpbin.ambient-demo.svc.cluster.local:8000 -s | grep title -m 1
    &lt;title&gt;httpbin.org&lt;/title&gt;
</code></pre><p>As shown in the example below, now add a <code>PeerAuthentication</code> resource with mTLS mode set to <code>STRICT</code>, in the ambient namespace and confirm that the same client&rsquo;s traffic is now rejected with an error indicating the request was rejected. This is because the client is using simple HTTP to connect to the server instead of an HBONE tunnel with mTLS. This is a possible method that can be used to prevent non-Istio sources from sending traffic to Istio ambient pods.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl apply -n ambient-demo -f - &lt;&lt;EOF
apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: peerauth
spec:
  mtls:
    mode: STRICT
EOF
</code></pre><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl exec deploy/sleep -n client-a  -- curl httpbin.ambient-demo.svc.cluster.local:8000 -s | grep title -m 1
command terminated with exit code 56
</code></pre><p>Change the mTLS mode to <code>PERMISSIVE</code> and confirm that the ambient pods can once again accept non-mTLS connections including from non-mesh pods in this case.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl apply -n ambient-demo -f - &lt;&lt;EOF
apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: peerauth
spec:
  mtls:
    mode: PERMISSIVE
EOF
</code></pre><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl exec deploy/sleep -n client-a  -- curl httpbin.ambient-demo.svc.cluster.local:8000 -s | grep title -m 1
    &lt;title&gt;httpbin.org&lt;/title&gt;
</code></pre><h3 id=ewside2ambient>East-West Istio sidecar proxy pod to ambient mesh pod</h3><p>This use case is that of seamless East-West traffic interoperability between an Istio pod using a sidecar proxy and an ambient pod within the same mesh.</p><p>The same httpbin service from the previous example is used but now add a client to access this service from another namespace which is labeled for sidecar injection. This also works automatically and transparently as shown in the example below. In this case the sidecar proxy running with the client automatically knows to use the HBONE control plane since the destination has been discovered to be an HBONE destination. The user does not need to do any special configuration to enable this.</p><div><aside class="callout tip"><div class=type><svg class="large-icon"><use xlink:href="/v1.21/img/icons.svg#callout-tip"/></svg></div><div class=content>For sidecar proxies to use the HBONE/mTLS signaling option when communicating with ambient destinations, they need to be configured with <code>ISTIO_META_ENABLE_HBONE</code> set to true in the proxy metadata. This is automatically set for the user as default in the <code>MeshConfig</code> when using the <code>ambient</code> profile, hence the user does not need to do anything additional when using this profile.</div></aside></div><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl create ns client-b
$ kubectl label namespace client-b istio-injection=enabled
$ kubectl apply -f samples/sleep/sleep.yaml -n client-b
$ kubectl wait --for condition=available  deployment/sleep -n client-b
</code></pre><p>Wait for the pods to get to Running state in the client-b namespace before continuing.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl exec deploy/sleep -n client-b  -- curl httpbin.ambient-demo.svc.cluster.local:8000 -s | grep title -m 1
    &lt;title&gt;httpbin.org&lt;/title&gt;
</code></pre><p>Again, it can further be verified from viewing the logs of the ztunnel pod (not shown in the example) at the destination node that traffic does in fact use the HBONE and CONNECT based path from the sidecar proxy based source client pod to the ambient based destination service pod. Additionally, although not shown, it can also be verified that unlike the previous subsection, in this case even if you apply a <code>PeerAuthentication</code> resource to the namespace tagged for ambient mode, communication continues between client and service pods since both use the HBONE control and data planes relying on mTLS.</p><h3 id=nsingress2ambient>North-South Ingress Gateway to ambient backend pods</h3><p>This section describes a use case for North-South traffic with an Istio Gateway exposing the httpbin service via the Kubernetes Gateway API. The gateway itself is running in a non-Ambient namespace and may be an existing gateway that is also exposing other services that are provided by non-ambient pods. Hence, this example shows that ambient workloads can also interoperate with Istio gateways that need not themselves be running in namespaces tagged for ambient mode of operation.</p><p>For this example, you can use <code>metallb</code> to provide a load balancer service on an IP addresses that is reachable from outside the cluster. The same example also works with other forms of North-South load balancing options. The example below assumes that you have already installed <code>metallb</code> in this cluster to provide the load balancer service including a pool of IP addresses for <code>metallb</code> to use for exposing services externally. Refer to the <a href=https://kind.sigs.k8s.io/docs/user/loadbalancer/><code>metallb</code> guide for kind</a> for instructions on setting up <code>metallb</code> on kind clusters or refer to the instructions from the <a href=https://metallb.universe.tf/installation/><code>metallb</code> documentation</a> appropriate for your environment.</p><p>This example uses the Kubernetes Gateway API for configuring the N-S gateway. Since this API is not currently provided as default in Kubernetes and kind distributions, you have to install the API CRDs first as shown in the example.</p><p>An instance of <code>Gateway</code> using the Kubernetes Gateway API CRDs will then be deployed to leverage this <code>metallb</code> load balancer service. The instance of Gateway runs in the istio-system namespace in this example to represent an existing Gateway running in a non-ambient namespace. Finally, an <code>HTTPRoute</code> will be provisioned with a backend reference pointing to the existing httpbin service that is running on an ambient pod in the ambient-demo namespace.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl get crd gateways.gateway.networking.k8s.io &amp;&gt; /dev/null || \
      { kubectl kustomize &#34;github.com/kubernetes-sigs/gateway-api/config/crd/experimental?ref=v0.6.1&#34; | kubectl apply -f -; }
</code></pre><div><aside class="callout tip"><div class=type><svg class="large-icon"><use xlink:href="/v1.21/img/icons.svg#callout-tip"/></svg></div><div class=content>Istio includes beta support for the Kubernetes <a href=https://gateway-api.sigs.k8s.io/>Gateway API</a> and intends
to make it the default API for traffic management <a href=/v1.21/blog/2022/gateway-api-beta/>in the future</a>.
The following instructions allow you to choose to use either the Gateway API or the Istio configuration API when configuring
traffic management in the mesh. Follow instructions under either the <code>Gateway API</code> or <code>Istio APIs</code> tab,
according to your preference.</div></aside></div><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl apply -f - &lt;&lt; EOF
apiVersion: gateway.networking.k8s.io/v1beta1
kind: Gateway
metadata:
  name: httpbin-gateway
  namespace: istio-system
spec:
  gatewayClassName: istio
  listeners:
  - name: http
    port: 80
    protocol: HTTP
    allowedRoutes:
      namespaces:
        from: All
EOF
</code></pre><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl apply -n ambient-demo -f - &lt;&lt; EOF
apiVersion: gateway.networking.k8s.io/v1beta1
kind: HTTPRoute
metadata:
  name: httpbin
spec:
  parentRefs:
  - name: httpbin-gateway
    namespace: istio-system
  rules:
  - backendRefs:
    - name: httpbin
      port: 8000
EOF
</code></pre><p>Next find the external service IP address on which the Gateway is listening and then access the httpbin service on this IP address (172.18.255.200 in the example below) from outside the cluster as shown below.</p><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ kubectl get service httpbin-gateway-istio -n istio-system
NAME                    TYPE           CLUSTER-IP     EXTERNAL-IP      PORT(S)                        AGE
httpbin-gateway-istio   LoadBalancer   10.110.30.25   172.18.255.200   15021:32272/TCP,80:30159/TCP   121m
</code></pre><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ export INGRESS_HOST=$(kubectl -n istio-system get service httpbin-gateway-istio  -o jsonpath=&#39;{.status.loadBalancer.ingress[0].ip}&#39;)
$ echo &#34;$INGRESS_HOST&#34;
172.18.255.200
</code></pre><pre><code class=language-bash data-expandlinks=true data-repo=istio>$ curl  &#34;$INGRESS_HOST&#34; -s | grep title -m 1
    &lt;title&gt;httpbin.org&lt;/title&gt;
</code></pre><p>These examples illustrate multiple options for interoperability between ambient pods and non-ambient endpoints (which can be either Kubernetes application pods or Istio gateway pods with both Istio native gateways and Kubernetes Gateway API instances). Interoperability is also supported between Istio ambient pods and Istio Egress Gateways as well as scenarios where the ambient pods run the client-side of an application with the service side running outside of the mesh of on a mesh pod that uses the sidecar proxy mode. Hence, users have multiple options for seamlessly integrating ambient and non-ambient workloads within the same Istio mesh, allowing for phased introduction of ambient capability as best suits the needs of Istio mesh deployments and operations.</p></article><nav class=pagenav><div class=left></div><div class=right><a title="Gain the full set of Istio feature with optional waypoint proxies." href=/v1.21/docs/ops/ambient/usage/waypoint/ class=next-link>Layer 7 Networking & Services with Waypoint Proxies<svg class="icon right-arrow"><use xlink:href="/v1.21/img/icons.svg#right-arrow"/></svg></a></div></nav><div id=feedback><div id=feedback-initial>Was this information useful?<br><button class="btn feedback" onclick='sendFeedback("en",1)'>Yes</button>
<button class="btn feedback" onclick='sendFeedback("en",0)'>No</button></div><div id=feedback-comment>Do you have any suggestions for improvement?<br><br><input id=feedback-textbox type=text placeholder='Help us improve...' data-lang=en></div><div id=feedback-thankyou>Thanks for your feedback!</div></div><div id=endnotes-container aria-hidden=true><h2>Links</h2><ol id=endnotes></ol></div></div><div class=toc-container><nav class=toc aria-label="Table of Contents"><div id=toc><ol><li role=none aria-label=Introduction><a href=#introsection>Introduction</a><li role=none aria-label="Current Caveats"><a href=#caveats>Current Caveats</a><ol><li role=none aria-label="Environment used for this guide"><a href=#environment-used-for-this-guide>Environment used for this guide</a></ol></li><li role=none aria-label="Functional Overview"><a href=#functionaloverview>Functional Overview</a><ol><li role=none aria-label="Control plane overview"><a href=#control-plane-overview>Control plane overview</a><li role=none aria-label="Data plane overview"><a href=#data-plane-overview>Data plane overview</a><ol><li role=none aria-label="Ztunnel to ztunnel datapath"><a href=#ztunnel-to-ztunnel-datapath>Ztunnel to ztunnel datapath</a><li role=none aria-label="Ztunnel datapath via waypoint"><a href=#ztunnel-datapath-via-waypoint>Ztunnel datapath via waypoint</a><li role=none aria-label="Ztunnel datapath hair-pinning"><a href=#ztunnel-datapath-hair-pinning>Ztunnel datapath hair-pinning</a></ol></li><li role=none aria-label="Note on HBONE"><a href=#hbonesection>Note on HBONE</a></ol></li><li role=none aria-label="Deploying an Application"><a href=#deployapplication>Deploying an Application</a><ol><li role=none aria-label="Basic application deployment without Ambient"><a href=#basic-application-deployment-without-ambient>Basic application deployment without Ambient</a><li role=none aria-label="Enabling ambient for an application"><a href=#enabling-ambient-for-an-application>Enabling ambient for an application</a></ol></li><li role=none aria-label="Monitoring the ztunnel proxy & L4 networking"><a href=#monitoringzt>Monitoring the ztunnel proxy & L4 networking</a><ol><li role=none aria-label="Viewing ztunnel proxy state"><a href=#viewing-ztunnel-proxy-state>Viewing ztunnel proxy state</a><li role=none aria-label="Viewing Istiod state for ztunnel xDS resources"><a href=#viewing-istiod-state-for-ztunnel-xds-resources>Viewing Istiod state for ztunnel xDS resources</a><li role=none aria-label="Verifying ztunnel traffic logs"><a href=#verifying-ztunnel-traffic-logs>Verifying ztunnel traffic logs</a><li role=none aria-label="Monitoring and Telemetry via Prometheus, Grafana, Kiali"><a href=#monitoring-and-telemetry-via-prometheus-grafana-kiali>Monitoring and Telemetry via Prometheus, Grafana, Kiali</a><li role=none aria-label="Verifying ztunnel load balancing"><a href=#verifying-ztunnel-load-balancing>Verifying ztunnel load balancing</a><li role=none aria-label="Pod selection logic for ambient and sidecar modes"><a href=#pod-selection-logic-for-ambient-and-sidecar-modes>Pod selection logic for ambient and sidecar modes</a></ol></li><li role=none aria-label="L4 Authorization Policy"><a href=#l4auth>L4 Authorization Policy</a><li role=none aria-label="Ambient Interoperability with non-ambient endpoints"><a href=#interop>Ambient Interoperability with non-ambient endpoints</a><ol><li role=none aria-label="East-West non-mesh pod to ambient mesh pod (and use of PeerAuthentication resource)"><a href=#ewnonmesh>East-West non-mesh pod to ambient mesh pod (and use of PeerAuthentication resource)</a><li role=none aria-label="East-West Istio sidecar proxy pod to ambient mesh pod"><a href=#ewside2ambient>East-West Istio sidecar proxy pod to ambient mesh pod</a><li role=none aria-label="North-South Ingress Gateway to ambient backend pods"><a href=#nsingress2ambient>North-South Ingress Gateway to ambient backend pods</a></ol></li></ol></div></nav></div></main><footer class=footer><div class="footer-wrapper container-l"><div class="user-links footer-links"><a class=channel title='GitHub is where development takes place on Istio code' href=https://github.com/istio/community aria-label=GitHub><svg class="icon github"><use xlink:href="/v1.21/img/icons.svg#github"/></svg>
</a><a class=channel title="Access our team drive if you'd like to take a look at the Istio technical design documents" href=https://groups.google.com/forum/#!forum/istio-team-drive-access aria-label="team drive"><svg class="icon drive"><use xlink:href="/v1.21/img/icons.svg#drive"/></svg>
</a><a class=channel title='Interactively discuss issues with the Istio community on Slack' href=https://slack.istio.io aria-label=slack><svg class="icon slack"><use xlink:href="/v1.21/img/icons.svg#slack"/></svg>
</a><a class=channel title='Stack Overflow is where you can ask questions and find curated answers on deploying, configuring, and using Istio' href=https://stackoverflow.com/questions/tagged/istio aria-label="Stack Overflow"><svg class="icon stackoverflow"><use xlink:href="/v1.21/img/icons.svg#stackoverflow"/></svg>
</a><a class=channel title='Follow us on Twitter to get the latest news' href=https://twitter.com/IstioMesh aria-label=Twitter><svg class="icon twitter"><use xlink:href="/v1.21/img/icons.svg#twitter"/></svg></a></div><hr class=footer-separator role=separator><div class="info footer-info"><a class=logo href=/v1.21/ aria-label=logotype><svg xmlns="http://www.w3.org/2000/svg" width="128" height="60" viewBox="0 0 128 60"><path d="M58.434 48.823A.441.441.0 0158.3 48.497V22.583a.444.444.0 01.134-.326.446.446.0 01.327-.134h3.527a.447.447.0 01.325.134.447.447.0 01.134.326v25.914a.443.443.0 01-.134.326.444.444.0 01-.325.134h-3.527a.444.444.0 01-.327-.134z"/><path d="m70.969 48.477a6.556 6.556.0 01-2.818-1.955 4.338 4.338.0 01-1-2.78v-.345a.443.443.0 01.134-.326.444.444.0 01.326-.135h3.374a.444.444.0 01.326.135.445.445.0 01.134.326v.077a2.014 2.014.0 001.054 1.667 4.672 4.672.0 002.664.709 4.446 4.446.0 002.492-.633 1.862 1.862.0 00.958-1.591 1.426 1.426.0 00-.786-1.322 12.7 12.7.0 00-2.549-.939l-1.457-.46a21.526 21.526.0 01-3.3-1.227 6.57 6.57.0 01-2.262-1.783 4.435 4.435.0 01-.92-2.894 5.081 5.081.0 012.109-4.275 8.993 8.993.0 015.558-1.591 10.445 10.445.0 014.1.748 6.3 6.3.0 012.722 2.07 5 5 0 01.958 3.009.441.441.0 01-.134.326.441.441.0 01-.325.134h-3.258a.441.441.0 01-.326-.134.443.443.0 01-.134-.326 1.974 1.974.0 00-.978-1.667 4.647 4.647.0 00-2.665-.671 4.741 4.741.0 00-2.435.556 1.724 1.724.0 00-.938 1.553 1.512 1.512.0 00.9 1.4 15.875 15.875.0 003.01 1.055l.843.229a27.368 27.368.0 013.412 1.246 6.67 6.67.0 012.338 1.763 4.387 4.387.0 01.958 2.933 4.988 4.988.0 01-2.146 4.275 9.543 9.543.0 01-5.712 1.552 11.626 11.626.0 01-4.227-.709z"/><path d="m97.039 32.837a.443.443.0 01-.326.135h-3.911a.169.169.0 00-.191.192v9.239a2.951 2.951.0 00.632 2.108 2.7 2.7.0 002.013.652h1.15a.444.444.0 01.325.134.441.441.0 01.134.326v2.875a.471.471.0 01-.459.5l-1.994.039a8 8 0 01-4.524-1.035q-1.495-1.035-1.533-3.91V33.166A.17.17.0 0088.164 32.974H85.978A.441.441.0 0185.652 32.839.441.441.0 0185.518 32.513V29.83a.441.441.0 01.134-.326.444.444.0 01.326-.135h2.186a.169.169.0 00.191-.192v-4.485a.438.438.0 01.134-.326.44.44.0 01.325-.134h3.336a.443.443.0 01.325.134.442.442.0 01.135.326v4.485a.169.169.0 00.191.192h3.911a.446.446.0 01.326.135.446.446.0 01.134.326v2.683a.446.446.0 01-.133.324z"/><path d="m101.694 25.917a2.645 2.645.0 01-.767-1.955 2.65 2.65.0 01.767-1.955 2.65 2.65.0 011.955-.767 2.65 2.65.0 011.955.767 2.652 2.652.0 01.767 1.955 2.647 2.647.0 01-.767 1.955 2.646 2.646.0 01-1.955.767 2.645 2.645.0 01-1.955-.767zm-.211 22.906a.441.441.0 01-.134-.326V29.79a.444.444.0 01.134-.326.446.446.0 01.326-.134h3.527a.446.446.0 01.326.134.445.445.0 01.134.326v18.707a.443.443.0 01-.134.326.443.443.0 01-.326.134h-3.527a.443.443.0 01-.326-.134z"/><path d="m114.019 47.734a8.1 8.1.0 01-3.047-4.255 14.439 14.439.0 01-.652-4.37 14.3 14.3.0 01.614-4.371A7.869 7.869.0 01114 30.56a9.072 9.072.0 015.252-1.5 8.543 8.543.0 015.041 1.5 7.985 7.985.0 013.009 4.14 12.439 12.439.0 01.69 4.37 13.793 13.793.0 01-.651 4.37 8.255 8.255.0 01-3.028 4.275 8.475 8.475.0 01-5.1 1.553 8.754 8.754.0 01-5.194-1.534zm7.629-3.1a4.536 4.536.0 001.476-2.262 11.335 11.335.0 00.383-3.221 10.618 10.618.0 00-.383-3.22 4.169 4.169.0 00-1.457-2.243 4.066 4.066.0 00-2.531-.785 3.942 3.942.0 00-2.453.785 4.376 4.376.0 00-1.5 2.243 11.839 11.839.0 00-.383 3.22 11.84 11.84.0 00.383 3.221 4.222 4.222.0 001.476 2.262 4.075 4.075.0 002.549.8 3.8 3.8.0 002.44-.809z"/><path d="m15.105 32.057v15.565a.059.059.0 01-.049.059L.069 50.25A.06.06.0 01.005 50.167l14.987-33.47a.06.06.0 01.114.025z"/><path d="m17.631 23.087v24.6a.06.06.0 00.053.059l22.449 2.507a.06.06.0 00.061-.084L17.745.032a.06.06.0 00-.114.024z"/><path d="m39.961 52.548-24.833 7.45a.062.062.0 01-.043.0L.079 52.548a.059.059.0 01.026-.113h39.839a.06.06.0 01.017.113z"/></svg></a><div class=footer-languages><a tabindex=-1 lang=en id=switch-lang-en class="footer-languages-item active"><svg class="icon tick"><use xlink:href="/v1.21/img/icons.svg#tick"/></svg>
English
</a><a tabindex=-1 lang=zh id=switch-lang-zh class=footer-languages-item>中文</a></div></div><ul class=footer-policies><li class=footer-policies-item><a class=footer-policies-link href=https://www.linuxfoundation.org/legal/terms>Terms and Conditions
</a>|
<a class=footer-policies-link href=https://www.linuxfoundation.org/legal/privacy-policy>Privacy policy
</a>|
<a class=footer-policies-link href=https://www.linuxfoundation.org/legal/trademark-usage>Trademarks
</a>|
<a class=footer-policies-link href=https://github.com/istio/istio.io/edit/release-1.21/content/en/index>Edit this Page on GitHub</a></li></ul><div class=footer-base><span class=footer-base-copyright>&copy; 2024 the Istio Authors.</span>
<span class=footer-base-version>Version
Archive
1.21.2</span><ul class=footer-base-releases><li class=footer-base-releases-item><a tabindex=-1 class=footer-base-releases-link onclick='return navigateToUrlOrRoot("https://istio.io/docs/ops/ambient/usage/ztunnel/"),!1'>current release</a></li><li class=footer-base-releases-item><a tabindex=-1 class=footer-base-releases-link onclick='return navigateToUrlOrRoot("https://preliminary.istio.io/docs/ops/ambient/usage/ztunnel/"),!1'>next release</a></li><li class=footer-base-releases-item><a tabindex=-1 class=footer-base-releases-link href=https://istio.io/archive>older releases</a></li></ul></div></div></footer><div id=scroll-to-top-container aria-hidden=true><button id=scroll-to-top title='Back to top' tabindex=-1><svg class="icon top"><use xlink:href="/v1.21/img/icons.svg#top"/></svg></button></div></body></html>