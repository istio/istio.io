---
title: Оновлення на місці
description: Оновлення або пониження версії Istio на місці.
weight: 20
keywords: [kubernetes,upgrading,in-place]
owner: istio/wg-environments-maintainers
test: no
---

Команда `istioctl upgrade` виконує оновлення Istio.

{{< tip >}}
[Оновлення Canary](/docs/setup/upgrade/canary/) є безпечнішим, ніж оновлення на місці, і є рекомендованим методом оновлення.
{{< /tip >}}

Команда оновлення також може виконувати пониження версії Istio.

Ознайомтеся з [довідкою з оновлення `istioctl`](/docs/reference/commands/istioctl/#istioctl-upgrade) для всіх параметрів, наданих командою `istioctl upgrade`.

{{< warning >}}
Команда `istioctl upgrade` призначена для оновлення на місці та не сумісна з установками, виконаними за допомогою прапорця `--revision`. Оновлення таких установок завершиться помилкою.
{{< /warning >}}

## Передумови для оновлення {#upgrade-prerequisites}

Перед початком процесу оновлення перевірте наступні вимоги:

* Встановлена версія Istio не повинна бути старшою на більше ніж одну мінорну версію, ніж версія оновлення. Наприклад, версія 1.6.0 або новіша потрібна перед початком процесу оновлення до 1.7.x.

* Ваша установка Istio була [виконана за допомогою {{< istioctl >}}](/docs/setup/install/istioctl/).

## Кроки для оновлення {#upgrade-steps}

{{< warning >}}
Може виникнути порушення трафіку під час процесу оновлення. Щоб зменшити порушення, переконайтеся, що запущено принаймні два примірники `istiod`. Також переконайтеся, що [`PodDisruptionBudgets`](https://kubernetes.io/docs/tasks/run-application/configure-pdb/) сконфігуровані з мінімальною доступністю 1.
{{< /warning >}}

Команди в цьому розділі слід виконувати за допомогою нової версії `istioctl`, яку можна знайти в теці `bin/` завантаженого пакета.

1. [Завантажте новий реліз Istio](/docs/setup/additional-setup/download-istio-release/) та перейдіть у теку нового релізу.

2. Переконайтеся, що ваша конфігурація Kubernetes вказує на кластер для оновлення:

    {{< text bash >}}
    $ kubectl config view
    {{< /text >}}

3. Переконайтеся, що оновлення сумісне з вашим середовищем.

    {{< text bash >}}
    $ istioctl x precheck
    ✔ No issues found when checking the cluster. Istio is safe to install or upgrade!
    To get started, check out https://istio.io/latest/docs/setup/getting-started/
    {{< /text >}}

4. Розпочніть оновлення, виконавши цю команду:

    {{< text bash >}}
    $ istioctl upgrade
    {{< /text >}}

    {{< warning >}}
    Якщо ви встановили Istio за допомогою прапорця `-f`, наприклад `istioctl install -f <IstioOperator-custom-resource-definition-file>`, то ви повинні вказати таке ж значення прапорця `-f` команді `istioctl upgrade`.
    {{< /warning >}}

    Якщо ви встановили Istio за допомогою прапорців `--set`, переконайтеся, що ви передаєте ті ж прапорці `--set` для оновлення, інакше налаштування, виконані за допомогою `--set`, будуть скасовані. Для операційного використання рекомендується використовувати файл конфігурації замість `--set`.

    Якщо ви пропустите прапорець `-f`, Istio буде оновлено за допомогою стандартного профілю.

    Після виконання кількох перевірок, `istioctl` попросить вас підтвердити, чи слід продовжити.

5. `istioctl` оновить панель управління та шлюзи Istio до нової версії та покаже статус завершення.

6. Після завершення оновлення командою `istioctl` ви повинні вручну оновити панель даних Istio, перезапустивши будь-які podʼи з sidecar контейнерами Istio:

    {{< text bash >}}
    $ kubectl rollout restart deployment
    {{< /text >}}

## Примітки до пониження версії {#downgrade-prerequisites}

Перед початком процесу пониження версії перевірте наступні вимоги:

* Ваша установка Istio була [виконана за допомогою {{< istioctl >}}](/docs/setup/install/istioctl/).

* Версія Istio, до якої ви плануєте понизити версію, не повинна бути старшою на більше ніж одну мінорну версію, ніж встановлена версія Istio. Наприклад, ви можете знизити версію Istio 1.7.x до версії не нижчої за 1.6.0.

* пониження версії має бути виконано за допомогою версії бінарного файлу `istioctl`, яка відповідає версії Istio, до якої ви плануєте знизити версію. Наприклад, якщо ви понижуєте версію з Istio 1.7 до 1.6.5, використовуйте `istioctl` версії 1.6.5.

## Кроки для пониження версії до нижчої версії Istio {#steps-to-downgrade-to-a-lower-istio-version}

Ви можете використовувати `istioctl upgrade` для пониження версії до нижчої версії Istio. Кроки ідентичні процесу оновлення, описаному в попередньому розділі, тільки з використанням бінарного файлу `istioctl`, що відповідає
нижчій версії (наприклад, 1.6.5). Після завершення, Istio буде відновлено до попередньо встановленої версії.

Як альтернатива, можна використовувати `istioctl install` для встановлення старішої версії панелі управління Istio.
