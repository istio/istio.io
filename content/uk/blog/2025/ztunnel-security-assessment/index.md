---
title: "Istio публікує результати аудиту безпеки ztunnel"
description: Проходить на відмінно.
publishdate: 2025-04-18
attribution: "Craig Box — Solo.io, для робочої групи з безпеки продуктів Istio"
keywords: [istio,security,audit,ztunnel,ambient]
---

Ambient-режим Istio розділяє сервісну мережу на два окремі шари: Обробка 7-го рівня (проксі-сервер «[waypoint proxy](/docs/ambient/usage/waypoint/)»), який, як і раніше, працює за допомогою традиційного проксі-сервера Envoy; і безпечний оверлей («тунель нульової довіри» або «[ztunnel](https://github.com/istio/ztunnel)»), який являє собою [нову кодову базу](/blog/2023/rust-based-ztunnel/), написану з нуля на Rust.

Ми хочемо, щоб проєкт ztunnel можна було безпечно встановлювати стандартно у кожному кластері Kubernetes, а для цього він має бути безпечним та продуктивним.

Ми всебічно продемонстрували продуктивність ztunnel, показавши, що він є [способом створення безпечної мережі нульової довіри в Kubernetes з найвищою пропускною здатністю](/blog/2025/ambient-performance/) — забезпечує вищу пропускну здатність TCP, ніж навіть такі внутрішньоядерні засоби передачі даних, як IPsec і WireGuard, і що його продуктивність збільшилася на 75% за останні 4 випуски.

Сьогодні ми раді підтвердити безпеку ztunnel, опублікувавши [результати аудиту кодової бази](https://ostif.org/wp-content/uploads/2025/04/Istio-Ztunnel-Final-Summary-Report-1.pdf), проведеного [Trail of Bits](https://www.trailofbits.com/).

Ми хотіли б подякувати [Cloud Native Computing Foundation](https://cncf.io/) за фінансування цієї роботи, а також [OSTIF за її координацію](https://ostif.org/istio-ztunnel-audit-complete/).

## Обсяг та загальні висновки {#scope-and-overall-findings}

Istio було оцінено у [2020](/blog/2021/ncc-security-assessment/) та [2023](/blog/2023/ada-logics-security-assessment/), а проксі Envoy [отримав незалежну оцінку](https://github.com/envoyproxy/envoy#security-audit). Обʼєктом цього огляду був новий код в середовищі Istio, компонент ztunnel: зокрема, код, повʼязаний з авторизацією L4, проксіюванням вхідних запитів, безпекою на транспортному рівні (TLS) та управлінням сертифікатами.

Аудитори заявили, що «кодова база ztunnel добре написана і структурована», і не виявили жодних вразливостей у коді. Три їхні висновки, один середньої тяжкості і два інформаційних,  стосуються рекомендацій щодо зовнішніх факторів, включаючи ланцюжок постачання програмного забезпечення і тестування.

## Результат та запропоновані покращення {#resolution-and-suggested-improvements}

## Покращення управління залежностями {#improving-dependency-management}

На момент проведення аудиту у звіті [cargo audit](https://crates.io/crates/cargo-audit) для залежностей ztunnel було показано три версії з актуальними рекомендаціями щодо безпеки. Не було жодних припущень про те, що у залежностях ztunnel можуть бути доступні будь-які вразливі шляхи коду, і супровідники регулярно оновлюють залежності до останніх відповідних версій. Щоб оптимізувати цей процес, ми [застосували Dependabot від GitHub](https://github.com/istio/ztunnel/pull/1400) для автоматизованого оновлення.

Аудитори вказали на ризик наявності Rust crates у ланцюжку залежностей ztunnel, які або не підтримуються, або підтримуються одним власником. Це поширена ситуація в екосистемі Rust (і взагалі у всьому відкритому коді). Ми замінили два явно ідентифіковані crate.

### Розширення тестового покриття {#enhancing-test-coverage}

Команда Trail of Bits виявила, що більшість функціональних можливостей ztunnel добре протестовано, але було виявлено деякі шляхи коду обробки помилок, які не було покрито [тестуванням мутацій](https://mutants.rs/).

Ми оцінили пропозиції і виявили, що прогалини у покритті, виявлені цими результатами, стосуються як тестового коду, так і коду, який не впливає на коректність.

Хоча мутаційне тестування корисне для виявлення потенційних областей для покращення, мета не полягає в тому, щоб досягти точки, коли звіт не повертає жодних результатів. Мутації можуть не спричинити збоїв тестування в ряді очікуваних випадків, таких як поведінка без «правильного» результату (наприклад, повідомлення журналу), поведінка, яка впливає лише на продуктивність, але не на коректність (вимірюється за межами області, про яку знає інструментарій), шляхи коду, які мають кілька способів досягти того самого результату, або код, який використовується лише для тестування. Тестування та безпека є основним пріоритетом для команди Istio, і ми постійно вдосконалюємо наше тестове покриття, використовуючи такі інструменти, як мутаційне тестування та [розробляючи нові рішення](https://blog.howardjohn.info/posts/ztunnel-testing/) для тестування проксі-серверів.

### Посилення розбору заголовків HTTP {#hardening-http-header-parsing}

Для розбору значення заголовка HTTP [Forwarded](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Forwarded), який може бути присутнім у зʼєднаннях з ztunnel, використовувалася бібліотека сторонніх розробників. Аудитори зазначили, що розбір заголовків є поширеною сферою атак, і висловили занепокоєння тим, що бібліотека, яку ми використовували, не пройшла нечіткий тест. Враховуючи, що ми використовували цю бібліотеку лише для аналізу одного заголовка, ми [написали власний парсер для заголовка Forwarded](https://github.com/istio/ztunnel/pull/1418), доповнивши його фаззі-арканом для тестування.

## Долучайтеся {#get-involved}

Завдяки високій продуктивності та підтвердженій безпеці, режим ambient продовжує розвивати сучасний рівень дизайну сервісних мереж. Ми рекомендуємо вам спробувати його вже сьогодні.

Якщо ви бажаєте долучитися до роботи над безпекою продукту Istio або стати його супровідником, ми будемо раді бачити вас! Приєднуйтесь до [нашого робочого простору Slack](https://slack.istio.io/) або [наших публічних зустрічей](https://github.com/istio/community/blob/master/WORKING-GROUPS.md), щоб ставити питання або дізнатися про те, що ми робимо для забезпечення безпеки Istio.
