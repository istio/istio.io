---
title: Як управляти метриками з коротким терміном життя?
weight: 20
---

Метрики з коротким терміном життя можуть впливати на продуктивність Prometheus, оскільки вони часто є великою джерелом кардинальності міток. Кардинальність — це міра кількості унікальних значень для міток. Щоб управляти впливом ваших метрик з коротким терміном життя в Prometheus, спочатку потрібно визначити метрики та мітки з високою кардинальністю. Prometheus надає інформацію про кардинальність на своїй сторінці `/status`. Додаткову інформацію можна отримати [через PromQL](https://www.robustperception.io/which-are-my-biggest-metrics). Є кілька способів зменшити кардинальність метрик Istio:

* Вимкніть резервне використання заголовка хосту. Мітка `destination_service` є одним з потенційних джерел високої кардинальності. Значення для `destination_service` стандартно використовують заголовок хосту, якщо проксі Istio не може визначити службу призначення з інших метаданих запиту. Якщо клієнти використовують різні заголовки хостів, це може призвести до великої кількості значень для `destination_service`. В цьому випадку слідуйте [керівництву з налаштування метрик](/docs/tasks/observability/metrics/customize-metrics/), щоб вимкнути резервне використання заголовка хосту на рівні мережі. Щоб вимкнути резервне використання заголовка хосту для конкретного робочого навантаження або простору імен, потрібно скопіювати конфігурацію `EnvoyFilter` статистики, оновити її, щоб вимкнути резервне використання заголовка хосту, і застосувати її з більш специфічним селектором. [Цей тікет](https://github.com/istio/istio/issues/25963#issuecomment-666037411) має більше деталей про те, як цього досягти.
* Викиньте непотрібні мітки зі збору. Якщо мітка з високою кардинальністю не потрібна, ви можете викинути її зі збору метрик через [налаштування метрик](/docs/tasks/observability/metrics/customize-metrics/) за допомогою `tags_to_remove`.
* Нормалізуйте значення міток, через федерацію або класифікацію. Якщо інформація, надана міткою, потрібна, ви можете використовувати [федерацію Prometheus](/docs/ops/best-practices/observability/#using-prometheus-for-production-scale-monitoring) або [класифікацію запитів](/docs/tasks/observability/metrics/classify-metrics/) для нормалізації мітки.
