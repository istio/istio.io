{{ define "main" }}
<div class="blog-content">
    <h1>Blog</h1>
    <p class="blog-description">Istio addresses the challenges developers and operators face as monolithic applications transition towards a distributed microservice architecture. </p>
    
    {{ $.Scratch.Set "years" (slice ) }}
    {{ $.Scratch.Set "noYears" 0 }}
    {{ $pages := (where .Site.Pages "Section" "blog").ByPublishDate.Reverse }}
    {{ range $pages }}
        {{ with .Params.publishdate }}
            {{ if eq ( printf "%T" (substr . 0 4) ) "string"  }}
                {{ if ( not ( in ($.Scratch.Get "years") (substr . 0 4) ) ) }}
                    {{ $.Scratch.Add "years" (substr . 0 4) }}
                {{ end }}
            {{ end }}
        {{ end }}
    {{ end }}

    <div class="year-buttons">
        {{ range $.Scratch.Get "years" }}
        <button xx class="year-button" id='year-{{ . }}' onclick="applyFilter(this)">
            {{ . }}
        </button>
        {{ end }}
    </div>
    <div class="posts-list">
        {{ range $pages }}
            <a class="post-card tf-filter-item" href="{{ .RelPermalink }}" data-categories='{{ (substr .Params.publishdate 0 4) }}'
            >
                <div class="post-date">
                    <p>{{ (.Params.publishdate).Format "Jan 2, 2006" }}</p>
                </div>
                <div>
                    <h4 class="post-title">{{ .Title }}</h4>
                    <p class="post-summary">{{ .Summary | plainify | chomp }}</p>
                    <p class="post-author">By {{ .Params.attribution }}</p>
                </div>    
            </a>
        {{ end }}
    </div>
</div>

<!-- <script src='{{ "js/categories-filter.js" | relURL }}'></script>
<script>
var htfConfig = {
    filters: [
    {
        name: 'categories',
        prefix: 'category-',
        buttonClass: 'category-button',
        allSelector: '#selectAllAuthors',
        attrName: 'data-categories',
    }
    ],
    showItemClass: "show-item",
    filterItemClass: "tf-filter-item",
    activeButtonClass: "active",
    populateCount: true,
    setDisabledButtonClass: "disable-button"
}
var htf = new CategoriesFilter(htfConfig);
$("#load-button").click(function(){
    $(this).toggleClass('tf-filter-item');
    htf.showMore();
    htf.showCheck(htfConfig.filters[0].name, false);
});

function applyFilter (element) {
    var category = element.id.split('category-');
    htf.resetCount();
    htf.checkFilter(category[1],'category-');
}

</script> -->

{{ end }}
