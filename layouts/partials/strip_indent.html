{{- $input := . -}}
{{- $lines := split (strings.TrimRight " " (trim $input "\n")) "\n" -}}

{{- $line0 := index $lines 0 -}}
{{- $indent := 0 -}}
{{- if hasPrefix $line0 "                " -}}{{- $indent = 16 -}}
{{- else if hasPrefix $line0 "            " -}}{{- $indent = 12 -}}
{{- else if hasPrefix $line0 "        " -}}{{- $indent = 8 -}}
{{- else if hasPrefix $line0 "    " -}}{{- $indent = 4 -}}
{{- end -}}

{{- $text := "" -}}
{{- range $line := $lines -}}
    {{- if gt (len $line) $indent -}}
        {{- $l := substr $line $indent -}}
        {{- $text = printf "%s\n%s" $text $l -}}
    {{- else -}}
        {{- $text = printf "%s\n%s" $text $line -}}
    {{- end -}}
{{- end -}}

{{- trim $text "\n" | safeHTML -}}
